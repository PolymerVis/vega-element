<html><head><script>!function(I_,U_){"object"==("undefined"===typeof exports?"undefined":babelHelpers.typeof(exports))&&"undefined"!=typeof module?U_(exports,require("d3-array"),require("d3-request"),require("d3-dsv"),require("topojson"),require("d3-time-format"),require("d3-shape"),require("d3-path"),require("d3-scale"),require("d3-scale-chromatic"),require("d3-interpolate"),require("d3-geo"),require("d3-format"),require("d3-force"),require("d3-collection"),require("d3-hierarchy"),require("d3-voronoi"),require("d3-color")):"function"==typeof define&&define.amd?define(["exports","d3-array","d3-request","d3-dsv","topojson","d3-time-format","d3-shape","d3-path","d3-scale","d3-scale-chromatic","d3-interpolate","d3-geo","d3-format","d3-force","d3-collection","d3-hierarchy","d3-voronoi","d3-color"],U_):U_(I_.vega=I_.vega||{},I_.d3,I_.d3,I_.d3,I_.topojson,I_.d3,I_.d3,I_.d3,I_.d3,I_.d3,I_.d3,I_.d3,I_.d3,I_.d3,I_.d3,I_.d3,I_.d3,I_.d3)}(this,function(I_,U_,$_,j_,W_,B_,G_,V_,H_,Y_,X_,J_,Q_,K_,Z_,ek,tk,ak){"use strict";function nk(_B){var kB,wB,zB,EB,SB,CB,OB,RB,DB=_B.maxbins||20,AB=_B.base||10,PB=Math.log(AB),qB=_B.divide||[5,2],MB=_B.extent[0],LB=_B.extent[1],TB=LB-MB;if(_B.step)kB=_B.step;else if(_B.steps){for(SB=TB/DB,CB=0,OB=_B.steps.length;CB<OB&&_B.steps[CB]<SB;++CB);kB=_B.steps[Math.max(0,CB-1)]}else{for(wB=Math.ceil(Math.log(DB)/PB),zB=_B.minstep||0,kB=Math.max(zB,Math.pow(AB,Math.round(Math.log(TB)/PB)-wB));Math.ceil(TB/kB)>DB;)kB*=AB;for(CB=0,OB=qB.length;CB<OB;++CB)(SB=kB/qB[CB])>=zB&&TB/SB<=DB&&(kB=SB)}return SB=Math.log(kB),EB=0<=SB?0:1+~~(-SB/PB),RB=Math.pow(AB,-EB-1),(_B.nice||void 0===_B.nice)&&(MB=Math.min(MB,Math.floor(MB/kB+RB)*kB),LB=Math.ceil(LB/kB)*kB),{start:MB,stop:LB,step:kB}}function ik(_B,kB){var wB,zB=[],EB=_B.length,SB=-1;if(null==kB)for(;++SB<EB;)isNaN(wB=rk(_B[SB]))||zB.push(wB);else for(;++SB<EB;)isNaN(wB=rk(kB(_B[SB],SB,_B)))||zB.push(wB);return zB}function rk(_B){return null===_B?NaN:+_B}function dk(_B,kB,wB,zB){var EB,SB,CB,OB,RB=ik(_B,zB),DB=RB.length,AB=kB;for(CB=0,OB=Array(AB);CB<AB;++CB){for(EB=0,SB=0;SB<DB;++SB)EB+=RB[~~(Math.random()*DB)];OB[CB]=EB/DB}return[U_.quantile(OB.sort(U_.ascending),wB/2),U_.quantile(OB,1-wB/2)]}function sk(_B,kB){var wB,zB,EB=NaN,SB={};return SB.mean=function(CB){return arguments.length?(wB=CB||0,EB=NaN,SB):wB},SB.stdev=function(CB){return arguments.length?(zB=null==CB?1:CB,EB=NaN,SB):zB},SB.sample=function(){var CB,OB,RB=0,DB=0;if(EB===EB)return RB=EB,EB=NaN,RB;do RB=2*Math.random()-1,DB=2*Math.random()-1,CB=RB*RB+DB*DB;while(0===CB||1<CB);return OB=Math.sqrt(-2*Math.log(CB)/CB),EB=wB+DB*OB*zB,wB+RB*OB*zB},SB.pdf=function(CB){var OB=Math.exp(Math.pow(CB-wB,2)/(-2*Math.pow(zB,2)));return 1/(zB*Math.sqrt(2*Math.PI))*OB},SB.cdf=function(CB){var OB,RB=(CB-wB)/zB,DB=Math.abs(RB);if(37<DB)OB=0;else{var AB,PB=Math.exp(-DB*DB/2);7.07106781186547>DB?(AB=.0352624965998911*DB+.700383064443688,AB=AB*DB+6.37396220353165,AB=AB*DB+33.912866078383,AB=AB*DB+112.079291497871,AB=AB*DB+221.213596169931,AB=AB*DB+220.206867912376,OB=PB*AB,AB=.0883883476483184*DB+1.75566716318264,AB=AB*DB+16.064177579207,AB=AB*DB+86.7807322029461,AB=AB*DB+296.564248779674,AB=AB*DB+637.333633378831,AB=AB*DB+793.826512519948,AB=AB*DB+440.413735824752,OB/=AB):(AB=DB+.65,AB=DB+4/AB,AB=DB+3/AB,AB=DB+2/AB,AB=DB+1/AB,OB=PB/AB/2.506628274631)}return 0<RB?1-OB:OB},SB.icdf=function(CB){if(0>=CB||1<=CB)return NaN;var OB=2*CB-1,RB=8*(Math.PI-3)/(3*Math.PI*(4-Math.PI)),DB=2/(Math.PI*RB)+Math.log(1-Math.pow(OB,2))/2,AB=Math.log(1-OB*OB)/RB,PB=(0<OB?1:-1)*Math.sqrt(Math.sqrt(DB*DB-AB)-DB);return wB+zB*Math.SQRT2*PB},SB.mean(_B).stdev(kB)}function lk(_B,kB){var wB=ik(_B,kB);return[U_.quantile(wB.sort(U_.ascending),.25),U_.quantile(wB,.5),U_.quantile(wB,.75)]}function uk(_B,kB){var wB=sk(),zB={},EB=0;return zB.data=function(SB){return arguments.length?(_B=SB,EB=SB?SB.length:0,zB.bandwidth(kB)):_B},zB.bandwidth=function(SB){return arguments.length?(kB=SB,!kB&&_B&&(kB=pk(_B)),zB):kB},zB.sample=function(){return _B[~~(Math.random()*EB)]+kB*wB.sample()},zB.pdf=function(SB){for(var CB=0,OB=0;OB<EB;++OB)CB+=wB.pdf((SB-_B[OB])/kB);return CB/kB/EB},zB.cdf=function(SB){for(var CB=0,OB=0;OB<EB;++OB)CB+=wB.cdf((SB-_B[OB])/kB);return CB/EB},zB.icdf=function(){throw Error("KDE icdf not supported.")},zB.data(_B)}function pk(_B){var kB=_B.length,wB=lk(_B),zB=(wB[2]-wB[0])/1.34;return 1.06*Math.min(Math.sqrt(U_.variance(_B)),zB)*Math.pow(kB,-.2)}function ck(_B,kB){function wB(CB){var OB,RB=[],DB=0;for(OB=0;OB<SB;++OB)DB+=RB[OB]=null==CB[OB]?1:+CB[OB];for(OB=0;OB<SB;++OB)RB[OB]/=DB;return RB}var zB,EB={},SB=0;return EB.weights=function(CB){return arguments.length?(zB=wB(kB=CB||[]),EB):kB},EB.distributions=function(CB){return arguments.length?(CB?(SB=CB.length,_B=CB):(SB=0,_B=[]),EB.weights(kB)):_B},EB.sample=function(){for(var CB=Math.random(),OB=_B[SB-1],RB=zB[0],DB=0;DB<SB-1;RB+=zB[++DB])if(CB<RB){OB=_B[DB];break}return OB.sample()},EB.pdf=function(CB){for(var OB=0,RB=0;RB<SB;++RB)OB+=zB[RB]*_B[RB].pdf(CB);return OB},EB.cdf=function(CB){for(var OB=0,RB=0;RB<SB;++RB)OB+=zB[RB]*_B[RB].cdf(CB);return OB},EB.icdf=function(){throw Error("Mixture icdf not supported.")},EB.distributions(_B).weights(kB)}function mk(_B,kB){null==kB&&(kB=null==_B?1:_B,_B=0);var wB,zB,EB,SB={};return SB.min=function(CB){return arguments.length?(wB=CB||0,EB=zB-wB,SB):wB},SB.max=function(CB){return arguments.length?(zB=CB||0,EB=zB-wB,SB):zB},SB.sample=function(){return wB+EB*Math.random()},SB.pdf=function(CB){return CB>=wB&&CB<=zB?1/EB:0},SB.cdf=function(CB){return CB<wB?0:CB>zB?1:(CB-wB)/EB},SB.icdf=function(CB){return 0<=CB&&1>=CB?wB+CB*EB:NaN},SB.min(_B).max(kB)}function fk(_B,kB,wB){return _B.fields=kB||[],_B.fname=wB,_B}function gk(_B){return null==_B?null:_B.fname}function hk(_B){return null==_B?null:_B.fields}function yk(_B){throw Error(_B)}function vk(_B){function kB(){SB.push(DB+_B.substring(wB,zB)),DB="",wB=zB+1}var wB,zB,EB,SB=[],CB=null,OB=0,RB=_B.length,DB="";for(_B+="",wB=zB=0;zB<RB;++zB)if("\\"===(EB=_B[zB]))DB+=_B.substring(wB,zB),wB=++zB;else if(EB===CB)kB(),CB=null,OB=-1;else{if(CB)continue;wB===OB&&"\""===EB?(wB=zB+1,CB=EB):wB===OB&&"'"===EB?(wB=zB+1,CB=EB):"."!==EB||OB?"["===EB?(zB>wB&&kB(),OB=wB=zB+1):"]"===EB&&(OB||yk("Access path missing open bracket: "+_B),0<OB&&kB(),OB=0,wB=zB+1):zB>wB?kB():wB=zB+1}return OB&&yk("Access path missing closing bracket: "+_B),CB&&yk("Access path missing closing quote: "+_B),zB>wB&&(++zB,kB()),SB}function xk(_B){return _B===Object(_B)}function bk(_B){return"string"==typeof _B}function _k(_B){return KT(_B)?"["+_B.map(_k)+"]":xk(_B)||bk(_B)?JSON.stringify(_B).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):_B}function kk(_B,kB){var wB=vk(_B),zB="return _["+wB.map(_k).join("][")+"];";return fk(Function("_",zB),[_B=1===wB.length?wB[0]:_B],kB||_B)}function wk(_B,kB,wB){var zB=[kB].concat([].slice.call(wB));console[_B].apply(console,zB)}function zk(_B){var kB=_B||dF;return{level:function(zB){return arguments.length?(kB=+zB,this):kB},warn:function(){return kB>=oF&&wk("warn","WARN",arguments),this},info:function(){return kB>=sF&&wk("log","INFO",arguments),this},debug:function(){return kB>=lF&&wk("log","DEBUG",arguments),this}}}function Ek(_B){return null==_B?[]:KT(_B)?_B:[_B]}function Sk(_B,kB){var wB,zB,EB,SB,CB,OB,RB,DB,AB=[],PB=(_B=Ek(_B)).map(function(TB,FB){return null==TB?null:(AB.push(FB),vk(TB).map(_k).join("]["))}),qB=AB.length-1,MB=Ek(kB),LB="var u,v;return ";if(0>qB)return null;for(zB=0;zB<=qB;++zB)wB=AB[zB],EB=PB[wB],SB="(u=a["+EB+"])",CB="(v=b["+EB+"])",OB="((v=v instanceof Date?+v:v),(u=u instanceof Date?+u:u))",RB="descending"===MB[wB]?(DB=-1,1):(DB=1,-1),LB+="("+SB+"<"+CB+"||u==null)&&v!=null?"+RB+":(u>v||v==null)&&u!=null?"+DB+":"+OB+"!==u&&v===v?"+RB+":v!==v&&u===u?"+DB+(wB<qB?":":":0");return fk(Function("a","b",LB+";"),_B.filter(function(TB){return null!=TB}))}function Ck(_B){return"function"==typeof _B}function Ok(_B){return Ck(_B)?_B:function(){return _B}}function Rk(_B){for(var kB,wB,zB=1,EB=arguments.length;zB<EB;++zB)for(wB in kB=arguments[zB],kB)_B[wB]=kB[wB];return _B}function Dk(_B,kB){var wB,zB,EB,SB,CB,OB=-1,RB=_B.length;if(null==kB){for(;++OB<RB;)if(null!=(zB=_B[OB])&&zB>=zB){wB=EB=zB;break}for(SB=CB=OB;++OB<RB;)null!=(zB=_B[OB])&&(wB>zB&&(wB=zB,SB=OB),EB<zB&&(EB=zB,CB=OB))}else{for(;++OB<RB;)if(null!=(zB=kB(_B[OB],OB,_B))&&zB>=zB){wB=EB=zB;break}for(SB=CB=OB;++OB<RB;)null!=(zB=kB(_B[OB],OB,_B))&&(wB>zB&&(wB=zB,SB=OB),EB<zB&&(EB=zB,CB=OB))}return[SB,CB]}function Ak(_B){function kB(SB){return EB.hasOwnProperty(SB)&&EB[SB]!==uF}var wB,zB,EB={};return wB={size:0,empty:0,object:EB,has:kB,get:function(CB){return kB(CB)?EB[CB]:void 0},set:function(CB,OB){return kB(CB)||(++wB.size,EB[CB]===uF&&--wB.empty),EB[CB]=OB,this},delete:function(CB){return kB(CB)&&(--wB.size,++wB.empty,EB[CB]=uF),this},clear:function(){wB.size=wB.empty=0,wB.object=EB={}},test:function(CB){return arguments.length?(zB=CB,wB):zB},clean:function(){var CB,OB,RB={},DB=0;for(CB in EB)(OB=EB[CB])===uF||zB&&zB(OB)||(RB[CB]=OB,++DB);wB.size=DB,wB.empty=0,wB.object=EB=RB}},_B&&Object.keys(_B).forEach(function(SB){wB.set(SB,_B[SB])}),wB}function Pk(_B,kB){var wB=_B.prototype=Object.create(kB.prototype);return wB.constructor=_B,wB}function qk(_B){return"boolean"==typeof _B}function Mk(_B){return"[object Date]"===Object.prototype.toString.call(_B)}function Lk(_B){return"number"==typeof _B}function Tk(_B){return"[object RegExp]"===Object.prototype.toString.call(_B)}function Fk(_B){return _B=_B?Ek(_B):_B,fk(_B&&_B.length?Function("_","return ''+"+_B.map(function(kB){return"_["+vk(kB).map(_k).join("][")+"]"}).join("+'|'+")+";"):function(){return""},_B,"key")}function Ik(_B,kB,wB,zB){var EB=kB.length,SB=wB.length;if(!SB)return kB;if(!EB)return wB;for(var CB=zB||new kB.constructor(EB+SB),OB=0,RB=0,DB=0;OB<EB&&RB<SB;++DB)CB[DB]=0<_B(kB[OB],wB[RB])?wB[RB++]:kB[OB++];for(;OB<EB;++OB,++DB)CB[DB]=kB[OB];for(;RB<SB;++RB,++DB)CB[DB]=wB[RB];return CB}function Uk(_B,kB){for(var wB="";0<=--kB;)wB+=_B;return wB}function $k(_B,kB,wB,zB){var EB=wB||" ",SB=_B+"",CB=kB-SB.length;return 0>=CB?SB:"left"===zB?Uk(EB,CB)+SB:"center"===zB?Uk(EB,~~(CB/2))+SB+Uk(EB,Math.ceil(CB/2)):SB+Uk(EB,CB)}function jk(_B){return _B[_B.length-1]}function Nk(_B){return null==_B||""===_B?null:_B&&"false"!==_B&&!!_B}function Wk(_B,kB){return null==_B||""===_B?null:kB?kB(_B):Date.parse(_B)}function Bk(_B){return null==_B||""===_B?null:+_B}function Gk(_B){return null==_B||""===_B?null:_B+""}function Vk(_B){for(var kB={},wB=0,zB=_B.length;wB<zB;++wB)kB[_B[wB]]=1;return kB}function Hk(_B,kB,wB,zB){var EB=null==zB?"\u2026":zB,SB=_B+"",CB=SB.length,OB=Math.max(0,kB-EB.length);return CB<=kB?SB:"left"===wB?EB+SB.slice(CB-OB):"center"===wB?SB.slice(0,Math.ceil(OB/2))+EB+SB.slice(CB-~~(OB/2)):SB.slice(0,OB)+EB}function Yk(_B,kB,wB){if(_B){var zB,EB=0,SB=_B.length;if(kB)for(;EB<SB;++EB)(zB=kB(_B[EB]))&&wB(zB,EB,_B);else _B.forEach(wB)}}function Xk(_B){return{options:_B||{},sanitize:Kk,load:Qk,file:ew,http:Zk}}function Jk(_B,kB){return Rk({},_B.options,kB)}function Qk(_B,kB){var wB=this;return wB.sanitize(_B,kB).then(function(zB){var EB=zB.href;return aw(EB,cF)?wB.file(EB.slice(cF.length)):wB.http(EB,kB)})}function Kk(_B,kB){return kB=Jk(this,kB),new Promise(function(wB,zB){var EB,SB,CB,OB;return null==_B||"string"!=typeof _B?void zB("Sanitize failure, invalid URI: "+_k(_B)):void(SB=pF.test(_B),(OB=kB.baseURL)&&!SB&&(aw(_B,"/")||"/"===OB[OB.length-1]||(_B="/"+_B),_B=OB+_B),CB=(EB=aw(_B,cF))||"file"===kB.mode||"http"!==kB.mode&&!SB&&tw(),CB?_B=(EB?"":cF)+_B:aw(_B,"//")&&(_B=(kB.defaultProtocol||"http")+":"+_B),wB({href:_B}))})}function Zk(_B,kB){return kB=Jk(this,kB),new Promise(function(wB,zB){var EB,SB=$_.request(_B);for(EB in kB.headers)SB.header(EB,kB.headers[EB]);mF.forEach(function(CB){kB[CB]&&SB[CB](kB[CB])}),SB.on("error",function(CB){zB(CB||"Error loading URL: "+_B)}).on("load",function(CB){var OB=CB&&CB.responseText;CB&&0!==CB.status?wB(OB):zB(OB||"Error")}).get()})}function ew(_B){return new Promise(function(kB,wB){var zB=tw();zB?zB.readFile(_B,function(EB,SB){EB?wB(EB):kB(SB)}):wB("No file system access for "+_B)})}function tw(){var _B="function"==typeof require&&require("fs");return _B&&Ck(_B.readFile)?_B:null}function aw(_B,kB){return null!=_B&&0===_B.lastIndexOf(kB,0)}function nw(_B,kB){var wB,zB,EB,SB,CB=gF.slice();for(zB=0,EB=_B.length;zB<EB;++zB){for(wB=kB?_B[zB][kB]:_B[zB],SB=0;SB<CB.length;++SB)rw(wB)&&!CB[SB](wB)&&(CB.splice(SB,1),--SB);if(0===CB.length)return"string"}return hF[gF.indexOf(CB[0])]}function iw(_B,kB){return kB.reduce(function(wB,zB){return wB[zB]=nw(_B,zB),wB},{})}function rw(_B){return null!=_B&&_B===_B}function sw(_B){return!(isNaN(+_B)||_B instanceof Date)}function uw(_B){return function(kB,wB){var zB={delimiter:_B};return pw(kB,wB?Rk(wB,zB):zB)}}function pw(_B,kB){return kB.header&&(_B=kB.header.map(_k).join(kB.delimiter)+"\n"+_B),j_.dsvFormat(kB.delimiter).parse(_B+"")}function cw(_B){return"function"==typeof Buffer&&Ck(Buffer.isBuffer)&&Buffer.isBuffer(_B)}function mw(_B,kB){var wB=kB&&kB.property?kk(kB.property):tF;return xk(_B)&&!cw(_B)?fw(wB(_B)):wB(JSON.parse(_B))}function fw(_B,kB){return kB&&kB.copy?JSON.parse(JSON.stringify(_B)):_B}function hw(_B,kB){return 1<arguments.length?(yF[_B]=kB,this):yF.hasOwnProperty(_B)?yF[_B]:null}function yw(_B,kB,wB){kB=kB||{};var zB=hw(kB.type||"json");return zB||yk("Unknown data format type: "+kB.type),_B=zB(_B,kB),kB.parse&&vw(_B,kB.parse,wB),_B.hasOwnProperty("columns")&&delete _B.columns,_B}function vw(_B,kB,wB){wB=wB||B_.timeParse;var zB,EB,SB,CB,OB,RB,DB,AB=_B.columns||Object.keys(_B[0]);for("auto"===kB&&(kB=iw(_B,AB)),AB=Object.keys(kB),zB=AB.map(function(PB){var qB,MB,LB=kB[PB];if(LB&&(0===LB.indexOf("date:")||0===LB.indexOf("utc:")))return qB=LB.split(/:(.+)?/,2),MB=qB[1],("'"===MB[0]&&"'"===MB[MB.length-1]||"\""===MB[0]&&"\""===MB[MB.length-1])&&(MB=MB.slice(1,-1)),"utc"===qB[0]?B_.utcParse(MB):wB(MB);if(!fF[LB])throw Error("Illegal format pattern: "+PB+":"+LB);return fF[LB]}),CB=0,RB=_B.length,DB=AB.length;CB<RB;++CB)for(EB=_B[CB],OB=0;OB<DB;++OB)SB=AB[OB],EB[SB]=zB[OB](EB[SB])}function xw(_B){this.clear(),_B&&this.union(_B)}function bw(_B,kB){var wB,zB=[];return wB={id:"gradient_"+xF++,x1:_B?_B[0]:0,y1:_B?_B[1]:0,x2:kB?kB[0]:1,y2:kB?kB[1]:0,stops:zB,stop:function(SB,CB){return zB.push({offset:SB,color:CB}),wB}}}function _w(_B){this.mark=_B,this.bounds=this.bounds||new xw,this.bounds_prev=this.bounds_prev||new xw}function kw(_B){_w.call(this,_B),this.items=this.items||[]}function ww(_B,kB,wB){return!_B&&"undefined"!=typeof document&&document.createElement&&(_B=document),_B?wB?_B.createElementNS(wB,kB):_B.createElement(kB):null}function zw(_B,kB){kB=kB.toLowerCase();for(var wB=_B.childNodes,zB=0,EB=wB.length;zB<EB;++zB)if(wB[zB].tagName.toLowerCase()===kB)return wB[zB]}function Ew(_B,kB,wB,zB){var EB,SB=_B.childNodes[kB];return SB&&SB.tagName.toLowerCase()===wB.toLowerCase()||(EB=SB||null,SB=ww(_B.ownerDocument,wB,zB),_B.insertBefore(SB,EB)),SB}function Sw(_B,kB){for(var wB=_B.childNodes,zB=wB.length;zB>kB;)_B.removeChild(wB[--zB]);return _B}function Cw(_B){return"mark-"+_B.marktype+(_B.role?" role-"+_B.role:"")+(_B.name?" "+_B.name:"")}function Ow(_B,kB){var wB=ww(null,"canvas");return wB?(wB.width=_B,wB.height=kB):bF&&(wB=new bF(_B,kB)),wB}function Rw(_B){this._pending=0,this._loader=_B||Xk()}function Dw(_B){_B._pending+=1}function Aw(_B){_B._pending-=1}function Pw(_B,kB,wB){var zB=zF.hasOwnProperty(_B)&&zF[_B],EB=null;return zB&&(EB=zB.curve||zB[kB||"vertical"],zB.tension&&null!=wB&&(EB=EB[zB.tension](wB))),EB}function qw(_B){var kB,wB,zB,EB,SB,CB,OB,RB,DB,AB,PB,qB=[];for(kB=_B.slice().replace(SF[0],"###$1").split(SF[1]).slice(1),RB=0,AB=kB.length;RB<AB;++RB){for(wB=kB[RB],zB=wB.slice(1).trim().replace(SF[2],"$1###$2").split(SF[3]),CB=wB.charAt(0),EB=[CB],DB=0,PB=zB.length;DB<PB;++DB)(SB=+zB[DB])===SB&&EB.push(SB);if(OB=EF[CB.toLowerCase()],EB.length-1>OB)for(DB=1,PB=EB.length;DB<PB;DB+=OB)qB.push([CB].concat(EB.slice(DB,DB+OB)));else qB.push(EB)}return qB}function Mw(_B,kB,wB,zB,EB,SB,CB,OB,RB){var DB=RF.call(arguments);if(CF[DB])return CF[DB];var AB=CB*(Math.PI/180),PB=Math.sin(AB),qB=Math.cos(AB);wB=Math.abs(wB),zB=Math.abs(zB);var MB=.5*(qB*(OB-_B))+.5*(PB*(RB-kB)),LB=.5*(qB*(RB-kB))-.5*(PB*(OB-_B)),TB=MB*MB/(wB*wB)+LB*LB/(zB*zB);1<TB&&(TB=Math.sqrt(TB),wB*=TB,zB*=TB);var FB=qB/wB,IB=PB/wB,UB=-PB/zB,$B=qB/zB,jB=FB*OB+IB*RB,NB=UB*OB+$B*RB,WB=FB*_B+IB*kB,BB=UB*_B+$B*kB,VB=1/((WB-jB)*(WB-jB)+(BB-NB)*(BB-NB))-.25;0>VB&&(VB=0);var HB=Math.sqrt(VB);SB==EB&&(HB=-HB);var YB=.5*(jB+WB)-HB*(BB-NB),XB=.5*(NB+BB)+HB*(WB-jB),JB=Math.atan2(NB-XB,jB-YB),QB=Math.atan2(BB-XB,WB-YB),KB=QB-JB;0>KB&&1===SB?KB+=2*Math.PI:0<KB&&0===SB&&(KB-=2*Math.PI);for(var ZB=Math.ceil(Math.abs(KB/(.5*Math.PI+.001))),eG=[],tG=0;tG<ZB;++tG){var aG=JB+tG*KB/ZB,nG=JB+(tG+1)*KB/ZB;eG[tG]=[YB,XB,aG,nG,wB,zB,PB,qB]}return CF[DB]=eG}function Lw(_B){var kB=RF.call(_B);if(OF[kB])return OF[kB];var wB=_B[0],zB=_B[1],EB=_B[2],SB=_B[3],CB=_B[4],OB=_B[5],RB=_B[6],DB=_B[7],AB=DB*CB,PB=-RB*OB,qB=RB*CB,MB=DB*OB,LB=Math.cos(EB),TB=Math.sin(EB),FB=Math.cos(SB),IB=Math.sin(SB),UB=.5*(SB-EB),$B=Math.sin(.5*UB),jB=8/3*$B*$B/Math.sin(UB),NB=wB+LB-jB*TB,WB=zB+TB+jB*LB,BB=wB+FB,GB=zB+IB,VB=BB+jB*IB,HB=GB-jB*FB;return OF[kB]=[AB*NB+PB*WB,qB*NB+MB*WB,AB*VB+PB*HB,qB*VB+MB*HB,AB*BB+PB*GB,qB*BB+MB*GB]}function Tw(_B,kB){var wB=DF[0]=_B[0];if("a"===wB||"A"===wB)DF[1]=kB*_B[1],DF[2]=kB*_B[2],DF[6]=kB*_B[6],DF[7]=kB*_B[7];else for(var zB=1,EB=_B.length;zB<EB;++zB)DF[zB]=kB*_B[zB];return DF}function Fw(_B,kB,wB,zB,EB){var SB,CB,OB,RB,DB,AB=null,PB=0,qB=0,MB=0,LB=0;null==wB&&(wB=0),null==zB&&(zB=0),null==EB&&(EB=1),_B.beginPath&&_B.beginPath();for(var TB=0,FB=kB.length;TB<FB;++TB){switch(SB=kB[TB],1!==EB&&(SB=Tw(SB,EB)),SB[0]){case"l":PB+=SB[1],qB+=SB[2],_B.lineTo(PB+wB,qB+zB);break;case"L":PB=SB[1],qB=SB[2],_B.lineTo(PB+wB,qB+zB);break;case"h":PB+=SB[1],_B.lineTo(PB+wB,qB+zB);break;case"H":PB=SB[1],_B.lineTo(PB+wB,qB+zB);break;case"v":qB+=SB[1],_B.lineTo(PB+wB,qB+zB);break;case"V":qB=SB[1],_B.lineTo(PB+wB,qB+zB);break;case"m":PB+=SB[1],qB+=SB[2],_B.moveTo(PB+wB,qB+zB);break;case"M":PB=SB[1],qB=SB[2],_B.moveTo(PB+wB,qB+zB);break;case"c":CB=PB+SB[5],OB=qB+SB[6],MB=PB+SB[3],LB=qB+SB[4],_B.bezierCurveTo(PB+SB[1]+wB,qB+SB[2]+zB,MB+wB,LB+zB,CB+wB,OB+zB),PB=CB,qB=OB;break;case"C":PB=SB[5],qB=SB[6],MB=SB[3],LB=SB[4],_B.bezierCurveTo(SB[1]+wB,SB[2]+zB,MB+wB,LB+zB,PB+wB,qB+zB);break;case"s":CB=PB+SB[3],OB=qB+SB[4],MB=2*PB-MB,LB=2*qB-LB,_B.bezierCurveTo(MB+wB,LB+zB,PB+SB[1]+wB,qB+SB[2]+zB,CB+wB,OB+zB),MB=PB+SB[1],LB=qB+SB[2],PB=CB,qB=OB;break;case"S":CB=SB[3],OB=SB[4],MB=2*PB-MB,LB=2*qB-LB,_B.bezierCurveTo(MB+wB,LB+zB,SB[1]+wB,SB[2]+zB,CB+wB,OB+zB),PB=CB,qB=OB,MB=SB[1],LB=SB[2];break;case"q":CB=PB+SB[3],OB=qB+SB[4],MB=PB+SB[1],LB=qB+SB[2],_B.quadraticCurveTo(MB+wB,LB+zB,CB+wB,OB+zB),PB=CB,qB=OB;break;case"Q":CB=SB[3],OB=SB[4],_B.quadraticCurveTo(SB[1]+wB,SB[2]+zB,CB+wB,OB+zB),PB=CB,qB=OB,MB=SB[1],LB=SB[2];break;case"t":CB=PB+SB[1],OB=qB+SB[2],null===AB[0].match(/[QqTt]/)?(MB=PB,LB=qB):"t"===AB[0]?(MB=2*PB-RB,LB=2*qB-DB):"q"===AB[0]&&(MB=2*PB-MB,LB=2*qB-LB),RB=MB,DB=LB,_B.quadraticCurveTo(MB+wB,LB+zB,CB+wB,OB+zB),PB=CB,qB=OB,MB=PB+SB[1],LB=qB+SB[2];break;case"T":CB=SB[1],OB=SB[2],MB=2*PB-MB,LB=2*qB-LB,_B.quadraticCurveTo(MB+wB,LB+zB,CB+wB,OB+zB),PB=CB,qB=OB;break;case"a":Iw(_B,PB+wB,qB+zB,[SB[1],SB[2],SB[3],SB[4],SB[5],SB[6]+PB+wB,SB[7]+qB+zB]),PB+=SB[6],qB+=SB[7];break;case"A":Iw(_B,PB+wB,qB+zB,[SB[1],SB[2],SB[3],SB[4],SB[5],SB[6]+wB,SB[7]+zB]),PB=SB[6],qB=SB[7];break;case"z":case"Z":_B.closePath();}AB=SB}}function Iw(_B,kB,wB,zB){for(var CB,EB=Mw(zB[5],zB[6],zB[0],zB[1],zB[3],zB[4],zB[2],kB,wB),SB=0;SB<EB.length;++SB)CB=Lw(EB[SB]),_B.bezierCurveTo(CB[0],CB[1],CB[2],CB[3],CB[4],CB[5])}function Uw(_B){return qF.hasOwnProperty(_B)?qF[_B]:$w(_B)}function $w(_B){if(!MF.hasOwnProperty(_B)){var kB=qw(_B);MF[_B]={draw:function(zB,EB){Fw(zB,kB,0,0,Math.sqrt(EB)/2)}}}return MF[_B]}function jw(_B){return _B.x}function Nw(_B){return _B.y}function Ww(_B){return _B.width}function Bw(_B){return _B.height}function Gw(_B){return function(){return _B}}function Vw(){function _B(OB,RB,DB){var AB,PB=null==RB?+kB.call(this,OB):RB,qB=null==DB?+wB.call(this,OB):DB,MB=+zB.call(this,OB),LB=+EB.call(this,OB),TB=+SB.call(this,OB);if(CB||(CB=AB=V_.path()),0>=TB)CB.rect(PB,qB,MB,LB);else{var FB=PB+MB,IB=qB+LB;CB.moveTo(PB+TB,qB),CB.lineTo(FB-TB,qB),CB.quadraticCurveTo(FB,qB,FB,qB+TB),CB.lineTo(FB,IB-TB),CB.quadraticCurveTo(FB,IB,FB-TB,IB),CB.lineTo(PB+TB,IB),CB.quadraticCurveTo(PB,IB,PB,IB-TB),CB.lineTo(PB,qB+TB),CB.quadraticCurveTo(PB,qB,PB+TB,qB),CB.closePath()}return AB?(CB=null,AB+""||null):void 0}var kB=jw,wB=Nw,zB=Ww,EB=Bw,SB=Gw(0),CB=null;return _B.x=function(OB){return arguments.length?(kB="function"==typeof OB?OB:Gw(+OB),_B):kB},_B.y=function(OB){return arguments.length?(wB="function"==typeof OB?OB:Gw(+OB),_B):wB},_B.width=function(OB){return arguments.length?(zB="function"==typeof OB?OB:Gw(+OB),_B):zB},_B.height=function(OB){return arguments.length?(EB="function"==typeof OB?OB:Gw(+OB),_B):EB},_B.cornerRadius=function(OB){return arguments.length?(SB="function"==typeof OB?OB:Gw(+OB),_B):SB},_B.context=function(OB){return arguments.length?(CB=null==OB?null:OB,_B):CB},_B}function Hw(){function _B(PB,qB,MB){var LB=MB/2;if(CB){var TB=RB-qB,FB=PB-OB;if(TB||FB){var IB=Math.sqrt(TB*TB+FB*FB),UB=(TB/=IB)*DB,$B=(FB/=IB)*DB,jB=Math.atan2(FB,TB);AB.moveTo(OB-UB,RB-$B),AB.lineTo(PB-TB*LB,qB-FB*LB),AB.arc(PB,qB,LB,jB-LF,jB),AB.lineTo(OB+UB,RB+$B),AB.arc(OB,RB,DB,jB,jB+LF)}else AB.arc(PB,qB,LB,0,2*LF);AB.closePath()}else CB=1;OB=PB,RB=qB,DB=LB}function kB(PB){var qB,MB,LB,TB=PB.length,FB=!1;for(null==AB&&(AB=LB=V_.path()),qB=0;qB<=TB;++qB)!(qB<TB&&SB(MB=PB[qB],qB,PB))===FB&&(FB=!FB)&&(CB=0),FB&&_B(+wB(MB,qB,PB),+zB(MB,qB,PB),+EB(MB,qB,PB));if(LB)return AB=null,LB+""||null}var wB,zB,EB,SB,CB,OB,RB,DB,AB=null;return kB.x=function(PB){return arguments.length?(wB=PB,kB):wB},kB.y=function(PB){return arguments.length?(zB=PB,kB):zB},kB.size=function(PB){return arguments.length?(EB=PB,kB):EB},kB.defined=function(PB){return arguments.length?(SB=PB,kB):SB},kB.context=function(PB){return arguments.length?(AB=null==PB?null:PB,kB):AB},kB}function Yw(_B){return _B.x||0}function Xw(_B){return _B.y||0}function tz(_B){return _B.cornerRadius||0}function nz(_B){return!1!==_B.defined}function lz(_B,kB,wB,zB){return $F.context(_B)(kB,wB,zB)}function mz(_B,kB){return kB.stroke&&0!==kB.opacity&&0!==kB.strokeOpacity&&_B.expand(null==kB.strokeWidth?1:+kB.strokeWidth),_B}function fz(_B){return wF=_B,fz}function gz(){}function hz(_B,kB){wF.add(_B,kB)}function yz(_B,kB,wB){for(var zB=wB.width(),EB=wB.height(),SB=wB.x1+kB.x1*zB,CB=wB.y1+kB.y1*EB,OB=wB.x1+kB.x2*zB,RB=wB.y1+kB.y2*EB,DB=kB.stops,AB=0,PB=DB.length,qB=_B.createLinearGradient(SB,CB,OB,RB);AB<PB;++AB)qB.addColorStop(DB[AB].offset,DB[AB].color);return qB}function vz(_B,kB,wB){return wB.id?yz(_B,wB,kB.bounds):wB}function xz(_B,kB,wB){return 0<(wB*=null==kB.fillOpacity?1:kB.fillOpacity)&&(_B.globalAlpha=wB,_B.fillStyle=vz(_B,kB,kB.fill),!0)}function bz(_B,kB,wB){var zB=null==(zB=kB.strokeWidth)?1:zB;return!(0>=zB)&&0<(wB*=null==kB.strokeOpacity?1:kB.strokeOpacity)&&(_B.globalAlpha=wB,_B.strokeStyle=vz(_B,kB,kB.stroke),_B.lineWidth=zB,_B.lineCap=kB.strokeCap||"butt",_B.lineJoin=kB.strokeJoin||"miter",_B.miterLimit=kB.strokeMiterLimit||10,_B.setLineDash&&(_B.setLineDash(kB.strokeDash||YF),_B.lineDashOffset=kB.strokeDashOffset||0),!0)}function _z(_B,kB){return _B.zindex-kB.zindex||_B.index-kB.index}function kz(_B){if(!_B.zdirty)return _B.zitems;var kB,wB,zB,EB=_B.items,SB=[];for(wB=0,zB=EB.length;wB<zB;++wB)kB=EB[wB],kB.index=wB,kB.zindex&&SB.push(kB);return _B.zdirty=!1,_B.zitems=SB.sort(_z)}function wz(_B,kB){var wB,zB,EB=_B.items;if(EB&&EB.length){var SB=kz(_B);if(SB&&SB.length){for(wB=0,zB=EB.length;wB<zB;++wB)EB[wB].zindex||kB(EB[wB]);EB=SB}for(wB=0,zB=EB.length;wB<zB;++wB)kB(EB[wB])}}function zz(_B,kB){var wB,zB,EB=_B.items;if(!EB||!EB.length)return null;var SB=kz(_B);for(SB&&SB.length&&(EB=SB),zB=EB.length;0<=--zB;)if(wB=kB(EB[zB]))return wB;if(EB===SB)for(EB=_B.items,zB=EB.length;0<=--zB;)if(!EB[zB].zindex&&(wB=kB(EB[zB])))return wB;return null}function Ez(_B){return function(kB,wB,zB){wz(wB,function(EB){zB&&!zB.intersects(EB.bounds)||Cz(_B,kB,EB,EB)})}}function Sz(_B){return function(kB,wB,zB){wB.items.length&&(!zB||zB.intersects(wB.bounds))&&Cz(_B,kB,wB.items[0],wB.items)}}function Cz(_B,kB,wB,zB){var EB=null==wB.opacity?1:wB.opacity;0!==EB&&(_B(kB,zB)||(wB.fill&&xz(kB,wB,EB)&&kB.fill(),wB.stroke&&bz(kB,wB,EB)&&kB.stroke()))}function Oz(_B){return _B||(_B=XF),function(kB,wB,zB,EB,SB,CB){return 1<kB.pixelRatio&&(zB*=kB.pixelRatio,EB*=kB.pixelRatio),zz(wB,function(OB){var RB=OB.bounds;if((!RB||RB.contains(SB,CB))&&RB)return _B(kB,OB,zB,EB,SB,CB)?OB:void 0})}}function Rz(_B,kB){return function(wB,zB,EB,SB){var CB,OB,RB=Array.isArray(zB)?zB[0]:zB,DB=null==kB?RB.fill:kB,AB=RB.stroke&&wB.isPointInStroke;return AB&&(CB=RB.strokeWidth,OB=RB.strokeCap,wB.lineWidth=null==CB?1:CB,wB.lineCap=null==OB?"butt":OB),!_B(wB,zB)&&(DB&&wB.isPointInPath(EB,SB)||AB&&wB.isPointInStroke(EB,SB))}}function Dz(_B){return Oz(Rz(_B))}function Az(_B,kB){return"translate("+_B+","+kB+")"}function Pz(_B){return Az(_B.x||0,_B.y||0)}function qz(_B,kB){function EB(SB,CB){var OB=CB.x||0,RB=CB.y||0;SB.translate(OB,RB),SB.beginPath(),kB(SB,CB),SB.translate(-OB,-RB)}return{type:_B,tag:"path",nested:!1,attr:function(SB,CB){SB("transform",Pz(CB)),SB("d",kB(null,CB))},bound:function(SB,CB){return kB(fz(SB),CB),mz(SB,CB).translate(CB.x||0,CB.y||0)},draw:Ez(EB),pick:Dz(EB)}}function Mz(_B,kB){function EB(OB,RB){OB.beginPath(),kB(OB,RB)}var CB=Rz(EB);return{type:_B,tag:"path",nested:!0,attr:function(OB,RB){var DB=RB.mark.items;DB.length&&OB("d",kB(null,DB))},bound:function(OB,RB){var DB=RB.items;return 0===DB.length?OB:(kB(fz(OB),DB),mz(OB,DB[0]))},draw:Sz(EB),pick:function(OB,RB,DB,AB,PB,qB){var MB=RB.items,LB=RB.bounds;return MB&&MB.length&&(!LB||LB.contains(PB,qB))?(1<OB.pixelRatio&&(DB*=OB.pixelRatio,AB*=OB.pixelRatio),CB(OB,MB,DB,AB)?MB[0]:null):null}}}function Lz(_B,kB,wB){var zB=_B._defs,EB=kB.clip_id||(kB.clip_id="clip"+zB.clip_id++),SB=zB.clipping[EB]||(zB.clipping[EB]={id:EB});return SB.width=wB.width||0,SB.height=wB.height||0,"url(#"+EB+")"}function Nz(_B,kB,wB){return(!1!==_B.interactive||"group"===_B.marktype)&&_B.bounds&&_B.bounds.contains(kB,wB)}function Wz(_B,kB){var wB=_B.image;return wB&&wB.url===_B.url||(wB={loaded:!1,width:0,height:0},kB.loadImage(_B.url).then(function(zB){_B.image=zB,_B.image.url=_B.url})),wB}function Bz(_B,kB){return"center"===_B?kB/2:"right"===_B?kB:0}function Gz(_B,kB){return"middle"===_B?kB/2:"bottom"===_B?kB:0}function Jz(_B,kB){var wB=kB.path;if(null==wB)return!0;var zB=kB.pathCache;zB&&zB.path===wB||((kB.pathCache=zB=qw(wB)).path=wB),Fw(_B,zB,kB.x,kB.y)}function eE(_B,kB){_B.beginPath(),lz(_B,kB)}function nE(_B,kB,wB){var zB,EB,SB,CB;return kB.stroke&&bz(_B,kB,wB)&&(zB=kB.x||0,EB=kB.y||0,SB=null==kB.x2?zB:kB.x2,CB=null==kB.y2?EB:kB.y2,_B.beginPath(),_B.moveTo(zB,EB),_B.lineTo(SB,CB),!0)}function dE(_B){return HF=uE(_B),oE(cE(_B))}function oE(_B){return~~(.8*_B.length*HF)}function sE(_B){return VF.font=fE(_B),lE(cE(_B))}function lE(_B){return VF.measureText(_B).width}function uE(_B){return null==_B.fontSize?11:_B.fontSize}function pE(_B){VF=_B&&(VF=Ow(1,1))?VF.getContext("2d"):null,dI.width=VF?sE:dE}function cE(_B){var kB=_B.text;return null==kB?"":0<_B.limit?mE(_B):kB+""}function mE(_B){var kB=+_B.limit,wB=_B.text+"",zB=VF?(VF.font=fE(_B),lE):(HF=uE(_B),oE);if(zB(wB)<kB)return wB;var EB,SB=_B.ellipsis||"\u2026",CB="rtl"===_B.dir,OB=0,RB=wB.length;if(kB-=zB(SB),CB){for(;OB<RB;)EB=OB+RB>>>1,zB(wB.slice(EB))>kB?OB=EB+1:RB=EB;return SB+wB.slice(OB)}for(;OB<RB;)EB=1+(OB+RB>>>1),zB(wB.slice(0,EB))<kB?OB=EB:RB=EB-1;return wB.slice(0,OB)+SB}function fE(_B,kB){var wB=_B.font;return kB&&wB&&(wB=(wB+"").replace(/\"/g,"'")),(_B.fontStyle?_B.fontStyle+" ":"")+(_B.fontVariant?_B.fontVariant+" ":"")+(_B.fontWeight?_B.fontWeight+" ":"")+uE(_B)+"px "+(wB||"sans-serif")}function gE(_B){var kB=_B.baseline,wB=uE(_B);return Math.round("top"===kB?.93*wB:"middle"===kB?.3*wB:"bottom"===kB?-.21*wB:0)}function yE(_B,kB,wB){var zB,EB,SB=dI.height(kB),CB=kB.align,OB=kB.radius||0,RB=kB.x||0,DB=kB.y||0,AB=kB.dx||0,PB=(kB.dy||0)+gE(kB)-Math.round(.8*SB);return OB&&(EB=(kB.theta||0)-Math.PI/2,RB+=OB*Math.cos(EB),DB+=OB*Math.sin(EB)),zB=dI.width(kB),"center"===CB?AB-=zB/2:"right"===CB&&(AB-=zB),_B.set(AB+=RB,PB+=DB,AB+zB,PB+SB),kB.angle&&!wB&&_B.rotate(kB.angle*Math.PI/180,RB,DB),_B.expand(wB?0:1)}function bE(_B,kB,wB){var zB=pI[_B.mark.marktype],EB=kB||zB.bound;zB.nested&&(_B=_B.mark);var SB=_B.bounds,CB=_B.bounds_prev||(_B.bounds_prev=new xw);return SB?(CB.clear().union(SB),SB.clear()):_B.bounds=new xw,EB(_B.bounds,_B,wB),SB||CB.clear().union(_B.bounds),_B.bounds}function _E(_B,kB,wB){var zB,EB,SB,CB,OB=pI[_B.marktype],RB=OB.bound,DB=_B.items,AB=DB&&DB.length;if(OB.nested)return SB=AB?DB[0]:(cI.mark=_B,cI),CB=bE(SB,RB,wB),kB=kB&&kB.union(CB)||CB;if(kB=kB||_B.bounds&&_B.bounds.clear()||new xw,AB)for(zB=0,EB=DB.length;zB<EB;++zB)kB.union(bE(DB[zB],RB,wB));return _B.bounds=kB}function kE(_B,kB){return JSON.stringify(_B,mI,kB)}function wE(_B){return zE("string"==typeof _B?JSON.parse(_B):_B)}function zE(_B){var kB,wB,zB,EB=_B.marktype,SB=_B.items;if(SB)for(wB=0,zB=SB.length;wB<zB;++wB)kB=EB?"mark":"group",SB[wB][kB]=_B,SB[wB].zindex&&(SB[wB][kB].zdirty=!0),"group"===(EB||kB)&&zE(SB[wB]);return EB&&_E(_B),_B}function EE(_B){arguments.length?this.root=wE(_B):(this.root=SE({marktype:"group",name:"root",role:"frame"}),this.root.items=[new kw(this.root)])}function SE(_B,kB){return{bounds:new xw,bounds_prev:new xw,clip:!!_B.clip,group:kB,interactive:!1!==_B.interactive,items:[],marktype:_B.marktype,name:_B.name||void 0,role:_B.role||void 0,zindex:_B.zindex||0}}function CE(_B){this._active=null,this._handlers={},this._loader=_B||Xk()}function OE(_B){this._el=null,this._bgcolor=null,this._loader=new Rw(_B)}function RE(_B,kB){var wB=kB.getBoundingClientRect();return[_B.clientX-wB.left-(kB.clientLeft||0),_B.clientY-wB.top-(kB.clientTop||0)]}function DE(_B){CE.call(this,_B),this._down=null,this._touch=null,this._first=!0}function AE(_B,kB,wB){return function(zB){var EB=this._active,SB=this.pickEvent(zB);SB===EB?this.fire(_B,zB):(EB&&EB.exit||this.fire(wB,zB),this._active=SB,this.fire(kB,zB),this.fire(_B,zB))}}function PE(_B){return function(kB){this.fire(_B,kB),this._active=null}}function qE(_B,kB){var wB=kB.group;_B.save(),_B.beginPath(),_B.rect(0,0,wB.width||0,wB.height||0),_B.clip()}function ME(_B,kB,wB,zB){var EB="undefined"!=typeof HTMLElement&&_B instanceof HTMLElement&&null!=_B.parentNode,SB=_B.getContext("2d"),CB=EB?vI:1;return _B.width=kB*CB,_B.height=wB*CB,1!==CB&&(_B.style.width=kB+"px",_B.style.height=wB+"px"),SB.pixelRatio=CB,SB.setTransform(CB,0,0,CB,CB*zB[0],CB*zB[1]),_B}function LE(_B){OE.call(this,_B),this._redraw=!1}function TE(_B,kB){var wB,zB,EB,SB,CB,OB=new xw;for(wB=0,zB=kB.length;wB<zB;++wB)EB=kB[wB],SB=EB.mark,CB=SB.group,EB=pI[SB.marktype].nested?SB:EB,OB.union(FE(EB.bounds,CB)),EB.bounds_prev&&OB.union(FE(EB.bounds_prev,CB));return OB.expand(1).round(),_B.beginPath(),_B.rect(OB.x1,OB.y1,OB.width(),OB.height()),_B.clip(),OB}function FE(_B,kB){if(null==kB)return _B;for(var wB=_I.clear().union(_B);null!=kB;kB=kB.mark.group)wB.translate(kB.x||0,kB.y||0);return wB}function IE(_B){CE.call(this,_B);var kB=this;kB._hrefHandler=UE(kB,function(wB,zB){zB&&zB.href&&kB.handleHref(wB,zB,zB.href)}),kB._tooltipHandler=UE(kB,function(wB,zB){zB&&zB.tooltip&&kB.handleTooltip(wB,zB,"mouseover"===wB.type?zB.tooltip:null)})}function UE(_B,kB){return function(wB){var zB=wB.target,EB=zB.__data__;wB.vegaType=wB.type,EB=Array.isArray(EB)?EB[0]:EB,kB.call(_B._obj,wB,EB)}}function $E(_B,kB,wB){var zB,EB,SB="<"+_B;if(kB)for(zB in kB)null!=(EB=kB[zB])&&(SB+=" "+zB+"=\""+EB+"\"");return wB&&(SB+=" "+wB),SB+">"}function jE(_B){return"</"+_B+">"}function NE(_B){OE.call(this,_B),this._dirtyID=0,this._svg=null,this._root=null,this._defs=null}function WE(_B,kB,wB){var zB,EB,SB;for(_B=Ew(_B,wB,"linearGradient",SI),_B.setAttribute("id",kB.id),_B.setAttribute("x1",kB.x1),_B.setAttribute("x2",kB.x2),_B.setAttribute("y1",kB.y1),_B.setAttribute("y2",kB.y2),zB=0,EB=kB.stops.length;zB<EB;++zB)SB=Ew(_B,zB,"stop",SI),SB.setAttribute("offset",kB.stops[zB].offset),SB.setAttribute("stop-color",kB.stops[zB].color);Sw(_B,zB)}function BE(_B,kB,wB){var zB;_B=Ew(_B,wB,"clipPath",SI),_B.setAttribute("id",kB.id),zB=Ew(_B,0,"rect",SI),zB.setAttribute("x",0),zB.setAttribute("y",0),zB.setAttribute("width",kB.width),zB.setAttribute("height",kB.height)}function GE(_B,kB){for(;_B&&_B.dirty!==kB;_B=_B.mark.group){if(_B.dirty=kB,!_B.mark||_B.mark.dirty===kB)return;_B.mark.dirty=kB}}function VE(_B,kB,wB){kB=kB.lastChild;var zB,EB=0;wz(wB,function(SB){zB=_B.draw(kB,SB,zB),++EB}),Sw(kB,1+EB)}function HE(_B,kB,wB,zB){var EB,SB=_B._svg;if(!SB&&(EB=kB.ownerDocument,SB=ww(EB,zB,SI),_B._svg=SB,_B.mark&&(SB.__data__=_B,SB.__values__={fill:"default"},"g"===zB))){var CB=ww(EB,"path",SI);CB.setAttribute("class","background"),SB.appendChild(CB),CB.__data__=_B;var OB=ww(EB,"g",SI);SB.appendChild(OB),OB.__data__=_B}return(EB||SB.previousSibling!==wB)&&kB.insertBefore(SB,wB?wB.nextSibling:kB.firstChild),SB}function YE(_B,kB,wB){kB!==DI[_B]&&(null==kB?wB?RI.removeAttributeNS(wB,_B):RI.removeAttribute(_B):wB?RI.setAttributeNS(wB,_B,kB):RI.setAttribute(_B,kB),DI[_B]=kB)}function XE(){return"undefined"==typeof window?"":window.location.href}function JE(_B){OE.call(this,_B),this._text={head:"",root:"",foot:"",defs:"",body:""},this._defs={clip_id:1,gradient:{},clipping:{}}}function QE(_B,kB,wB,zB){MI[zB||_B]=kB}function KE(_B,kB,wB,zB){if(null==_B)return"";var EB,SB,CB,OB,RB,DB="";for("bgrect"===wB&&!1===kB.interactive&&(DB+="pointer-events: none;"),"text"===wB&&(DB+="font: "+fE(_B)+";"),EB=0,SB=EI.length;EB<SB;++EB)CB=EI[EB],OB=zI[CB],RB=_B[CB],null==RB?"fill"===OB&&(DB+=(DB.length?" ":"")+"fill: none;"):(RB.id&&(zB.gradient[RB.id]=RB,RB="url(#"+RB.id+")"),DB+=(DB.length?" ":"")+OB+": "+RB+";");return DB?"style=\""+DB+"\"":null}function ZE(_B){return _B.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function eS(_B,kB){return _B=((_B||"")+"").toLowerCase(),1<arguments.length?(TI[_B]=kB,this):TI[_B]}function tS(_B,kB,wB){return _B===kB||("path"===wB?aS(_B,kB):_B instanceof Date&&kB instanceof Date?+_B==+kB:Lk(_B)&&Lk(kB)?Math.abs(_B-kB)<=FI:_B&&kB&&(xk(_B)||xk(kB))?null!=_B&&null!=kB&&nS(_B,kB):_B==kB)}function aS(_B,kB){return tS(qw(_B),qw(kB))}function nS(_B,kB){var wB,zB,EB=Object.keys(_B),SB=Object.keys(kB);if(EB.length!==SB.length)return!1;for(EB.sort(),SB.sort(),zB=EB.length-1;0<=zB;zB--)if(EB[zB]!=SB[zB])return!1;for(zB=EB.length-1;0<=zB;zB--)if(wB=EB[zB],!tS(_B[wB],kB[wB],wB))return!1;return("undefined"===typeof _B?"undefined":babelHelpers.typeof(_B))==("undefined"===typeof kB?"undefined":babelHelpers.typeof(kB))}function iS(_B){var kB=_B||tF,wB=[],zB={};return wB.add=function(EB){var SB=kB(EB);return zB[SB]||(zB[SB]=1,wB.push(EB)),wB},wB.remove=function(EB){var SB,CB=kB(EB);return zB[CB]&&(zB[CB]=0,0<=(SB=wB.indexOf(EB))&&wB.splice(SB,1)),wB},wB}function rS(_B){return _B._id}function dS(_B,kB){for(var wB in _B)"_id"!==wB&&(kB[wB]=_B[wB]);return kB}function oS(_B){var kB=_B===Object(_B)?_B:{data:_B};return kB._id||(kB._id=++II),kB}function sS(_B){return oS(dS(_B,{}))}function lS(_B,kB){return dS(_B,kB)}function uS(_B,kB){return kB._id=_B._id,kB}function pS(_B){return _B&&_B.constructor===cS}function cS(){var _B=[],kB=[],wB=[],zB=[],EB=[];return{constructor:cS,insert:function(CB){for(var OB=Ek(CB),RB=0,DB=OB.length;RB<DB;++RB)_B.push(OB[RB]);return this},remove:function(CB){for(var OB=Ck(CB)?zB:kB,RB=Ek(CB),DB=0,AB=RB.length;DB<AB;++DB)OB.push(RB[DB]);return this},modify:function(CB,OB,RB){var DB={field:OB,value:Ok(RB)};return Ck(CB)?(DB.filter=CB,EB.push(DB)):(DB.tuple=CB,wB.push(DB)),this},encode:function(CB,OB){return wB.push({tuple:CB,field:OB}),this},pulse:function(CB,OB){function RB(FB,IB,UB){UB?FB[IB]=UB(FB):CB.encode=IB,DB[FB._id]=FB}var DB,AB,PB,qB,MB,LB,TB;for(AB=0,PB=_B.length;AB<PB;++AB)CB.add.push(oS(_B[AB]));for(DB={},AB=0,PB=kB.length;AB<PB;++AB)LB=kB[AB],DB[LB._id]=LB;for(AB=0,PB=zB.length;AB<PB;++AB)MB=zB[AB],OB.forEach(function(FB){MB(FB)&&(DB[FB._id]=FB)});for(TB in DB)CB.rem.push(DB[TB]);for(DB={},AB=0,PB=wB.length;AB<PB;++AB)qB=wB[AB],RB(qB.tuple,qB.field,qB.value),CB.modifies(qB.field);for(AB=0,PB=EB.length;AB<PB;++AB)qB=EB[AB],MB=qB.filter,OB.forEach(function(FB){MB(FB)&&RB(FB,qB.field,qB.value)}),CB.modifies(qB.field);for(TB in DB)CB.mod.push(DB[TB]);return CB}}}function mS(){Object.defineProperty(this,UI,{writable:!0,value:{}})}function fS(_B,kB,wB,zB){this.id=++jI,this.value=_B,this.stamp=-1,this.rank=-1,this.qrank=-1,this.flags=0,kB&&(this._update=kB),wB&&this.parameters(wB,zB)}function gS(_B){return function(kB){var wB=this.flags;return 0===arguments.length?!!(wB&_B):(this.flags=kB?wB|_B:wB&~_B,this)}}function vS(_B,kB,wB){this.id=++BI,this.value=null,wB&&(this.receive=wB),_B&&(this._filter=_B),kB&&(this._apply=kB)}function xS(_B,kB,wB){return new vS(_B,kB,wB)}function kS(_B,kB,wB,zB,EB,SB){var CB,OB,RB=Rk({},SB,VI);Ck(wB)||(wB=Ok(wB)),void 0===zB?CB=function(AB){_B.touch(wB(AB))}:Ck(zB)?(OB=new fS(null,zB,EB,!1),CB=function(AB){var PB=wB(AB),qB=(OB.evaluate(AB),OB.value);pS(qB)?_B.pulse(PB,qB,SB):_B.update(PB,qB,RB)}):CB=function(AB){_B.update(wB(AB),zB,RB)},kB.apply(CB)}function wS(_B,kB,wB,zB,EB,SB){var CB,OB;void 0===zB?OB=wB:(CB=Ck(zB)?zB:Ok(zB),zB=wB?function(RB,DB){var AB=CB(RB,DB);return wB.skip()?AB:wB.skip(!0).value=AB}:CB,OB=new fS(null,zB,EB,!1),OB.modified(SB&&SB.force),OB.rank=0,wB&&(OB.skip(!0),OB.value=wB.value,OB.targets().add(wB))),kB.targets().add(OB)}function SS(_B,kB,wB){this.dataflow=_B,this.stamp=null==kB?-1:kB,this.add=[],this.rem=[],this.mod=[],this.fields=null,this.encode=wB||null}function CS(_B,kB){return _B?function(wB,zB){return _B(wB,zB)&&kB(wB,zB)}:kB}function OS(_B,kB){var wB={};return _B.visit(kB,function(zB){wB[zB._id]=1}),function(zB){return wB[zB._id]?null:zB}}function qS(_B){var kB,wB,zB=new Promise(function(EB,SB){kB=EB,wB=SB});return zB.requests=0,zB.done=function(){0==--zB.requests&&_B.runAfter(function(){_B._pending=null;try{_B.run(),kB(_B)}catch(EB){wB(EB)}})},_B._pending=zB}function LS(_B,kB,wB,zB){var EB,SB,CB,OB,RB,DB=this,AB=0;for(this.dataflow=_B,this.stamp=kB,this.fields=null,this.encode=zB||null,this.pulses=wB,CB=0,OB=wB.length;CB<OB;++CB)if(EB=wB[CB],EB.stamp===kB){if(EB.fields)for(RB in SB=DB.fields||(DB.fields={}),EB.fields)SB[RB]=1;EB.changed(DB.ADD)&&(AB|=DB.ADD),EB.changed(DB.REM)&&(AB|=DB.REM),EB.changed(DB.MOD)&&(AB|=DB.MOD)}this.changes=AB}function jS(_B){this.cmp=_B,this.nodes=[]}function NS(_B,kB,wB,zB){var EB,SB,CB;for(EB=_B[wB];wB>kB&&(CB=wB-1>>1,SB=_B[CB],0>zB(EB,SB));)_B[wB]=SB,wB=CB;return _B[wB]=EB}function WS(_B,kB,wB){for(var zB,EB=kB,SB=_B.length,CB=_B[kB],OB=2*kB+1;OB<SB;)zB=OB+1,zB<SB&&0<=wB(_B[OB],_B[zB])&&(OB=zB),_B[kB]=_B[OB],kB=OB,OB=2*kB+1;return _B[kB]=CB,NS(_B,EB,kB,wB)}function BS(){this._log=zk(),this._clock=0,this._rank=0,this._loader=Xk(),this._touched=iS(eF),this._pulses={},this._pulse=null,this._heap=new jS(function(_B,kB){return _B.qrank-kB.qrank}),this._postrun=[]}function GS(_B){return function(){return this._log[_B].apply(this,arguments)}}function VS(_B,kB){fS.call(this,_B,null,kB)}function HS(_B,kB){var wB=_B.type;YS(wB,_B),XS(wB,kB)}function YS(_B,kB){return _B=_B&&_B.toLowerCase(),1<arguments.length?(tU[_B]=kB,this):tU.hasOwnProperty(_B)?tU[_B]:null}function XS(_B,kB){return 1<arguments.length?(eU[_B]=kB,this):eU.hasOwnProperty(_B)?eU[_B]:null}function JS(_B){this._key=_B||"_id",this._add=[],this._rem=[],this._ext=null,this._get=null,this._q=null}function QS(_B,kB){return nU[_B](kB)}function KS(_B){return function(kB){var wB=Rk({init:"",add:"",rem:"",idx:0},_B);return wB.out=kB||_B.name,wB}}function ZS(_B,kB){return _B.idx-kB.idx}function eC(_B,kB){function wB(CB,OB){function RB(DB){CB[DB]||wB(CB,CB[DB]=nU[DB]())}return OB.req&&OB.req.forEach(RB),kB&&OB.str&&OB.str.forEach(RB),CB}var zB,EB=_B.reduce(wB,_B.reduce(function(CB,OB){return CB[OB.name]=OB,CB},{})),SB=[];for(zB in EB)SB.push(EB[zB]);return SB.sort(ZS)}function tC(_B,kB){var zB=eC(_B,!0),EB="this.cell = cell; this.tuple = t; this.valid = 0; this.missing = 0;",SB="if(v==null){++this.missing; return;} if(v!==v) return; ++this.valid;",CB="if(v==null){--this.missing; return;} if(v!==v) return; --this.valid;",OB="var t = this.tuple; var cell = this.cell;";return zB.forEach(function(RB){0>RB.idx?(EB=RB.init+EB,SB=RB.add+SB,CB=RB.rem+CB):(EB+=RB.init,SB+=RB.add,CB+=RB.rem)}),_B.slice().sort(ZS).forEach(function(RB){OB+="t['"+RB.out+"']="+RB.set+";"}),OB+="return t;",EB=Function("cell","t",EB),EB.prototype.add=Function("v","t",SB),EB.prototype.rem=Function("v","t",CB),EB.prototype.set=Function(OB),EB.prototype.get=kB||tF,EB.fields=_B.map(function(RB){return RB.out}),EB}function aC(_B){VS.call(this,null,_B),this._adds=[],this._mods=[],this._alen=0,this._mlen=0,this._drop=!0,this._cross=!1,this._dims=[],this._dnames=[],this._measures=[],this._countOnly=!1,this._counts=null,this._prev=null,this._inputs=null,this._outputs=null}function nC(_B,kB,wB){return wB||_B+(kB?"_"+kB:"")}function iC(_B){var kB,wB=this._dims,zB=wB.length,EB=wB[0](_B)+"";for(kB=1;kB<zB;++kB)EB+="|"+wB[kB](_B);return EB}function rC(_B){VS.call(this,null,_B)}function dC(_B){VS.call(this,[],_B)}function oC(_B){fS.call(this,null,sC,_B)}function sC(_B){return this.value&&!_B.modified()?this.value:Sk(_B.fields,_B.orders)}function lC(_B){VS.call(this,null,_B)}function uC(_B,kB,wB){return"upper"===kB?_B=_B.toUpperCase():"lower"===kB?_B=_B.toLowerCase():void 0,_B.match(wB)}function pC(_B){VS.call(this,null,_B)}function cC(_B,kB,wB,zB){for(var EB,SB,CB=[],OB={},RB=_B.length,DB=0;DB<RB;++DB)for(OB[kB]=SB=_B[DB],EB=0;EB<RB;++EB)OB[wB]=_B[EB],zB(OB)&&(CB.push(oS(OB)),OB={},OB[kB]=SB);return CB}function mC(_B,kB){var wB=_B[lU];oU.hasOwnProperty(wB)||yk("Unknown distribution function: "+wB);var zB=oU[wB]();for(var EB in _B)EB===uU?zB.data((_B.from||kB()).map(_B[EB])):EB===sU?zB[EB](_B[EB].map(function(SB){return mC(SB,kB)})):babelHelpers.typeof(zB[EB])===lU&&zB[EB](_B[EB]);return zB}function fC(_B){VS.call(this,null,_B)}function gC(_B){return function(){return _B.materialize(_B.SOURCE).source}}function hC(_B){VS.call(this,[Infinity,-Infinity],_B)}function yC(_B,kB){fS.call(this,_B),this.parent=kB}function vC(_B){VS.call(this,{},_B),this._keys=Ak();var kB=this._targets=[];kB.active=0,kB.forEach=function(wB){for(var zB=0,EB=kB.active;zB<EB;++zB)wB(kB[zB],zB,kB)}}function xC(_B){fS.call(this,null,bC,_B)}function bC(_B){return this.value&&!_B.modified()?this.value:KT(_B.name)?Ek(_B.name).map(function(kB){return kk(kB)}):kk(_B.name,_B.as)}function _C(_B){VS.call(this,Ak(),_B)}function kC(_B){VS.call(this,{},_B)}function wC(_B){return _B.fields.join("|")}function zC(_B){VS.call(this,null,_B)}function EC(_B){VS.call(this,[],_B)}function SC(_B){VS.call(this,[],_B)}function CC(_B){var kB,wB=_B.method||mU.value;return null==mU[wB]?void yk("Unrecognized imputation method: "+wB):wB===mU.value?(kB=void 0===_B.value?0:_B.value,function(){return kB}):mU[wB]}function OC(_B){var kB=_B.field;return function(wB){return wB?kB(wB):NaN}}function RC(_B,kB,wB){var zB,EB,SB,CB,OB,RB,DB,AB,PB,qB=function(UB){return UB(PB)},MB=[],LB=[],TB={},FB={};for(RB=0,AB=_B.length;RB<AB;++RB)PB=_B[RB],EB=(zB=wB.map(qB))+"",DB=TB[EB]||(TB[EB]=LB.push(zB)),CB=(SB=kB?kB.map(qB):fU)+"",(OB=FB[CB])||(OB=FB[CB]=[],MB.push(OB),OB.values=SB),OB[DB-1]=PB;return MB.domain=LB,MB}function DC(_B){fS.call(this,null,AC,_B)}function AC(_B){return this.value&&!_B.modified()?this.value:Fk(_B.fields)}function PC(_B){VS.call(this,{},_B)}function qC(_B){fS.call(this,null,MC,_B)}function MC(_B){if(this.value&&!_B.modified())return this.value;var kB,wB,zB,EB=1/0,SB=-1/0,CB=_B.extents;for(kB=0,wB=CB.length;kB<wB;++kB)zB=CB[kB],zB[0]<EB&&(EB=zB[0]),zB[1]>SB&&(SB=zB[1]);return[EB,SB]}function LC(_B){fS.call(this,null,TC,_B)}function TC(_B){return this.value&&!_B.modified()?this.value:_B.values.reduce(function(kB,wB){return kB.concat(wB)},[])}function FC(_B){VS.call(this,null,_B)}function IC(_B){vC.call(this,_B)}function UC(_B){VS.call(this,null,_B)}function $C(_B){VS.call(this,null,_B)}function jC(_B){VS.call(this,null,_B)}function NC(_B){VS.call(this,[],_B),this.count=0}function WC(_B){VS.call(this,null,_B)}function BC(_B){VS.call(this,null,_B),this.modified(!0)}function GC(_B){VS.call(this,Ak(),_B)}function VC(_B){VS.call(this,null,_B)}function HC(_B){return function(kB){var wB,zB=kB[0],EB=kB[1];return EB<zB&&(wB=zB,zB=EB,EB=wB),[_B.invert(zB),_B.invert(EB)]}}function YC(_B){return function(kB){var wB,zB,EB,SB,CB=_B.range(),OB=kB[0],RB=kB[1],DB=-1;for(RB<OB&&(zB=OB,OB=RB,RB=zB),EB=0,SB=CB.length;EB<SB;++EB)CB[EB]>=OB&&CB[EB]<=RB&&(0>DB&&(DB=EB),wB=EB);if(!(0>DB))return OB=_B.invertExtent(CB[DB]),RB=_B.invertExtent(CB[wB]),[void 0===OB[0]?OB[1]:OB[0],void 0===RB[1]?RB[0]:RB[1]]}}function XC(_B,kB,wB){var zB=_B-kB+2*wB;return _B?0<zB?zB:1:0}function JC(){function _B(){var PB=EB().length,qB=CB[1]<CB[0],MB=CB[qB-0],LB=CB[1-qB],TB=XC(PB,RB,DB);kB=(LB-MB)/(TB||1),OB&&(kB=Math.floor(kB)),MB+=(LB-MB-kB*(PB-RB))*AB,wB=kB*(1-RB),OB&&(MB=Math.round(MB),wB=Math.round(wB));var FB=U_.range(PB).map(function(IB){return MB+kB*IB});return SB(qB?FB.reverse():FB)}var kB,wB,zB=H_.scaleOrdinal().unknown(void 0),EB=zB.domain,SB=zB.range,CB=[0,1],OB=!1,RB=0,DB=0,AB=.5;return delete zB.unknown,zB.domain=function(PB){return arguments.length?(EB(PB),_B()):EB()},zB.range=function(PB){return arguments.length?(CB=[+PB[0],+PB[1]],_B()):CB.slice()},zB.rangeRound=function(PB){return CB=[+PB[0],+PB[1]],OB=!0,_B()},zB.bandwidth=function(){return wB},zB.step=function(){return kB},zB.round=function(PB){return arguments.length?(OB=!!PB,_B()):OB},zB.padding=function(PB){return arguments.length?(RB=DB=Math.max(0,Math.min(1,PB)),_B()):RB},zB.paddingInner=function(PB){return arguments.length?(RB=Math.max(0,Math.min(1,PB)),_B()):RB},zB.paddingOuter=function(PB){return arguments.length?(DB=Math.max(0,Math.min(1,PB)),_B()):DB},zB.align=function(PB){return arguments.length?(AB=Math.max(0,Math.min(1,PB)),_B()):AB},zB.invertRange=function(PB){var qB,MB,LB,TB=+PB[0],FB=+PB[1],IB=CB[1]<CB[0],UB=IB?SB().reverse():SB(),$B=UB.length-1;if(FB<TB&&(LB=TB,TB=FB,FB=LB),!(FB<UB[0]||TB>CB[1-IB]))return qB=Math.max(0,U_.bisectRight(UB,TB)-1),MB=TB===FB?qB:U_.bisectRight(UB,FB)-1,TB-UB[qB]>wB+1e-10&&++qB,IB&&(LB=qB,qB=$B-MB,MB=$B-LB),qB>MB?void 0:EB().slice(qB,MB+1)},zB.invert=function(PB){var qB=zB.invertRange([PB,PB]);return qB?qB[0]:qB},zB.copy=function(){return JC().domain(EB()).range(CB).round(OB).paddingInner(RB).paddingOuter(DB).align(AB)},_B()}function QC(_B){var kB=_B.copy;return _B.padding=_B.paddingOuter,delete _B.paddingInner,_B.copy=function(){return QC(kB())},_B}function ZC(_B){return PU.call(_B,function(kB){return+kB})}function eO(){function _B(EB){return null==EB||EB!==EB?void 0:wB(zB[Math.max(U_.bisect(zB,EB),1)-1])}function kB(EB){zB=ZC(EB),wB.domain([zB[0],jk(zB)])}var wB=H_.scaleLinear(),zB=[];return _B.domain=function(EB){return arguments.length?(kB(EB),_B):zB.slice()},_B.range=function(EB){return arguments.length?(wB.range(EB),_B):wB.range()},_B.rangeRound=function(EB){return arguments.length?(wB.rangeRound(EB),_B):wB.rangeRound()},_B.interpolate=function(EB){return arguments.length?(wB.interpolate(EB),_B):wB.interpolate()},_B.invert=function(EB){return wB.invert(EB)},_B.ticks=function(EB){var SB=zB.length,CB=~~(SB/(EB||SB));return 2>CB?_B.domain():zB.filter(function(OB,RB){return!(RB%CB)})},_B.tickFormat=function(){return wB.tickFormat.apply(wB,arguments)},_B.copy=function(){return eO().domain(_B.domain()).range(_B.range())},_B}function tO(){function _B(zB){return null==zB||zB!==zB?void 0:wB[(U_.bisect(kB,zB)-1)%wB.length]}var kB=[],wB=[];return _B.domain=function(zB){return arguments.length?(kB=ZC(zB),_B):kB.slice()},_B.range=function(zB){return arguments.length?(wB=qU.call(zB),_B):wB.slice()},_B.copy=function(){return tO().domain(_B.domain()).range(_B.range())},_B}function aO(_B){function kB(){var OB=zB.domain();EB=OB[0],SB=jk(OB)-EB}function wB(OB){var RB=(OB-EB)/SB;return _B(CB?Math.max(0,Math.min(1,RB)):RB)}var zB=H_.scaleLinear(),EB=0,SB=1,CB=!1;return wB.clamp=function(OB){return arguments.length?(CB=!!OB,wB):CB},wB.domain=function(OB){return arguments.length?(zB.domain(OB),kB(),wB):zB.domain()},wB.interpolator=function(OB){return arguments.length?(_B=OB,wB):_B},wB.copy=function(){return aO().domain(zB.domain()).clamp(CB).interpolator(_B)},wB.ticks=function(OB){return zB.ticks(OB)},wB.tickFormat=function(OB,RB){return zB.tickFormat(OB,RB)},wB.nice=function(OB){return zB.nice(OB),kB(),wB},wB}function nO(_B,kB){return function(){var wB=kB();return wB.invertRange||(wB.invertRange=wB.invert?HC(wB):wB.invertExtent?YC(wB):void 0),wB.type=_B,wB}}function iO(_B,kB){return 1<arguments.length?(MU[_B]=nO(_B,kB),this):MU.hasOwnProperty(_B)?MU[_B]:void 0}function rO(_B){for(var kB=0|_B.length/6,wB=Array(kB),zB=0;zB<kB;)wB[zB]="#"+_B.slice(6*zB,6*++zB);return wB}function dO(_B,kB){$U[_B]=Y_["interpolate"+kB],UU[_B]=Y_["scheme"+kB]}function oO(_B,kB){if(1<arguments.length)return $U[_B]=kB,this;var wB=_B.split("-");return _B=wB[0],wB=+wB[1]+1,wB&&UU.hasOwnProperty(_B)?UU[_B][wB-1]:!wB&&$U.hasOwnProperty(_B)?$U[_B]:void 0}function sO(_B,kB){var wB=kB[0],zB=jk(kB)-wB;return function(EB){return _B(wB+EB*zB)}}function lO(_B,kB,wB){return"linear"===_B.type||"sequential"===_B.type?function(zB){return(zB-kB)/(wB-kB)}:_B.copy().domain([kB,wB]).range([0,1]).interpolate(uO)}function uO(_B,kB){return function(zB){return _B+zB*(kB-_B)}}function pO(_B,kB){var wB=X_[cO(_B)];return null!=kB&&wB&&wB.gamma?wB.gamma(kB):wB}function cO(_B){return"interpolate"+_B.toLowerCase().split("-").map(function(kB){return kB[0].toUpperCase()+kB.slice(1)}).join("")}function mO(_B,kB){return _B-kB}function fO(_B){for(var kB=0,wB=_B.length,zB=_B[wB-1][1]*_B[0][0]-_B[wB-1][0]*_B[0][1];++kB<wB;)zB+=_B[kB-1][1]*_B[kB][0]-_B[kB-1][0]*_B[kB][1];return zB}function gO(_B){return function(){return _B}}function hO(_B,kB){for(var wB,zB=-1,EB=kB.length;++zB<EB;)if(wB=yO(_B,kB[zB]))return wB;return 0}function yO(_B,kB){for(var wB=kB[0],zB=kB[1],EB=-1,SB=0,CB=_B.length,OB=CB-1;SB<CB;OB=SB++){var RB=_B[SB],DB=RB[0],AB=RB[1],PB=_B[OB],qB=PB[0],MB=PB[1];if(vO(RB,PB,kB))return 0;AB>zB!=MB>zB&&wB<(qB-DB)*(zB-AB)/(MB-AB)+DB&&(EB=-EB)}return EB}function vO(_B,kB,wB){var zB;return xO(_B,kB,wB)&&bO(_B[zB=+(_B[0]===kB[0])],wB[zB],kB[zB])}function xO(_B,kB,wB){return(kB[0]-_B[0])*(wB[1]-_B[1])==(wB[0]-_B[0])*(kB[1]-_B[1])}function bO(_B,kB,wB){return _B<=kB&&kB<=wB||wB<=kB&&kB<=_B}function _O(){}function kO(){function _B(RB){var DB=CB(RB);if(Array.isArray(DB))DB=DB.slice().sort(mO);else{var AB=U_.extent(RB),PB=AB[0],qB=AB[1];DB=U_.tickStep(PB,qB,DB),DB=U_.range(Math.floor(PB/DB)*DB,Math.floor(qB/DB)*DB,DB)}return DB.map(function(MB){var LB=[],TB=[];return kB(RB,MB,function(FB){OB(FB,RB,MB),0<fO(FB)?LB.push([FB]):TB.push(FB)}),TB.forEach(function(FB){for(var IB,UB=0,$B=LB.length;UB<$B;++UB)if(hO((IB=LB[UB])[0],FB))return void IB.push(FB)}),LB}).map(function(MB,LB){return{type:"MultiPolygon",value:DB[LB],coordinates:MB}})}function kB(RB,DB,AB){function PB(jB){var NB,WB,BB=[jB[0][0]+qB,jB[0][1]+MB],GB=[jB[1][0]+qB,jB[1][1]+MB],VB=wB(BB),HB=wB(GB);(NB=$B[VB])?(WB=UB[HB])?(delete $B[NB.end],delete UB[WB.start],NB===WB?(NB.ring.push(GB),AB(NB.ring)):UB[NB.start]=$B[WB.end]={start:NB.start,end:WB.end,ring:NB.ring.concat(WB.ring)}):(delete $B[NB.end],NB.ring.push(GB),$B[NB.end=HB]=NB):(NB=UB[HB])?(WB=$B[VB])?(delete UB[NB.start],delete $B[WB.end],NB===WB?(NB.ring.push(GB),AB(NB.ring)):UB[WB.start]=$B[NB.end]={start:WB.start,end:NB.end,ring:WB.ring.concat(NB.ring)}):(delete UB[NB.start],NB.ring.unshift(BB),UB[NB.start=VB]=NB):UB[VB]=$B[HB]={start:VB,end:HB,ring:[BB,GB]}}var qB,MB,LB,TB,FB,IB,UB=[],$B=[];for(qB=MB=-1,TB=RB[0]>=DB,WU[TB<<1].forEach(PB);++qB<EB-1;)LB=TB,TB=RB[qB+1]>=DB,WU[LB|TB<<1].forEach(PB);for(WU[TB<<0].forEach(PB);++MB<SB-1;){for(qB=-1,TB=RB[MB*EB+EB]>=DB,FB=RB[MB*EB]>=DB,WU[TB<<1|FB<<2].forEach(PB);++qB<EB-1;)LB=TB,TB=RB[MB*EB+EB+qB+1]>=DB,IB=FB,FB=RB[MB*EB+qB+1]>=DB,WU[LB|TB<<1|FB<<2|IB<<3].forEach(PB);WU[TB|FB<<3].forEach(PB)}for(qB=-1,FB=RB[MB*EB]>=DB,WU[FB<<2].forEach(PB);++qB<EB-1;)IB=FB,FB=RB[MB*EB+qB+1]>=DB,WU[FB<<2|IB<<3].forEach(PB);WU[FB<<3].forEach(PB)}function wB(RB){return 2*RB[0]+4*(RB[1]*(EB+1))}function zB(RB,DB,AB){RB.forEach(function(PB){var qB,MB=PB[0],LB=PB[1],TB=0|MB,FB=0|LB,IB=DB[FB*EB+TB];0<MB&&MB<EB&&TB===MB&&(qB=DB[FB*EB+TB-1],PB[0]=MB+(AB-qB)/(IB-qB)-.5),0<LB&&LB<SB&&FB===LB&&(qB=DB[(FB-1)*EB+TB],PB[1]=LB+(AB-qB)/(IB-qB)-.5)})}var EB=1,SB=1,CB=U_.thresholdSturges,OB=zB;return _B.size=function(RB){if(!arguments.length)return[EB,SB];var DB=Math.ceil(RB[0]),AB=Math.ceil(RB[1]);if(!(0<DB&&0<AB))throw new Error("invalid size");return EB=DB,SB=AB,_B},_B.thresholds=function(RB){return arguments.length?(CB="function"==typeof RB?RB:gO(Array.isArray(RB)?NU.call(RB):RB),_B):CB},_B.smooth=function(RB){return arguments.length?(OB=RB?zB:_O,_B):OB===zB},_B}function wO(_B,kB,wB){for(var zB=_B.width,EB=_B.height,SB=1+(wB<<1),CB=0;CB<EB;++CB)for(var OB=0,RB=0;OB<zB+wB;++OB)OB<zB&&(RB+=_B.data[OB+CB*zB]),OB>=wB&&(OB>=SB&&(RB-=_B.data[OB-SB+CB*zB]),kB.data[OB-wB+CB*zB]=RB/Math.min(OB+1,zB-1+SB-OB,SB))}function zO(_B,kB,wB){for(var zB=_B.width,EB=_B.height,SB=1+(wB<<1),CB=0;CB<zB;++CB)for(var OB=0,RB=0;OB<EB+wB;++OB)OB<EB&&(RB+=_B.data[CB+OB*zB]),OB>=wB&&(OB>=SB&&(RB-=_B.data[CB+(OB-SB)*zB]),kB.data[CB+(OB-wB)*zB]=RB/Math.min(OB+1,EB-1+SB-OB,SB))}function EO(_B){return _B[0]}function SO(_B){return _B[1]}function CO(){function _B(FB){var IB=new Float32Array(MB*LB),UB=new Float32Array(MB*LB);FB.forEach(function(NB,WB,BB){var GB=CB(NB,WB,BB)+qB>>PB,VB=OB(NB,WB,BB)+qB>>PB;0<=GB&&GB<MB&&0<=VB&&VB<LB&&++IB[GB+VB*MB]}),wO({width:MB,height:LB,data:IB},{width:MB,height:LB,data:UB},AB>>PB),zO({width:MB,height:LB,data:UB},{width:MB,height:LB,data:IB},AB>>PB),wO({width:MB,height:LB,data:IB},{width:MB,height:LB,data:UB},AB>>PB),zO({width:MB,height:LB,data:UB},{width:MB,height:LB,data:IB},AB>>PB),wO({width:MB,height:LB,data:IB},{width:MB,height:LB,data:UB},AB>>PB),zO({width:MB,height:LB,data:UB},{width:MB,height:LB,data:IB},AB>>PB);var $B=TB(IB);if(!Array.isArray($B)){var jB=U_.max(IB);$B=U_.tickStep(0,jB,$B),$B=U_.range(0,Math.floor(jB/$B)*$B,$B),$B.shift()}return kO().thresholds($B).size([MB,LB])(IB).map(kB)}function kB(FB){return FB.value*=Math.pow(2,-2*PB),FB.coordinates.forEach(wB),FB}function wB(FB){FB.forEach(zB)}function zB(FB){FB.forEach(EB)}function EB(FB){FB[0]=FB[0]*Math.pow(2,PB)-qB,FB[1]=FB[1]*Math.pow(2,PB)-qB}function SB(){return qB=3*AB,MB=RB+2*qB>>PB,LB=DB+2*qB>>PB,_B}var CB=EO,OB=SO,RB=960,DB=500,AB=20,PB=2,qB=3*AB,MB=RB+2*qB>>PB,LB=DB+2*qB>>PB,TB=gO(20);return _B.x=function(FB){return arguments.length?(CB="function"==typeof FB?FB:gO(+FB),_B):CB},_B.y=function(FB){return arguments.length?(OB="function"==typeof FB?FB:gO(+FB),_B):OB},_B.size=function(FB){if(!arguments.length)return[RB,DB];var IB=Math.ceil(FB[0]),UB=Math.ceil(FB[1]);if(!(0<=IB||0<=IB))throw new Error("invalid size");return RB=IB,DB=UB,SB()},_B.cellSize=function(FB){if(!arguments.length)return 1<<PB;if(!(1<=(FB=+FB)))throw new Error("invalid cell size");return PB=Math.floor(Math.log(FB)/Math.LN2),SB()},_B.thresholds=function(FB){return arguments.length?(TB="function"==typeof FB?FB:gO(Array.isArray(FB)?NU.call(FB):FB),_B):TB},_B.bandwidth=function(FB){if(!arguments.length)return Math.sqrt(AB*(AB+1));if(!(0<=(FB=+FB)))throw new Error("invalid bandwidth");return AB=Math.round((Math.sqrt(4*FB*FB+1)-1)/2),SB()},_B}function OO(_B){VS.call(this,null,_B)}function RO(_B,kB){return function wB(){var zB=kB();return zB.type=_B,zB.path=J_.geoPath().projection(zB),zB.copy=zB.copy||function(){var EB=wB();return HU.forEach(function(SB){zB.hasOwnProperty(SB)&&EB[SB](zB[SB]())}),EB.path.pointRadius(zB.path.pointRadius()),EB},zB}}function DO(_B,kB){return 1<arguments.length?(YU[_B]=RO(_B,kB),this):YU.hasOwnProperty(_B)?YU[_B]:null}function AO(_B){return _B&&_B.path||VU}function PO(_B){VS.call(this,null,_B)}function qO(_B){VS.call(this,null,_B)}function MO(_B){VS.call(this,null,_B)}function LO(_B,kB){var wB=function(EB){return _B(kB(EB))};return wB.context=function(zB){return _B.context(zB),wB},wB}function TO(_B){VS.call(this,[],_B),this.generator=J_.geoGraticule()}function FO(_B){VS.call(this,null,_B),this.modified(!0)}function IO(_B,kB){var wB=UO(kB.fit);kB.extent?_B.fitExtent(kB.extent,wB):kB.size&&_B.fitSize(kB.size,wB)}function UO(_B){return KT(_B)?1<_B.length?{type:"FeatureCollection",features:_B}:_B[0]:_B}function $O(_B){var kB=DO((_B||"mercator").toLowerCase());return kB||yk("Unrecognized projection type: "+_B),kB()}function jO(_B,kB,wB){Ck(_B[kB])&&_B[kB](wB)}function NO(_B,kB){return _B.ticks?_B.ticks(kB):_B.domain()}function WO(_B,kB,wB){var zB=_B.tickFormat?_B.tickFormat(kB,wB):String;return _B.type===t$?BO(zB,GO(wB)):zB}function BO(_B,kB){return function(wB){return _B(wB)?kB(wB):""}}function GO(_B){var kB=Q_.formatSpecifier(_B||",");if(null==kB.precision){switch(kB.precision=12,kB.type){case"%":kB.precision-=2;break;case"e":kB.precision-=1;}return VO(Q_.format(kB),Q_.format(".1f")(1)[1])}return Q_.format(kB)}function VO(_B,kB){return function(wB){var zB,EB,SB=_B(wB),CB=SB.indexOf(kB);if(0>CB)return SB;for(zB=HO(SB,CB),EB=zB<SB.length?SB.slice(zB):"";--zB>CB;)if("0"!==SB[zB]){++zB;break}return SB.slice(0,zB)+EB}}function HO(_B,kB){var wB,zB=_B.lastIndexOf("e");if(0<zB)return zB;for(zB=_B.length;--zB>kB;)if(48<=(wB=_B.charCodeAt(zB))&&57>=wB)return zB+1}function YO(_B){VS.call(this,null,_B)}function XO(_B){VS.call(this,null,_B)}function JO(){return oS({})}function QO(_B){return _B.exit}function KO(_B){VS.call(this,null,_B)}function ZO(_B,kB,wB){if(wB)return _B.domain();var zB=u$[_B.type];return zB?zB(_B):NO(_B,kB)}function nR(_B){var kB=_B.domain();return kB.max=kB.pop(),kB}function iR(_B,kB){return u$[_B.type]?rR(kB):oR(kB)}function rR(_B){return function(kB,wB,zB){var EB=zB[wB+1]||zB.max||1/0,SB=dR(kB,_B),CB=dR(EB,_B);return SB&&CB?SB+"\u2013"+CB:CB?"< "+CB:"\u2265 "+SB}}function dR(_B,kB){return isFinite(_B)?kB(_B):null}function oR(_B){return function(kB){return _B(kB)}}function sR(_B){VS.call(this,[],_B)}function lR(_B){return _B.source.x}function uR(_B){return _B.source.y}function pR(_B){return _B.target.x}function cR(_B){return _B.target.y}function mR(_B){VS.call(this,{},_B)}function fR(_B,kB,wB,zB){return"M"+_B+","+kB+"L"+wB+","+zB}function hR(_B,kB,wB,zB){var EB=wB-_B,SB=zB-kB,CB=Math.sqrt(EB*EB+SB*SB)/2;return"M"+_B+","+kB+"A"+CB+","+CB+" "+180*Math.atan2(SB,EB)/Math.PI+" 0 1 "+wB+","+zB}function vR(_B,kB,wB,zB){var EB=wB-_B,SB=zB-kB,CB=.2*(EB+SB),OB=.2*(SB-EB);return"M"+_B+","+kB+"C"+(_B+CB)+","+(kB+OB)+" "+(wB+OB)+","+(zB-CB)+" "+wB+","+zB}function SR(_B){VS.call(this,null,_B)}function CR(_B){VS.call(this,null,_B),this.modified(!0)}function OR(_B,kB,wB){var zB=RR(_B,kB.domainRaw);if(-1<zB)return zB;var EB,SB,CB=kB.domain,OB=kB.zero||void 0===kB.zero&&m$[_B.type];return CB?((OB||null!=kB.domainMin||null!=kB.domainMax||null!=kB.domainMid)&&(EB=(CB=CB.slice()).length-1||1,OB&&(0<CB[0]&&(CB[0]=0),0>CB[EB]&&(CB[EB]=0)),null!=kB.domainMin&&(CB[0]=kB.domainMin),null!=kB.domainMax&&(CB[EB]=kB.domainMax),null!=kB.domainMid&&(SB=kB.domainMid,(SB<CB[0]||SB>CB[EB])&&wB.warn("Scale domainMid exceeds domain min or max.",SB),CB.splice(EB,0,SB))),_B.domain(CB),kB.nice&&_B.nice&&_B.nice(!0!==kB.nice&&+kB.nice||null),CB.length):0}function RR(_B,kB){return kB?(_B.domain(kB),kB.length):-1}function DR(_B,kB,wB){var zB=kB.round||!1,EB=kB.range;if(null!=kB.rangeStep)EB=AR(_B.type,kB,wB);else if(kB.scheme){if(EB=PR(_B.type,kB,wB),Ck(EB))return _B.interpolator(EB);}else if(EB&&_B.type===l$)return _B.interpolator(X_.interpolateRgbBasis(MR(EB,kB.reverse)));EB&&kB.interpolate&&_B.interpolate?_B.interpolate(pO(kB.interpolate,kB.interpolateGamma)):Ck(_B.round)?_B.round(zB):Ck(_B.rangeRound)&&_B.interpolate(zB?X_.interpolateRound:X_.interpolate),EB&&_B.range(MR(EB,kB.reverse))}function AR(_B,kB,wB){_B!==a$&&_B!==n$&&yk("Only band and point scales support rangeStep.");var zB=(null==kB.paddingOuter?kB.padding:kB.paddingOuter)||0,EB=_B===n$?1:(null==kB.paddingInner?kB.padding:kB.paddingInner)||0;return[0,kB.rangeStep*XC(wB,EB,zB)]}function PR(_B,kB,wB){var zB,EB=kB.scheme.toLowerCase(),SB=oO(EB),CB=kB.schemeExtent;return SB||yk("Unrecognized scheme name: "+kB.scheme),wB=_B===o$?wB+1:_B===s$?wB-1:_B===r$||_B===d$?+kB.schemeCount||c$:wB,_B===l$?qR(SB,CB,kB.reverse):!CB&&(zB=oO(EB+"-"+wB))?zB:Ck(SB)?LR(qR(SB,CB),wB):_B===i$?SB:SB.slice(0,wB)}function qR(_B,kB,wB){return Ck(_B)&&(kB||wB)?sO(_B,MR(kB||[0,1],wB)):_B}function MR(_B,kB){return kB?_B.slice().reverse():_B}function LR(_B,kB){for(var wB=Array(kB),EB=0;EB<kB;++EB)wB[EB]=_B(EB/(kB-1||1));return wB}function TR(_B){VS.call(this,null,_B)}function FR(_B){VS.call(this,null,_B)}function IR(_B,kB,wB,zB,EB){for(var SB,CB=(kB-_B.sum)/2,OB=_B.length,RB=0;RB<OB;++RB)SB=_B[RB],SB[zB]=CB,SB[EB]=CB+=Math.abs(wB(SB))}function UR(_B,kB,wB,zB,EB){for(var SB,CB=1/_B.sum,OB=0,RB=_B.length,DB=0,AB=0;DB<RB;++DB)SB=_B[DB],SB[zB]=OB,SB[EB]=OB=CB*(AB+=Math.abs(wB(SB)))}function $R(_B,kB,wB,zB,EB){for(var SB,CB,OB=0,RB=0,DB=_B.length,AB=0;AB<DB;++AB)CB=_B[AB],SB=wB(CB),0>SB?(CB[zB]=RB,CB[EB]=RB+=SB):(CB[zB]=OB,CB[EB]=OB+=SB)}function jR(_B,kB,wB,zB){var EB,SB,CB,OB,RB,DB,AB,PB,qB,MB=[],LB=function(FB){return FB(RB)};if(null==kB)MB.push(_B.slice());else for(EB={},SB=0,CB=_B.length;SB<CB;++SB)RB=_B[SB],DB=kB.map(LB),AB=EB[DB]||(MB.push(EB[DB]=[]),EB[DB]),AB.push(RB);for(DB=0,qB=0,OB=MB.length;DB<OB;++DB){for(AB=MB[DB],SB=0,PB=0,CB=AB.length;SB<CB;++SB)PB+=Math.abs(zB(AB[SB]));AB.sum=PB,PB>qB&&(qB=PB),wB&&AB.sort(wB)}return MB.max=qB,MB}function NR(_B){VS.call(this,null,_B)}function WR(_B,kB){return function(){_B.touch(kB).run()}}function BR(_B,kB){var wB=K_.forceSimulation(_B),zB=!1,EB=wB.stop,SB=wB.restart;return wB.stopped=function(){return zB},wB.restart=function(){return zB=!1,SB()},wB.stop=function(){return zB=!0,EB()},GR(wB,kB,!0).on("end",function(){zB=!0})}function GR(_B,kB,wB){var zB,EB,SB,CB=Ek(kB.forces);for(zB=0,EB=b$.length;zB<EB;++zB)(SB=b$[zB])!==x$&&kB.modified(SB)&&_B[SB](kB[SB]);for(zB=0,EB=CB.length;zB<EB;++zB)(wB||kB.modified(x$,zB))&&_B.force(x$+zB,VR(CB[zB]));for(EB=_B.numForces||0;zB<EB;++zB)_B.force(x$+zB,null);return _B.numForces=CB.length,_B}function VR(_B){var kB,wB;for(wB in v$.hasOwnProperty(_B.force)||yk("Unrecognized force: "+_B.force),kB=v$[_B.force](),_B)Ck(kB[wB])&&kB[wB](_B[wB]);return kB}function HR(_B){VS.call(this,null,_B)}function YR(_B){return _B.values}function XR(_B){VS.call(this,null,_B)}function JR(_B){VS.call(this,{},_B)}function QR(_B){var kB;return _B.parent&&(kB=_B.parent.data)&&null!=rS(kB)&&kB}function eD(_B){VS.call(this,null,_B)}function tD(_B,kB,wB){for(var zB,EB=0,SB=kB.length;EB<SB;++EB)(zB=kB[EB])in wB&&_B[zB](wB[zB])}function aD(_B,kB,wB){for(var zB=_B.data,EB=0,SB=kB.length-1;EB<SB;++EB)zB[wB[EB]]=_B[kB[EB]];zB[wB[SB]]=_B.children?_B.children.length:0}function nD(_B){eD.call(this,_B)}function iD(_B){eD.call(this,_B)}function rD(_B){eD.call(this,_B)}function dD(_B){eD.call(this,_B)}function oD(_B){VS.call(this,null,_B)}function sD(){function _B(TB){TB.width=TB.height=1;var FB=Math.sqrt(TB.getContext("2d").getImageData(0,0,1,1).data.length>>2);TB.width=(L$<<5)/FB,TB.height=T$/FB;var IB=TB.getContext("2d");return IB.fillStyle=IB.strokeStyle="red",IB.textAlign="center",{context:IB,ratio:FB}}function kB(TB,FB,IB){for(var UB,$B,jB,NB=FB.x,WB=FB.y,BB=Math.sqrt(DB[0]*DB[0]+DB[1]*DB[1]),GB=AB(DB),VB=.5>qB()?1:-1,HB=-VB;(UB=GB(HB+=VB))&&($B=~~UB[0],jB=~~UB[1],!(Math.min(Math.abs($B),Math.abs(jB))>=BB));)if(FB.x=NB+$B,FB.y=WB+jB,!(0>FB.x+FB.x0||0>FB.y+FB.y0||FB.x+FB.x1>DB[0]||FB.y+FB.y1>DB[1])&&(!IB||!uD(FB,TB,DB[0]))&&(!IB||cD(FB,IB))){for(var YB,XB=FB.sprite,JB=FB.width>>5,QB=DB[0]>>5,KB=FB.x-(JB<<4),ZB=127&KB,tG=FB.y1-FB.y0,aG=(FB.y+FB.y0)*QB+(KB>>5),nG=0;nG<tG;nG++){YB=0;for(var iG=0;iG<=JB;iG++)TB[aG+iG]|=YB<<32-ZB|(iG<JB?(YB=XB[nG*JB+iG])>>>ZB:0);aG+=QB}return FB.sprite=null,!0}return!1}var wB,zB,EB,SB,CB,OB,RB,DB=[256,256],AB=mD,PB=[],qB=Math.random,MB={};return MB.layout=function(){for(var WB,TB=_B(hD()),FB=gD((DB[0]>>5)*DB[1]),IB=null,UB=PB.length,$B=-1,jB=[],NB=PB.map(function(BB){return{text:wB(BB),font:zB(BB),style:SB(BB),weight:CB(BB),rotate:OB(BB),size:~~EB(BB),padding:RB(BB),xoff:0,yoff:0,x1:0,y1:0,x0:0,y0:0,hasText:!1,sprite:null,datum:BB}}).sort(function(BB,GB){return GB.size-BB.size});++$B<UB;)WB=NB[$B],WB.x=DB[0]*(qB()+.5)>>1,WB.y=DB[1]*(qB()+.5)>>1,lD(TB,WB,NB,$B),WB.hasText&&kB(FB,WB,IB)&&(jB.push(WB),IB?pD(IB,WB):IB=[{x:WB.x+WB.x0,y:WB.y+WB.y0},{x:WB.x+WB.x1,y:WB.y+WB.y1}],WB.x-=DB[0]>>1,WB.y-=DB[1]>>1);return jB},MB.words=function(TB){return arguments.length?(PB=TB,MB):PB},MB.size=function(TB){return arguments.length?(DB=[+TB[0],+TB[1]],MB):DB},MB.font=function(TB){return arguments.length?(zB=yD(TB),MB):zB},MB.fontStyle=function(TB){return arguments.length?(SB=yD(TB),MB):SB},MB.fontWeight=function(TB){return arguments.length?(CB=yD(TB),MB):CB},MB.rotate=function(TB){return arguments.length?(OB=yD(TB),MB):OB},MB.text=function(TB){return arguments.length?(wB=yD(TB),MB):wB},MB.spiral=function(TB){return arguments.length?(AB=F$[TB]||TB,MB):AB},MB.fontSize=function(TB){return arguments.length?(EB=yD(TB),MB):EB},MB.padding=function(TB){return arguments.length?(RB=yD(TB),MB):RB},MB.random=function(TB){return arguments.length?(qB=TB,MB):qB},MB}function lD(_B,kB,wB,zB){if(!kB.sprite){var EB=_B.context,SB=_B.ratio;EB.clearRect(0,0,(L$<<5)/SB,T$/SB);var CB,OB,RB,DB,AB,PB=0,qB=0,MB=0,LB=wB.length;for(--zB;++zB<LB;){if(kB=wB[zB],EB.save(),EB.font=kB.style+" "+kB.weight+" "+~~((kB.size+1)/SB)+"px "+kB.font,CB=EB.measureText(kB.text+"m").width*SB,RB=kB.size<<1,kB.rotate){var TB=Math.sin(kB.rotate*M$),FB=Math.cos(kB.rotate*M$),IB=CB*FB,UB=CB*TB,$B=RB*FB,jB=RB*TB;CB=Math.max(Math.abs(IB+jB),Math.abs(IB-jB))+31>>5<<5,RB=~~Math.max(Math.abs(UB+$B),Math.abs(UB-$B))}else CB=CB+31>>5<<5;if(RB>MB&&(MB=RB),PB+CB>=L$<<5&&(PB=0,qB+=MB,MB=0),qB+RB>=T$)break;EB.translate((PB+(CB>>1))/SB,(qB+(RB>>1))/SB),kB.rotate&&EB.rotate(kB.rotate*M$),EB.fillText(kB.text,0,0),kB.padding&&(EB.lineWidth=2*kB.padding,EB.strokeText(kB.text,0,0)),EB.restore(),kB.width=CB,kB.height=RB,kB.xoff=PB,kB.yoff=qB,kB.x1=CB>>1,kB.y1=RB>>1,kB.x0=-kB.x1,kB.y0=-kB.y1,kB.hasText=!0,PB+=CB}for(var NB=EB.getImageData(0,0,(L$<<5)/SB,T$/SB).data,WB=[];0<=--zB;)if(kB=wB[zB],kB.hasText){for(CB=kB.width,OB=CB>>5,RB=kB.y1-kB.y0,DB=0;DB<RB*OB;DB++)WB[DB]=0;if(null==(PB=kB.xoff))return;qB=kB.yoff;var BB=0,GB=-1;for(AB=0;AB<RB;AB++){for(DB=0;DB<CB;DB++){var VB=OB*AB+(DB>>5),HB=NB[(qB+AB)*(L$<<5)+(PB+DB)<<2]?1<<31-DB%32:0;WB[VB]|=HB,BB|=HB}BB?GB=AB:(kB.y0++,RB--,AB--,qB++)}kB.y1=kB.y0+GB,kB.sprite=WB.slice(0,(kB.y1-kB.y0)*OB)}}}function uD(_B,kB,wB){wB>>=5;for(var zB,EB=_B.sprite,SB=_B.width>>5,CB=_B.x-(SB<<4),OB=127&CB,DB=_B.y1-_B.y0,AB=(_B.y+_B.y0)*wB+(CB>>5),PB=0;PB<DB;PB++){zB=0;for(var qB=0;qB<=SB;qB++)if((zB<<32-OB|(qB<SB?(zB=EB[PB*SB+qB])>>>OB:0))&kB[AB+qB])return!0;AB+=wB}return!1}function pD(_B,kB){var wB=_B[0],zB=_B[1];kB.x+kB.x0<wB.x&&(wB.x=kB.x+kB.x0),kB.y+kB.y0<wB.y&&(wB.y=kB.y+kB.y0),kB.x+kB.x1>zB.x&&(zB.x=kB.x+kB.x1),kB.y+kB.y1>zB.y&&(zB.y=kB.y+kB.y1)}function cD(_B,kB){return _B.x+_B.x1>kB[0].x&&_B.x+_B.x0<kB[1].x&&_B.y+_B.y1>kB[0].y&&_B.y+_B.y0<kB[1].y}function mD(_B){var kB=_B[0]/_B[1];return function(wB){return[kB*(wB*=.1)*Math.cos(wB),wB*Math.sin(wB)]}}function gD(_B){for(var kB=[],wB=-1;++wB<_B;)kB[wB]=0;return kB}function hD(){try{return"undefined"!=typeof document&&document.createElement?document.createElement("canvas"):new(require("canvas"))}catch(_B){yk("Canvas unavailable. Run in browser or install node-canvas.")}}function yD(_B){return"function"==typeof _B?_B:function(){return _B}}function vD(_B){VS.call(this,sD(),_B)}function xD(_B,kB){var wB=new eU.Extent;return wB.transform({field:_B,modified:iF},kB),wB.value}function bD(_B){return new Uint8Array(_B)}function _D(_B){return new Uint16Array(_B)}function kD(_B){return new Uint32Array(_B)}function wD(){var _B=8,kB=[],wB=kD(0),zB=ED(0,_B),EB=ED(0,_B);return{data:function(){return kB},seen:function(){return wB=zD(wB,kB.length)},add:function(CB){for(var OB,RB=0,DB=kB.length,AB=CB.length;RB<AB;++RB)OB=CB[RB],OB._index=DB++,kB.push(OB)},remove:function(CB,OB){var RB,DB,AB,PB=kB.length,qB=Array(PB-CB),MB=kB;for(DB=0;!OB[DB]&&DB<PB;++DB)qB[DB]=kB[DB],MB[DB]=DB;for(AB=DB;DB<PB;++DB)RB=kB[DB],OB[DB]?MB[DB]=-1:(MB[DB]=AB,zB[AB]=zB[DB],EB[AB]=EB[DB],qB[AB]=RB,RB._index=AB++),zB[DB]=0;return kB=qB,MB},size:function(){return kB.length},curr:function(){return zB},prev:function(){return EB},reset:function(CB){EB[CB]=zB[CB]},all:function(){return 257>_B?255:65537>_B?65535:4294967295},set:function(CB,OB){zB[CB]|=OB},clear:function(CB,OB){zB[CB]&=~OB},resize:function(CB,OB){(CB>zB.length||OB>_B)&&(_B=Math.max(OB,_B),zB=ED(CB,_B,zB),EB=ED(CB,_B))}}}function zD(_B,kB,wB){return _B.length>=kB?_B:(wB=wB||new _B.constructor(kB),wB.set(_B),wB)}function ED(_B,kB,wB){var zB=(257>kB?bD:65537>kB?_D:kD)(_B);return wB&&zB.set(wB),zB}function SD(_B,kB,wB){var zB=1<<kB;return{one:zB,zero:~zB,range:wB.slice(),bisect:_B.bisect,index:_B.index,size:_B.size,onAdd:function(SB,CB){var OB,RB=this,DB=RB.bisect(RB.range,SB.value),AB=SB.index,PB=DB[0],qB=DB[1],MB=AB.length;for(OB=0;OB<PB;++OB)CB[AB[OB]]|=zB;for(OB=qB;OB<MB;++OB)CB[AB[OB]]|=zB;return RB}}}function CD(){var EB=kD(0),SB=[],CB=0;return{insert:function(OB,RB,DB){if(!RB.length)return[];var AB,PB,qB,MB=CB,LB=RB.length,TB=Array(LB),FB=kD(LB);for(qB=0;qB<LB;++qB)TB[qB]=OB(RB[qB]),FB[qB]=qB;if(TB=OD(TB,FB),MB)AB=SB,PB=EB,SB=Array(MB+LB),EB=kD(MB+LB),RD(DB,AB,PB,MB,TB,FB,LB,SB,EB);else{if(0<DB)for(qB=0;qB<LB;++qB)FB[qB]+=DB;SB=TB,EB=FB}return CB=MB+LB,{index:FB,value:TB}},remove:function(OB,RB){var DB,AB,PB,qB=CB;for(AB=0;!RB[EB[AB]]&&AB<qB;++AB);for(PB=AB;AB<qB;++AB)RB[DB=EB[AB]]||(EB[PB]=DB,SB[PB]=SB[AB],++PB);CB=qB-OB},bisect:function(OB,RB){var DB=RB?RB.length:(RB=SB,CB);return[U_.bisectLeft(RB,OB[0],0,DB),U_.bisectRight(RB,OB[1],0,DB)]},reindex:function(OB){for(var RB=0,DB=CB;RB<DB;++RB)EB[RB]=OB[EB[RB]]},index:function(){return EB},size:function(){return CB}}}function OD(_B,kB){return _B.sort.call(kB,function(wB,zB){var EB=_B[wB],SB=_B[zB];return EB<SB?-1:EB>SB?1:0}),U_.permute(_B,kB)}function RD(_B,kB,wB,zB,EB,SB,CB,OB,RB){var DB,AB=0,PB=0;for(DB=0;AB<zB&&PB<CB;++DB)kB[AB]<EB[PB]?(OB[DB]=kB[AB],RB[DB]=wB[AB++]):(OB[DB]=EB[PB],RB[DB]=SB[PB++]+_B);for(;AB<zB;++AB,++DB)OB[DB]=kB[AB],RB[DB]=wB[AB];for(;PB<CB;++PB,++DB)OB[DB]=EB[PB],RB[DB]=SB[PB]+_B}function DD(_B){VS.call(this,wD(),_B),this._indices=null,this._dims=null}function AD(_B){VS.call(this,null,_B)}function PD(_B){VS.call(this,null,_B)}function qD(_B,kB,wB){return _B.bounds_prev.clear().union(_B.bounds),kB(_B.bounds.clear(),_B,wB)}function MD(_B){VS.call(this,null,_B)}function LD(_B){var kB=_B.groups,wB=_B.parent;return kB&&1===kB.size?kB.get(Object.keys(kB.object)[0]):kB&&wB?kB.lookup(wB):null}function TD(_B){VS.call(this,null,_B)}function FD(_B){for(var kB,wB,zB=_B.items,EB=zB.length,SB=0,CB={marks:[],rowheaders:[],rowfooters:[],colheaders:[],colfooters:[],rowtitle:null,coltitle:null};SB<EB;++SB)if(kB=zB[SB],wB=kB.items,"group"===kB.marktype)switch(kB.role){case G$:case V$:break;case H$:ID(wB,CB.rowheaders);break;case Y$:ID(wB,CB.rowfooters);break;case J$:ID(wB,CB.colheaders);break;case Q$:ID(wB,CB.colfooters);break;case X$:CB.rowtitle=wB[0];break;case K$:CB.coltitle=wB[0];break;default:ID(wB,CB.marks);}return CB}function ID(_B,kB){for(var wB=0,zB=_B.length;wB<zB;++wB)kB.push(_B[wB])}function UD(_B){return{x1:0,y1:0,x2:_B.width||0,y2:_B.height||0}}function $D(_B){return _B.bounds.clone().translate(-(_B.x||0),-(_B.y||0))}function jD(_B,kB){return{x1:_B.x,y1:_B.y,x2:_B.x+_B.width,y2:_B.y+_B.height}[kB]}function ND(_B,kB){return _B.bounds[kB]}function WD(_B,kB,wB){return(xk(_B)?_B[kB]:_B)||wB||0}function BD(_B,kB,wB){function zB(ZB,eG){return Math.floor(Math.min(ZB,eG))}function EB(ZB,eG){return Math.ceil(Math.max(ZB,eG))}var SB,CB,OB,RB,DB,AB,PB,qB,MB,LB,TB,FB=FD(kB,wB),IB=FB.marks,UB="flush"===wB.bounds,$B=UB?UD:$D,jB=new xw(0,0,0,0),NB=WD(wB.align,"column"),WB=WD(wB.align,"row"),BB=WD(wB.padding,"column"),GB=WD(wB.padding,"row"),VB=wB.offset,HB=wB.columns||IB.length,YB=0>HB?1:Math.ceil(IB.length/HB),JB=[],QB=[],KB=IB.length;for(CB=0;CB<KB;++CB)RB=$B(IB[CB]),AB=0==CB%HB?0:Math.ceil($B(IB[CB-1]).x2),PB=CB<HB?0:Math.ceil($B(IB[CB-HB]).y2),qB=(0>RB.x1?Math.ceil(-RB.x1):0)+AB,MB=(0>RB.y1?Math.ceil(-RB.y1):0)+PB,JB.push(qB+BB),QB.push(MB+GB);for(CB=0;CB<KB;++CB)0==CB%HB&&(JB[CB]=0),CB<HB&&(QB[CB]=0);if("each"===NB)for(OB=1;OB<HB;++OB){for(TB=0,CB=OB;CB<KB;CB+=HB)TB<JB[CB]&&(TB=JB[CB]);for(CB=OB;CB<KB;CB+=HB)JB[CB]=TB}else if("all"===NB){for(TB=0,CB=0;CB<KB;++CB)CB%HB&&TB<JB[CB]&&(TB=JB[CB]);for(CB=0;CB<KB;++CB)CB%HB&&(JB[CB]=TB)}if("each"===WB)for(OB=1;OB<YB;++OB){for(TB=0,CB=OB*HB,SB=CB+HB;CB<SB;++CB)TB<QB[CB]&&(TB=QB[CB]);for(CB=OB*HB;CB<SB;++CB)QB[CB]=TB}else if("all"===WB){for(TB=0,CB=HB;CB<KB;++CB)TB<QB[CB]&&(TB=QB[CB]);for(CB=HB;CB<KB;++CB)QB[CB]=TB}for(qB=0,CB=0;CB<KB;++CB)DB=IB[CB],AB=DB.x||0,DB.x=qB=JB[CB]+(CB%HB?qB:0),DB.bounds.translate(qB-AB,0);for(OB=0;OB<HB;++OB)for(MB=0,CB=OB;CB<KB;CB+=HB)DB=IB[CB],PB=DB.y||0,DB.y=MB+=QB[CB],DB.bounds.translate(0,MB-PB);for(_B.enqueue(IB),CB=0;CB<KB;++CB)IB[CB].mark.bounds.clear();for(CB=0;CB<KB;++CB)DB=IB[CB],jB.union(DB.mark.bounds.union(DB.bounds));$B=UB?jD:ND,qB=GD(_B,FB.rowheaders,IB,HB,YB,-WD(VB,"rowHeader"),zB,0,$B,"x1",0,HB,1),MB=GD(_B,FB.colheaders,IB,HB,HB,-WD(VB,"columnHeader"),zB,1,$B,"y1",0,1,HB),GD(_B,FB.rowfooters,IB,HB,YB,WD(VB,"rowFooter"),EB,0,$B,"x2",HB-1,HB,1),GD(_B,FB.colfooters,IB,HB,HB,WD(VB,"columnFooter"),EB,1,$B,"y2",YB*HB-HB,1,HB),FB.rowtitle&&(TB=qB-WD(VB,"rowTitle"),LB=WD(wB.titleBand,"row",.5),VD(_B,FB.rowtitle,TB,0,jB,LB)),FB.coltitle&&(TB=MB-WD(VB,"columnTitle"),LB=WD(wB.titleBand,"column",.5),VD(_B,FB.coltitle,TB,1,jB,LB))}function GD(_B,kB,wB,zB,EB,SB,CB,OB,RB,DB,AB,PB,qB){var MB,LB,TB,FB,IB,UB,$B,jB,NB,WB=wB.length,BB=0,GB=0;for(MB=AB;MB<WB;MB+=PB)wB[MB]&&(BB=CB(BB,RB(wB[MB],DB)));if(!kB.length)return BB;for(kB.length>EB&&(_B.warn("Grid headers exceed limit: "+EB),kB=kB.slice(0,EB)),BB+=SB,LB=0,FB=kB.length;LB<FB;++LB)kB[LB].mark.bounds.clear();for(MB=AB,LB=0,FB=kB.length;LB<FB;++LB,MB+=PB){for(UB=kB[LB],IB=UB.mark.bounds,TB=MB;null==($B=wB[TB]);TB-=qB);OB?(jB=$B.x,NB=BB):(jB=BB,NB=$B.y),IB.union(UB.bounds.translate(jB-(UB.x||0),NB-(UB.y||0))),UB.x=jB,UB.y=NB,GB=CB(GB,IB[DB])}return _B.enqueue(kB),GB}function VD(_B,kB,wB,zB,EB,SB){if(kB){var CB=wB,OB=wB;zB?CB=Math.round(EB.x1+SB*EB.width()):OB=Math.round(EB.y1+SB*EB.height()),kB.bounds.translate(CB-(kB.x||0),OB-(kB.y||0)),kB.mark.bounds.clear().union(kB.bounds),kB.x=CB,kB.y=OB,_B.enqueue(kB.mark.items)}}function HD(_B){VS.call(this,null,_B)}function YD(_B,kB,wB){var zB,EB,SB,CB,OB,RB,DB=kB.items,AB=Math.max(0,kB.width||0),PB=Math.max(0,kB.height||0),qB=new xw().set(0,0,AB,PB),MB=qB.clone(),LB=qB.clone(),TB=[];for(OB=0,RB=DB.length;OB<RB;++OB)switch(EB=DB[OB],EB.role){case aj:MB.union(CB=KD(_B,EB,AB,PB)),JD(EB)&&LB.union(CB);break;case nj:zB=EB;break;case rj:TB.push(EB);break;case ij:case dj:case oj:case sj:case lj:case uj:LB.union(EB.bounds);break;default:qB.union(EB.bounds);}if(zB&&(MB.union(CB=ZD(_B,zB,MB)),JD(zB)&&LB.union(CB)),TB.length)for(SB={left:0,right:0,margin:wB.legendMargin||8},OB=0,RB=TB.length;OB<RB;++OB)CB=eA(_B,TB[OB],SB,LB,AB,PB),wB.autosize&&wB.autosize.type===Z$?qB.add(CB.x1,0).add(CB.x2,0):qB.union(CB);tA(_B,kB,qB.union(LB).union(MB),wB)}function XD(_B,kB,wB){return _B[kB]===wB?0:(_B[kB]=wB,1)}function JD(_B){var kB=_B.items[0].datum.orient;return"left"===kB||"right"===kB}function QD(_B){var kB=+_B.grid;return[_B.ticks?kB++:-1,_B.labels?kB++:-1,kB+ +_B.domain]}function KD(_B,kB,wB,zB){var EB,SB,CB=kB.items[0],OB=CB.datum,RB=OB.orient,DB=QD(OB),AB=CB.range,PB=CB.offset,qB=CB.position,MB=CB.minExtent,LB=CB.maxExtent,TB=OB.title&&CB.items[DB[2]].items[0],FB=CB.titlePadding,IB=TB?TB.fontSize+FB:0,UB=CB.bounds,$B=0,jB=0;switch(UB.clear(),-1<(EB=DB[0])&&UB.union(CB.items[EB].bounds),-1<(EB=DB[1])&&UB.union(CB.items[EB].bounds),RB){case"top":$B=qB||0,jB=-PB,SB=Math.max(MB,Math.min(LB,-UB.y1)),TB&&(TB.auto?(TB.y=-(FB+SB),SB+=IB):UB.union(TB.bounds)),UB.add(0,-SB).add(AB,0);break;case"left":$B=-PB,jB=qB||0,SB=Math.max(MB,Math.min(LB,-UB.x1)),TB&&(TB.auto?(TB.x=-(FB+SB),SB+=IB):UB.union(TB.bounds)),UB.add(-SB,0).add(0,AB);break;case"right":$B=wB+PB,jB=qB||0,SB=Math.max(MB,Math.min(LB,UB.x2)),TB&&(TB.auto?(TB.x=FB+SB,SB+=IB):UB.union(TB.bounds)),UB.add(0,0).add(SB,AB);break;case"bottom":$B=qB||0,jB=zB+PB,SB=Math.max(MB,Math.min(LB,UB.y2)),TB&&(TB.auto?(TB.y=FB+SB,SB+=IB):UB.union(TB.bounds)),UB.add(0,0).add(AB,SB);break;default:$B=CB.x,jB=CB.y;}return XD(CB,"x",$B+.5)|XD(CB,"y",jB+.5)&&_B.enqueue([CB]),mz(UB.translate($B,jB),CB),CB.mark.bounds.clear().union(UB)}function ZD(_B,kB,wB){var zB=kB.items[0],EB=zB.datum,SB=EB.orient,CB=zB.offset,OB=zB.bounds,RB=0,DB=0;return"top"===SB?(RB=zB.x,DB=wB.y1-CB):"left"===SB?(RB=wB.x1-CB,DB=zB.y):"right"===SB?(RB=wB.x2+CB,DB=zB.y):"bottom"===SB?(RB=zB.x,DB=wB.y2+CB):(RB=zB.x,DB=zB.y),OB.translate(RB-zB.x,DB-zB.y),XD(zB,"x",RB)|XD(zB,"y",DB)&&_B.enqueue([zB]),kB.bounds.clear().union(OB)}function eA(_B,kB,wB,zB,EB,SB){var CB,OB,RB=kB.items[0],DB=RB.datum,AB=DB.orient,PB=RB.offset,qB=RB.bounds.clear(),MB=0,LB=wB[AB]||0;switch(RB.items.forEach(function(TB){qB.union(TB.bounds)}),CB=Math.round(qB.width())+2*RB.padding-1,OB=Math.round(qB.height())+2*RB.padding-1,AB){case"left":MB-=CB+PB-Math.floor(zB.x1),wB.left+=OB+wB.margin;break;case"right":MB+=PB+Math.ceil(zB.x2),wB.right+=OB+wB.margin;break;case"top-left":MB+=PB,LB+=PB;break;case"top-right":MB+=EB-CB-PB,LB+=PB;break;case"bottom-left":MB+=PB,LB+=SB-OB-PB;break;case"bottom-right":MB+=EB-CB-PB,LB+=SB-OB-PB;break;default:MB=RB.x,LB=RB.y;}return XD(RB,"x",MB)|XD(RB,"width",CB)|XD(RB,"y",LB)|XD(RB,"height",OB)&&_B.enqueue([RB]),mz(qB.set(MB,LB,MB+CB,LB+OB),RB),RB.mark.bounds.clear().union(qB)}function tA(_B,kB,wB,zB){var EB=zB.autosize&&zB.autosize.type,SB=zB.autosize&&zB.autosize.resize,CB=_B._width,OB=_B._height;if(!(1>_B._autosize)&&EB){var RB=Math.max(0,kB.width||0),DB=Math.max(0,Math.ceil(-wB.x1)),AB=Math.max(0,Math.ceil(wB.x2-RB)),PB=Math.max(0,kB.height||0),qB=Math.max(0,Math.ceil(-wB.y1)),MB=Math.max(0,Math.ceil(wB.y2-PB));EB===tj?(CB=RB,OB=PB,DB=0,qB=0):EB===Z$?(RB=Math.max(0,CB-DB-AB),PB=Math.max(0,OB-qB-MB)):EB===ej&&(CB=RB+DB+AB,OB=PB+qB+MB),_B.autosize(CB,OB,RB,PB,[DB,qB],SB)}}function aA(_B){var kB=_B._signals.cursor;kB||(_B._signals.cursor=kB=_B.add({user:pj,item:null})),_B.on(_B.events("view","mousemove"),kB,function(wB,zB){var EB=kB.value,SB=EB?bk(EB)?EB:EB.user:pj,CB=zB.item&&zB.item.cursor||null;return EB&&SB===EB.user&&CB==EB.item?EB:{user:SB,item:CB}}),_B.add(null,function(wB){var zB=wB.cursor,EB=this.value;return bk(zB)||(EB=zB.item,zB=zB.user),nA(zB&&zB!==pj?zB:EB||zB),EB},{cursor:kB})}function nA(_B){"undefined"!=typeof document&&document.body&&(document.body.style.cursor=_B)}function iA(_B,kB){var wB=_B._runtime.data;return wB.hasOwnProperty(kB)||_B.error("Unrecognized data set: "+kB),wB[kB]}function dA(_B,kB){pS(kB)||this.error("Second argument to changes must be a changeset.");var wB=iA(this,_B);return wB.modified=!0,this.pulse(wB.input,kB)}function lA(_B){var kB=_B.padding();return Math.max(0,_B._width+kB.left+kB.right)}function uA(_B){var kB=_B.padding();return Math.max(0,_B._height+kB.top+kB.bottom)}function pA(_B){var kB=_B.padding(),wB=_B._origin;return[kB.left+wB[0],kB.top+wB[1]]}function cA(_B){var kB=pA(_B);_B._renderer.background(_B._background),_B._renderer.resize(lA(_B),uA(_B),kB),_B._handler.origin(kB)}function mA(_B,kB,wB){var zB,EB,SB,CB=_B._renderer.element();return CB&&(SB=pA(_B),EB=kB.changedTouches?kB.changedTouches[0]:kB,zB=RE(EB,CB),zB[0]-=SB[0],zB[1]-=SB[1]),kB.vega=fA(_B,wB,zB),kB.item=wB,kB}function fA(_B,kB,wB){function zB(CB){var OB,RB=SB;if(CB)for(OB=kB;OB;OB=OB.mark.group)if(OB.mark.name===CB){RB=OB;break}return RB&&RB.mark&&RB.mark.interactive?RB:{}}function EB(CB){if(!CB)return wB;bk(CB)&&(CB=zB(CB));for(var OB=wB.slice();CB;)OB[0]-=CB.x||0,OB[1]-=CB.y||0,CB=CB.mark&&CB.mark.group;return OB}var SB=kB?"group"===kB.mark.marktype?kB:kB.mark.group:null;return{view:Ok(_B),item:Ok(kB||{}),group:zB,xy:EB,x:function(OB){return EB(OB)[0]},y:function(OB){return EB(OB)[1]}}}function hA(_B){return _B.item}function yA(_B){var kB=_B.item.mark.source;return kB.source||kB}function vA(_B){return function(kB,wB){return wB.vega.view().changeset().encode(wB.item,_B)}}function _A(_B,kB,wB){var zB=document.createElement(_B);for(var EB in kB)zB.setAttribute(EB,kB[EB]);return null!=wB&&(zB.textContent=wB),zB}function kA(_B,kB,wB){var zB=wB.param,EB=wB.state||(wB.state={elements:null,set:null,update:function(CB){EB.source=!0,_B.signal(zB.signal,CB).run()},active:!1});return bk(kB)&&(kB=document.querySelector(kB)),wA(EB,kB,zB,_B.signal(zB.signal)),EB.active||(_B.on(_B._signals[zB.signal],null,function(){EB.source?EB.source=!1:EB.set(_B.signal(zB.signal))}),EB.active=!0),EB}function wA(_B,kB,wB,zB){var EB=_A("div",{class:fj});EB.appendChild(_A("span",{class:gj},wB.name||wB.signal)),kB.appendChild(EB);var SB=zA;switch(wB.input){case"checkbox":SB=EA;break;case"select":SB=SA;break;case"radio":SB=CA;break;case"range":SB=OA;}SB(_B,EB,wB,zB)}function zA(_B,kB,wB,zB){var EB=_A("input");for(var SB in wB)"signal"!==SB&&"element"!==SB&&EB.setAttribute("input"===SB?"type":SB,wB[SB]);EB.setAttribute("name",wB.signal),EB.value=zB,kB.appendChild(EB),EB.addEventListener("input",function(){_B.update(EB.value)}),_B.elements=[EB],_B.set=function(CB){EB.value=CB}}function EA(_B,kB,wB,zB){var EB={type:"checkbox",name:wB.signal};zB&&(EB.checked=!0);var SB=_A("input",EB);kB.appendChild(SB),SB.addEventListener("change",function(){_B.update(SB.checked)}),_B.elements=[SB],_B.set=function(CB){SB.checked=!!CB||null}}function SA(_B,kB,wB,zB){var EB=_A("select",{name:wB.signal});wB.options.forEach(function(SB){var CB={value:SB};RA(SB,zB)&&(CB.selected=!0),EB.appendChild(_A("option",CB,SB+""))}),kB.appendChild(EB),EB.addEventListener("change",function(){_B.update(wB.options[EB.selectedIndex])}),_B.elements=[EB],_B.set=function(SB){for(var CB=0,OB=wB.options.length;CB<OB;++CB)if(RA(wB.options[CB],SB))return void(EB.selectedIndex=CB)}}function CA(_B,kB,wB,zB){var EB=_A("span",{class:hj});kB.appendChild(EB),_B.elements=wB.options.map(function(SB){var CB=yj+wB.signal+"-"+SB,OB={id:CB,type:"radio",name:wB.signal,value:SB};RA(SB,zB)&&(OB.checked=!0);var RB=_A("input",OB);return RB.addEventListener("change",function(){_B.update(SB)}),EB.appendChild(RB),EB.appendChild(_A("label",{for:CB},SB+"")),RB}),_B.set=function(SB){for(var CB=_B.elements,OB=0,RB=CB.length;OB<RB;++OB)RA(CB[OB].value,SB)&&(CB[OB].checked=!0)}}function OA(_B,kB,wB,zB){function EB(){DB.textContent=RB.value,_B.update(+RB.value)}zB=void 0===zB?(+wB.max+ +wB.min)/2:zB;var SB=wB.min||Math.min(0,+zB)||0,CB=wB.max||Math.max(100,+zB)||100,OB=wB.step||U_.tickStep(SB,CB,100),RB=_A("input",{type:"range",name:wB.signal,min:SB,max:CB,step:OB});RB.value=zB;var DB=_A("label",{},+zB);kB.appendChild(RB),kB.appendChild(DB),RB.addEventListener("input",EB),RB.addEventListener("change",EB),_B.elements=[RB],_B.set=function(AB){RB.value=AB,DB.textContent=AB}}function RA(_B,kB){return _B===kB||_B+""==kB+""}function DA(_B,kB,wB,zB){return kB=kB||new zB(_B.loader()),kB.initialize(wB,lA(_B),uA(_B),pA(_B)).background(_B._background)}function AA(_B,kB,wB,zB){var EB=new zB().scene(_B.scenegraph().root).initialize(wB,pA(_B),_B);return kB&&(EB.handleTooltip=kB.handleTooltip,kB.handlers().forEach(function(SB){EB.on(SB.type,SB.handler)})),EB}function qA(_B,kB){return"string"==typeof kB&&(kB="undefined"==typeof document?_B.error("DOM document instance not found."):document.querySelector(kB)),kB.innerHTML="",kB}function MA(_B,kB){var wB=eS(kB);return wB&&wB.headless?_B.runAsync().then(function(){return DA(_B,null,null,wB.headless).renderAsync(_B._scenegraph.root)}):Promise.reject("Unrecognized renderer type: "+kB)}function TA(_B,kB){var wB=new Blob([_B],{type:kB});return window.URL.createObjectURL(wB)}function UA(_B,kB){return _B=_B||kB.autosize,xk(_B)?_B:(_B=_B||"pad",{type:_B})}function $A(_B,kB){return _B=_B||kB.padding,xk(_B)?_B:(_B=+_B||0,{top:_B,bottom:_B,left:_B,right:_B})}function jA(_B,kB){yk(_B+" for \"outer\" push: "+_k(kB))}function NA(_B,kB){var wB=_B.name;if(_B.push===vj)kB.signals[wB]||jA("No prior signal definition",wB),xj.forEach(function(EB){void 0!==_B[EB]&&jA("Invalid property ",EB)});else{var zB=kB.addSignal(wB,_B.value);!1===_B.react&&(zB.react=!1),_B.bind&&kB.addBinding(wB,_B.bind)}}function WA(_B){this.type=_B}function BA(_B){switch(_B.type){case"ArrayExpression":return _B.elements;case"BinaryExpression":case"LogicalExpression":return[_B.left,_B.right];case"CallExpression":var kB=_B.arguments.slice();return kB.unshift(_B.callee),kB;case"ConditionalExpression":return[_B.test,_B.consequent,_B.alternate];case"MemberExpression":return[_B.object,_B.property];case"ObjectExpression":return _B.properties;case"Property":return[_B.key,_B.value];case"UnaryExpression":return[_B.argument];case"Identifier":case"Literal":case"RawCode":default:return[];}}function GA(_B,kB){if(!_B)throw new Error("ASSERT: "+kB)}function VA(_B){return 48<=_B&&57>=_B}function HA(_B){return 0<="0123456789abcdefABCDEF".indexOf(_B)}function YA(_B){return 0<="01234567".indexOf(_B)}function XA(_B){return 32===_B||9===_B||11===_B||12===_B||160===_B||5760<=_B&&0<=[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279].indexOf(_B)}function JA(_B){return 10===_B||13===_B||8232===_B||8233===_B}function QA(_B){return 36===_B||95===_B||65<=_B&&90>=_B||97<=_B&&122>=_B||92===_B||128<=_B&&tN.test(String.fromCharCode(_B))}function KA(_B){return 36===_B||95===_B||65<=_B&&90>=_B||97<=_B&&122>=_B||48<=_B&&57>=_B||92===_B||128<=_B&&aN.test(String.fromCharCode(_B))}function ZA(){for(var _B;_j<kj&&(_B=bj.charCodeAt(_j),XA(_B)||JA(_B));)++_j}function eP(_B){var kB,wB,zB,EB=0;for(wB="u"===_B?4:2,kB=0;kB<wB;++kB)_j<kj&&HA(bj[_j])?(zB=bj[_j++],EB=16*EB+"0123456789abcdef".indexOf(zB.toLowerCase())):OP({},Wj,Zj);return String.fromCharCode(EB)}function tP(){var _B,kB,wB,zB;for(_B=bj[_j],kB=0,"}"===_B&&OP({},Wj,Zj);_j<kj&&(_B=bj[_j++],HA(_B));)kB=16*kB+"0123456789abcdef".indexOf(_B.toLowerCase());return(1114111<kB||"}"!==_B)&&OP({},Wj,Zj),65535>=kB?String.fromCharCode(kB):(wB=55296+(kB-65536>>10),zB=56320+(1023&kB-65536),String.fromCharCode(wB,zB))}function aP(){var _B,kB;for(_B=bj.charCodeAt(_j++),kB=String.fromCharCode(_B),92===_B&&(117!==bj.charCodeAt(_j)&&OP({},Wj,Zj),++_j,_B=eP("u"),_B&&"\\"!==_B&&QA(_B.charCodeAt(0))||OP({},Wj,Zj),kB=_B);_j<kj&&(_B=bj.charCodeAt(_j),KA(_B));)++_j,kB+=String.fromCharCode(_B),92===_B&&(kB=kB.substr(0,kB.length-1),117!==bj.charCodeAt(_j)&&OP({},Wj,Zj),++_j,_B=eP("u"),_B&&"\\"!==_B&&KA(_B.charCodeAt(0))||OP({},Wj,Zj),kB+=_B);return kB}function nP(){var _B,kB;for(_B=_j++;_j<kj;){if(92===(kB=bj.charCodeAt(_j)))return _j=_B,aP();if(!KA(kB))break;++_j}return bj.slice(_B,_j)}function iP(){var _B,kB,wB;return _B=_j,kB=92===bj.charCodeAt(_j)?aP():nP(),wB=1===kB.length?Sj:nN.hasOwnProperty(kB)?Cj:"null"===kB?Oj:"true"===kB||"false"===kB?zj:Sj,{type:wB,value:kB,start:_B,end:_j}}function rP(){var _B,kB,wB,zB,EB=_j,SB=bj.charCodeAt(_j),CB=bj[_j];switch(SB){case 46:case 40:case 41:case 59:case 44:case 123:case 125:case 91:case 93:case 58:case 63:case 126:return++_j,{type:Dj,value:String.fromCharCode(SB),start:EB,end:_j};default:if(61===(_B=bj.charCodeAt(_j+1)))switch(SB){case 43:case 45:case 47:case 60:case 62:case 94:case 124:case 37:case 38:case 42:return _j+=2,{type:Dj,value:String.fromCharCode(SB)+String.fromCharCode(_B),start:EB,end:_j};case 33:case 61:return _j+=2,61===bj.charCodeAt(_j)&&++_j,{type:Dj,value:bj.slice(EB,_j),start:EB,end:_j};}}return">>>="===(zB=bj.substr(_j,4))?(_j+=4,{type:Dj,value:zB,start:EB,end:_j}):">>>"===(wB=zB.substr(0,3))||"<<="===wB||">>="===wB?(_j+=3,{type:Dj,value:wB,start:EB,end:_j}):(kB=wB.substr(0,2),CB===kB[1]&&0<="+-<>&|".indexOf(CB)||"=>"===kB?(_j+=2,{type:Dj,value:kB,start:EB,end:_j}):0<="<>=!+-*%&|^/".indexOf(CB)?(++_j,{type:Dj,value:CB,start:EB,end:_j}):void OP({},Wj,Zj))}function dP(_B){for(var kB="";_j<kj&&HA(bj[_j]);)kB+=bj[_j++];return 0===kB.length&&OP({},Wj,Zj),QA(bj.charCodeAt(_j))&&OP({},Wj,Zj),{type:Rj,value:parseInt("0x"+kB,16),start:_B,end:_j}}function oP(_B){for(var kB="0"+bj[_j++];_j<kj&&YA(bj[_j]);)kB+=bj[_j++];return(QA(bj.charCodeAt(_j))||VA(bj.charCodeAt(_j)))&&OP({},Wj,Zj),{type:Rj,value:parseInt(kB,8),octal:!0,start:_B,end:_j}}function sP(){var _B,kB,wB;if(wB=bj[_j],GA(VA(wB.charCodeAt(0))||"."===wB,"Numeric literal must start with a decimal digit or a decimal point"),kB=_j,_B="","."!==wB){if(_B=bj[_j++],wB=bj[_j],"0"===_B){if("x"===wB||"X"===wB)return++_j,dP(kB);if(YA(wB))return oP(kB);wB&&VA(wB.charCodeAt(0))&&OP({},Wj,Zj)}for(;VA(bj.charCodeAt(_j));)_B+=bj[_j++];wB=bj[_j]}if("."===wB){for(_B+=bj[_j++];VA(bj.charCodeAt(_j));)_B+=bj[_j++];wB=bj[_j]}if("e"===wB||"E"===wB)if(_B+=bj[_j++],wB=bj[_j],"+"!==wB&&"-"!==wB||(_B+=bj[_j++]),VA(bj.charCodeAt(_j)))for(;VA(bj.charCodeAt(_j));)_B+=bj[_j++];else OP({},Wj,Zj);return QA(bj.charCodeAt(_j))&&OP({},Wj,Zj),{type:Rj,value:parseFloat(_B),start:kB,end:_j}}function lP(){var _B,kB,wB,zB,EB="",SB=!1;for(_B=bj[_j],GA("'"===_B||"\""===_B,"String literal must starts with a quote"),kB=_j,++_j;_j<kj;){if((wB=bj[_j++])===_B){_B="";break}if("\\"===wB)(wB=bj[_j++])&&JA(wB.charCodeAt(0))?"\r"===wB&&"\n"===bj[_j]&&++_j:"u"===wB||"x"===wB?"{"===bj[_j]?(++_j,EB+=tP()):EB+=eP(wB):"n"===wB?EB+="\n":"r"===wB?EB+="\r":"t"===wB?EB+="\t":"b"===wB?EB+="\b":"f"===wB?EB+="\f":"v"===wB?EB+="\x0B":YA(wB)?(zB="01234567".indexOf(wB),0!==zB&&(SB=!0),_j<kj&&YA(bj[_j])&&(SB=!0,zB=8*zB+"01234567".indexOf(bj[_j++]),0<="0123".indexOf(wB)&&_j<kj&&YA(bj[_j])&&(zB=8*zB+"01234567".indexOf(bj[_j++]))),EB+=String.fromCharCode(zB)):EB+=wB;else{if(JA(wB.charCodeAt(0)))break;EB+=wB}}return""!==_B&&OP({},Wj,Zj),{type:Aj,value:EB,octal:SB,start:kB,end:_j}}function uP(_B,kB){var wB=_B;0<=kB.indexOf("u")&&(wB=wB.replace(/\\u\{([0-9a-fA-F]+)\}/g,function(zB,EB){return 1114111>=parseInt(EB,16)?"x":void OP({},Xj)}).replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,"x"));try{new RegExp(wB)}catch(zB){OP({},Xj)}try{return new RegExp(_B,kB)}catch(zB){return null}}function pP(){var _B,kB,wB,zB,EB;for(_B=bj[_j],GA("/"===_B,"Regular expression literal must start with a slash"),kB=bj[_j++],wB=!1,zB=!1;_j<kj;)if(_B=bj[_j++],kB+=_B,"\\"===_B)_B=bj[_j++],JA(_B.charCodeAt(0))&&OP({},Jj),kB+=_B;else if(JA(_B.charCodeAt(0)))OP({},Jj);else if(wB)"]"===_B&&(wB=!1);else{if("/"===_B){zB=!0;break}"["===_B&&(wB=!0)}return zB||OP({},Jj),EB=kB.substr(1,kB.length-2),{value:EB,literal:kB}}function cP(){var _B,kB,wB;for(kB="",wB="";_j<kj&&(_B=bj[_j],KA(_B.charCodeAt(0)));)++_j,"\\"===_B&&_j<kj?OP({},Wj,Zj):(wB+=_B,kB+=_B);return 0<=wB.search(/[^gimuy]/g)&&OP({},Xj,wB),{value:wB,literal:kB}}function mP(){var _B,kB,wB,zB;return wj=null,ZA(),_B=_j,kB=pP(),wB=cP(),zB=uP(kB.value,wB.value),{literal:kB.literal+wB.literal,value:zB,regex:{pattern:kB.value,flags:wB.value},start:_B,end:_j}}function fP(_B){return _B.type===Sj||_B.type===Cj||_B.type===zj||_B.type===Oj}function gP(){var _B;return ZA(),_j>=kj?{type:Ej,start:_j,end:_j}:(_B=bj.charCodeAt(_j),QA(_B)?iP():40===_B||41===_B||59===_B?rP():39===_B||34===_B?lP():46===_B?VA(bj.charCodeAt(_j+1))?sP():rP():VA(_B)?sP():rP())}function hP(){var _B;return _B=wj,_j=_B.end,wj=gP(),_j=_B.end,_B}function yP(){var _B;_B=_j,wj=gP(),_j=_B}function vP(_B){var kB=new WA(Pj);return kB.elements=_B,kB}function xP(_B,kB,wB){var zB=new WA("||"===_B||"&&"===_B?Ij:qj);return zB.operator=_B,zB.left=kB,zB.right=wB,zB}function bP(_B,kB){var wB=new WA(Mj);return wB.callee=_B,wB.arguments=kB,wB}function _P(_B,kB,wB){var zB=new WA(Lj);return zB.test=_B,zB.consequent=kB,zB.alternate=wB,zB}function kP(_B){var kB=new WA(Tj);return kB.name=_B,kB}function wP(_B){var kB=new WA(Fj);return kB.value=_B.value,kB.raw=bj.slice(_B.start,_B.end),_B.regex&&("//"===kB.raw&&(kB.raw="/(?:)/"),kB.regex=_B.regex),kB}function zP(_B,kB,wB){var zB=new WA(Uj);return zB.computed="["===_B,zB.object=kB,zB.property=wB,zB.computed||(wB.member=!0),zB}function EP(_B){var kB=new WA($j);return kB.properties=_B,kB}function SP(_B,kB,wB){var zB=new WA(jj);return zB.key=kB,zB.value=wB,zB.kind=_B,zB}function CP(_B,kB){var wB=new WA(Nj);return wB.operator=_B,wB.argument=kB,wB.prefix=!0,wB}function OP(_B,kB){var wB,zB=Array.prototype.slice.call(arguments,2),EB=kB.replace(/%(\d)/g,function(SB,CB){return GA(CB<zB.length,"Message reference must be in range"),zB[CB]});throw wB=new Error(EB),wB.index=_j,wB.description=EB,wB}function RP(_B){_B.type===Ej&&OP(_B,Yj),_B.type===Rj&&OP(_B,Bj),_B.type===Aj&&OP(_B,Gj),_B.type===Sj&&OP(_B,Vj),_B.type===Cj&&OP(_B,Hj),OP(_B,Wj,_B.value)}function DP(_B){var kB=hP();kB.type===Dj&&kB.value===_B||RP(kB)}function AP(_B){return wj.type===Dj&&wj.value===_B}function PP(_B){return wj.type===Cj&&wj.value===_B}function qP(){var _B=[];for(_j=wj.start,DP("[");!AP("]");)AP(",")?(hP(),_B.push(null)):(_B.push(YP()),AP("]")||DP(","));return hP(),vP(_B)}function MP(){var _B;return _j=wj.start,_B=hP(),_B.type===Aj||_B.type===Rj?(_B.octal&&OP(_B,Qj),wP(_B)):kP(_B.value)}function LP(){var _B,kB,wB,zB;return _j=wj.start,_B=wj,_B.type===Sj?(wB=MP(),DP(":"),zB=YP(),SP("init",wB,zB)):_B.type!==Ej&&_B.type!==Dj?(kB=MP(),DP(":"),zB=YP(),SP("init",kB,zB)):void RP(_B)}function TP(){var _B,kB,wB,zB=[],EB={},SB=String;for(_j=wj.start,DP("{");!AP("}");)_B=LP(),kB=_B.key.type===Tj?_B.key.name:SB(_B.key.value),wB="$"+kB,Object.prototype.hasOwnProperty.call(EB,wB)?OP({},Kj):EB[wB]=!0,zB.push(_B),AP("}")||DP(",");return DP("}"),EP(zB)}function FP(){var _B;return DP("("),_B=XP(),DP(")"),_B}function IP(){var _B,kB,wB;if(AP("("))return FP();if(AP("["))return qP();if(AP("{"))return TP();if(_B=wj.type,_j=wj.start,_B===Sj||iN[wj.value])wB=kP(hP().value);else if(_B===Aj||_B===Rj)wj.octal&&OP(wj,Qj),wB=wP(hP());else{if(_B===Cj)throw new Error(eN);_B===zj?(kB=hP(),kB.value="true"===kB.value,wB=wP(kB)):_B===Oj?(kB=hP(),kB.value=null,wB=wP(kB)):AP("/")||AP("/=")?(wB=wP(mP()),yP()):RP(hP())}return wB}function UP(){var _B=[];if(DP("("),!AP(")"))for(;_j<kj&&(_B.push(YP()),!AP(")"));)DP(",");return DP(")"),_B}function $P(){var _B;return _j=wj.start,_B=hP(),fP(_B)||RP(_B),kP(_B.value)}function jP(){return DP("."),$P()}function NP(){var _B;return DP("["),_B=XP(),DP("]"),_B}function WP(){var _B,kB,wB;for(_B=IP();;)if(AP("."))wB=jP(),_B=zP(".",_B,wB);else if(AP("("))kB=UP(),_B=bP(_B,kB);else{if(!AP("["))break;wB=NP(),_B=zP("[",_B,wB)}return _B}function BP(){var _B=WP();if(wj.type===Dj&&(AP("++")||AP("--")))throw new Error(eN);return _B}function GP(){var _B,kB;if(wj.type!==Dj&&wj.type!==Cj)kB=BP();else{if(AP("++")||AP("--"))throw new Error(eN);if(AP("+")||AP("-")||AP("~")||AP("!"))_B=hP(),kB=GP(),kB=CP(_B.value,kB);else{if(PP("delete")||PP("void")||PP("typeof"))throw new Error(eN);kB=BP()}}return kB}function VP(_B){var kB=0;if(_B.type!==Dj&&_B.type!==Cj)return 0;switch(_B.value){case"||":kB=1;break;case"&&":kB=2;break;case"|":kB=3;break;case"^":kB=4;break;case"&":kB=5;break;case"==":case"!=":case"===":case"!==":kB=6;break;case"<":case">":case"<=":case">=":case"instanceof":case"in":kB=7;break;case"<<":case">>":case">>>":kB=8;break;case"+":case"-":kB=9;break;case"*":case"/":case"%":kB=11;}return kB}function HP(){var _B,kB,wB,zB,EB,SB,CB,OB,RB,DB;if(_B=wj,RB=GP(),zB=wj,0===(EB=VP(zB)))return RB;for(zB.prec=EB,hP(),kB=[_B,wj],CB=GP(),SB=[RB,zB,CB];0<(EB=VP(wj));){for(;2<SB.length&&EB<=SB[SB.length-2].prec;)CB=SB.pop(),OB=SB.pop().value,RB=SB.pop(),kB.pop(),wB=xP(OB,RB,CB),SB.push(wB);zB=hP(),zB.prec=EB,SB.push(zB),kB.push(wj),wB=GP(),SB.push(wB)}for(DB=SB.length-1,wB=SB[DB],kB.pop();1<DB;)kB.pop(),wB=xP(SB[DB-1].value,SB[DB-2],wB),DB-=2;return wB}function YP(){var _B,kB,wB;return _B=HP(),AP("?")&&(hP(),kB=YP(),DP(":"),wB=YP(),_B=_P(_B,kB,wB)),_B}function XP(){var _B=YP();if(AP(","))throw new Error(eN);return _B}function JP(_B){bj=_B,_j=0,kj=bj.length,wj=null,yP();var kB=XP();if(wj.type!==Ej)throw new Error("Unexpect token after expression.");return kB}function QP(_B){function kB(EB,SB,CB,OB){var RB=_B(SB[0]);return CB&&(RB=CB+"("+RB+")",0===CB.lastIndexOf("new ",0)&&(RB="("+RB+")")),RB+"."+EB+(0>OB?"":0===OB?"()":"("+SB.slice(1).map(_B).join(",")+")")}function wB(EB,SB,CB){return function(OB){return kB(EB,OB,SB,CB)}}var zB="new Date";return{isNaN:"isNaN",isFinite:"isFinite",abs:"Math.abs",acos:"Math.acos",asin:"Math.asin",atan:"Math.atan",atan2:"Math.atan2",ceil:"Math.ceil",cos:"Math.cos",exp:"Math.exp",floor:"Math.floor",log:"Math.log",max:"Math.max",min:"Math.min",pow:"Math.pow",random:"Math.random",round:"Math.round",sin:"Math.sin",sqrt:"Math.sqrt",tan:"Math.tan",clamp:function(SB){3>SB.length&&yk("Missing arguments to clamp function."),3<SB.length&&yk("Too many arguments to clamp function.");var CB=SB.map(_B);return"Math.max("+CB[1]+", Math.min("+CB[2]+","+CB[0]+"))"},now:"Date.now",utc:"Date.UTC",datetime:zB,date:wB("getDate",zB,0),day:wB("getDay",zB,0),year:wB("getFullYear",zB,0),month:wB("getMonth",zB,0),hours:wB("getHours",zB,0),minutes:wB("getMinutes",zB,0),seconds:wB("getSeconds",zB,0),milliseconds:wB("getMilliseconds",zB,0),time:wB("getTime",zB,0),timezoneoffset:wB("getTimezoneOffset",zB,0),utcdate:wB("getUTCDate",zB,0),utcday:wB("getUTCDay",zB,0),utcyear:wB("getUTCFullYear",zB,0),utcmonth:wB("getUTCMonth",zB,0),utchours:wB("getUTCHours",zB,0),utcminutes:wB("getUTCMinutes",zB,0),utcseconds:wB("getUTCSeconds",zB,0),utcmilliseconds:wB("getUTCMilliseconds",zB,0),length:wB("length",null,-1),indexof:wB("indexOf",null),lastindexof:wB("lastIndexOf",null),slice:wB("slice",null),parseFloat:"parseFloat",parseInt:"parseInt",upper:wB("toUpperCase","String",0),lower:wB("toLowerCase","String",0),substring:wB("substring","String"),replace:wB("replace","String"),regexp:"RegExp",test:wB("test","RegExp"),if:function(SB){3>SB.length&&yk("Missing arguments to if function."),3<SB.length&&yk("Too many arguments to if function.");var CB=SB.map(_B);return"("+CB[0]+"?"+CB[1]+":"+CB[2]+")"}}}function KP(_B){var kB={};return function(wB,zB){return(kB[zB]||(kB[zB]=_B(zB)))(wB)}}function ZP(_B,kB,wB){return pN.setMonth(_B),pN.setDate(kB),sN(pN,wB)}function dq(_B,kB,wB){try{_B[kB].apply(_B,["EXPRESSION"].concat([].slice.call(wB)))}catch(zB){_B.warn(zB)}return wB[wB.length-1]}function vq(_B,kB){var wB;return Ck(_B)?_B:bk(_B)?(wB=kB.scales[_B])&&wB.value:void 0}function xq(_B,kB,wB){var zB=hN+wB;if(!kB.hasOwnProperty(zB))try{kB[zB]=_B.scaleRef(wB)}catch(EB){}}function bq(_B,kB,wB,zB){if(kB[0].type===mN)xq(wB,zB,kB[0].value);else if(kB[0].type===fN)for(_B in wB.scales)xq(wB,zB,_B)}function Rq(_B){return function(kB,wB,zB){var EB=vq(kB,(zB||this).context);return EB&&EB.path[_B](wB)}}function Dq(_B){var kB=this.context.data[_B];return kB?kB.values.value:[]}function Aq(_B,kB,wB,zB){kB[0].type!==mN&&yk("First argument to data functions must be a string literal.");var EB=kB[0].value,SB=yN+EB;zB.hasOwnProperty(SB)||(zB[SB]=wB.getData(EB).tuplesRef())}function Mq(_B){return _B.data}function Lq(_B,kB){var wB=Dq.call(kB,_B);return wB.root&&wB.root.lookup||_N}function Iq(_B,kB){var wB,zB=kB[0],EB=kB[kB.length-1];return zB>EB&&(wB=zB,zB=EB,EB=wB),zB<=_B&&_B<=EB}function $q(_B){return function(kB){for(var wB in _B)if("_id"!==wB&&kB[wB]!==_B[wB])return!1;return!0}}function Nq(_B,kB){for(var wB=kB.fields,zB=kB.values,EB=kB.getter||(kB.getter=[]),SB=wB.length,CB=0;CB<SB;++CB)if(EB[CB]=EB[CB]||kk(wB[CB]),EB[CB](_B)!==zB[CB])return!1;return!0}function Wq(_B,kB){for(var wB,zB=kB.intervals,EB=zB.length,SB=0;SB<EB;++SB){if(wB=zB[SB].getter||(zB[SB].getter=kk(zB[SB].field)),zB[SB].extent[0]===zB[SB].extent[1])return!0;if(!Iq(wB(_B),zB[SB].extent))return!1}return!0}function Bq(_B,kB,wB,zB,EB,SB){for(var CB,OB,RB=this.context.data[_B],DB=RB?RB.values.value:[],AB=zB!==kN,PB=DB.length,qB=0;qB<PB;++qB)if(CB=DB[qB],OB=kB===CB.unit,(EB!==zN||!OB)&&(EB!==wN||OB)&&(OB=SB(wB,CB),AB^OB))return OB;return!PB||AB}function Xq(_B,kB,wB){return _B[0]>kB&&(_B[0]=kB),_B[1]<wB&&(_B[1]=wB),_B}function Jq(_B,kB,wB){return wB<_B[0]||_B[1]<kB?[]:(_B[0]<kB&&(_B[0]=kB),_B[1]>wB&&(_B[1]=wB),_B)}function Qq(_B,kB,wB){return 1===arguments.length?EN[_B]:(EN[_B]=kB,wB&&(RN[_B]=wB),qN&&(qN.functions[_B]=ON+_B),this)}function Zq(_B,kB,wB){var zB,EB,SB={};try{zB=JP(_B)}catch(CB){yk("Expression parse error: "+_k(_B))}return zB.visit(function(CB){if("CallExpression"===CB.type){var OB=CB.callee.name,RB=PN.visitors[OB];RB&&RB(OB,CB.arguments,kB,SB)}}),EB=qN(zB),EB.globals.forEach(function(CB){var OB=MN+CB;!SB.hasOwnProperty(OB)&&kB.getSignal(CB)&&(SB[OB]=kB.signalRef(CB))}),{$expr:wB?wB+"return("+EB.code+");":EB.code,$fields:EB.fields,$params:SB}}function eM(_B,kB){return _B.signal?kB.getSignal(_B.signal).id:aM(_B,kB)}function tM(_B){return _B===TN?LN:_B||LN}function aM(_B,kB){return(_B.merge?nM:_B.stream?iM:_B.type?rM:yk("Invalid stream specification: "+_k(_B)))(_B,kB)}function nM(_B,kB){var wB=_B.merge.map(function(EB){return aM(EB,kB)}),zB=dM({merge:wB},_B,kB);return kB.addStream(zB).id}function iM(_B,kB){var wB=aM(_B.stream,kB),zB=dM({stream:wB},_B,kB);return kB.addStream(zB).id}function rM(_B,kB){var wB=kB.event(tM(_B.source),_B.type),zB=dM({stream:wB},_B,kB);return 1===Object.keys(zB).length?wB:kB.addStream(zB).id}function dM(_B,kB,wB){var zB=kB.between;return zB&&(2!==zB.length&&yk("Stream \"between\" parameter must have 2 entries: "+_k(kB)),_B.between=[aM(zB[0],wB),aM(zB[1],wB)]),zB=kB.filter?Ek(kB.filter):[],(kB.marktype||kB.markname||kB.markrole)&&zB.push(oM(kB.marktype,kB.markname,kB.markrole)),kB.source===TN&&zB.push("inScope(event.item)"),zB.length&&(_B.filter=Zq("("+zB.join(")&&(")+")").$expr),null!=(zB=kB.throttle)&&(_B.throttle=+zB),null!=(zB=kB.debounce)&&(_B.debounce=+zB),kB.consume&&(_B.consume=!0),_B}function oM(_B,kB,wB){var zB="event.item";return zB+(_B&&"*"!==_B?"&&"+zB+".mark.marktype==='"+_B+"'":"")+(wB?"&&"+zB+".mark.role==='"+wB+"'":"")+(kB?"&&"+zB+".mark.name==='"+kB+"'":"")}function sM(_B,kB,wB){return DN=kB||FN,AN=wB||HN,pM(_B.trim()).map(cM)}function lM(_B){return AN.hasOwnProperty(_B)}function uM(_B,kB,wB,zB,EB){for(var SB,CB=0,OB=_B.length;kB<OB;++kB){if(SB=_B[kB],!CB&&SB===wB)return kB;EB&&0<=EB.indexOf(SB)?--CB:zB&&0<=zB.indexOf(SB)&&++CB}return kB}function pM(_B){for(var kB=[],wB=0,zB=_B.length,EB=0;EB<zB;)EB=uM(_B,EB,WN,IN+$N,UN+jN),kB.push(_B.substring(wB,EB).trim()),wB=++EB;if(0===kB.length)throw"Empty event selector: "+_B;return kB}function cM(_B){return"["===_B[0]?mM(_B):fM(_B)}function mM(_B){var kB,wB,zB=_B.length,EB=1;if((EB=uM(_B,EB,UN,IN,UN))===zB)throw"Empty between selector: "+_B;if(kB=pM(_B.substring(1,EB)),2!==kB.length)throw"Between selector must have two elements: "+_B;if(_B=_B.slice(EB+1).trim(),_B[0]!==GN)throw"Expected '>' after between selector: "+_B;return kB=kB.map(cM),wB=cM(_B.slice(1).trim()),wB.between?{between:kB,stream:wB}:(wB.between=kB,wB)}function fM(_B){var kB,wB,zB={source:DN},EB=[],SB=[0,0],CB=0,OB=0,RB=_B.length,DB=0;if(_B[RB-1]===jN){if(!(0<=(DB=_B.lastIndexOf($N))))throw"Unmatched right brace: "+_B;try{SB=gM(_B.substring(DB+1,RB-1))}catch(AB){throw"Invalid throttle specification: "+_B}_B=_B.slice(0,DB).trim(),RB=_B.length,DB=0}if(!RB)throw _B;if(_B[0]===BN&&(CB=++DB),kB=uM(_B,DB,NN),kB<RB&&(EB.push(_B.substring(OB,kB).trim()),OB=DB=++kB),(DB=uM(_B,DB,IN))===RB)EB.push(_B.substring(OB,RB).trim());else if(EB.push(_B.substring(OB,DB).trim()),wB=[],(OB=++DB)===RB)throw"Unmatched left bracket: "+_B;for(;DB<RB;){if((DB=uM(_B,DB,UN))===RB)throw"Unmatched left bracket: "+_B;if(wB.push(_B.substring(OB,DB).trim()),DB<RB-1&&_B[++DB]!==IN)throw"Expected left bracket: "+_B;OB=++DB}if(!(RB=EB.length)||VN.test(EB[RB-1]))throw"Invalid event selector: "+_B;return 1<RB?(zB.type=EB[1],CB?zB.markname=EB[0].slice(1):lM(EB[0])?zB.marktype=EB[0]:zB.source=EB[0]):zB.type=EB[0],"!"===zB.type.slice(-1)&&(zB.consume=!0,zB.type=zB.type.slice(0,-1)),null!=wB&&(zB.filter=wB),SB[0]&&(zB.throttle=SB[0]),SB[1]&&(zB.debounce=SB[1]),zB}function gM(_B){var kB=_B.split(WN);if(!_B.length||2<kB.length)throw _B;return kB.map(function(wB){var zB=+wB;if(zB!==zB)throw _B;return zB})}function hM(_B,kB,wB){var zB,EB=_B.events,SB=_B.update,CB=_B.encode,OB=[],RB="";EB||yk("Signal update missing events specification."),bk(EB)&&(EB=sM(EB)),EB=Ek(EB).filter(function(DB){return DB.signal?(OB.push(DB),0):1}),EB.length&&OB.push(1<EB.length?{merge:EB}:EB[0]),null!=CB&&(SB&&yk("Signal encode and update are mutually exclusive."),SB="encode(item(),"+_k(CB)+")"),RB=bk(SB)?Zq(SB,kB,YN):null==SB.expr?null==SB.value?null==SB.signal?yk("Invalid signal update specification."):{$expr:"_.value",$params:{value:kB.signalRef(SB.signal)}}:SB.value:Zq(SB.expr,kB,YN),zB={target:wB,update:RB},_B.force&&(zB.options={force:!0}),OB.forEach(function(DB){DB={source:eM(DB,kB)},kB.addUpdate(Rk(DB,zB))})}function yM(_B,kB){var wB=kB.getSignal(_B.name);if(_B.update){var zB=Zq(_B.update,kB);wB.update=zB.$expr,wB.params=zB.$params}_B.on&&_B.on.forEach(function(EB){hM(EB,kB,wB.id)})}function vM(_B,kB){var wB={};for(var zB in _B)"name"!==zB&&(wB[zB]=xM(_B[zB],kB));kB.addProjection(_B.name,wB)}function xM(_B,kB){return KT(_B)?_B.map(function(wB){return xM(wB,kB)}):xk(_B)?_B.signal?kB.signalRef(_B.signal):yk("Unsupported parameter object: "+_k(_B)):_B}function bM(_B,kB){var wB="";return XN[kB]?wB:(_B.x2&&(_B.x?(JN[kB]&&(wB+="if(o.x>o.x2)$=o.x,o.x=o.x2,o.x2=$;"),wB+="o.width=o.x2-o.x;"):_B.width?wB+="o.x=o.x2-o.width;":wB+="o.x=o.x2;"),_B.xc&&(_B.width?wB+="o.x=o.xc-o.width/2;":wB+="o.x=o.xc;"),_B.y2&&(_B.y?(JN[kB]&&(wB+="if(o.y>o.y2)$=o.y,o.y=o.y2,o.y2=$;"),wB+="o.height=o.y2-o.y;"):_B.height?wB+="o.y=o.y2-o.height;":wB+="o.y=o.y2;"),_B.yc&&(_B.height?wB+="o.y=o.yc-o.height/2;":wB+="o.y=o.yc;"),wB)}function _M(_B,kB,wB,zB){function EB(SB,CB,OB,RB){return"this."+SB+"("+[DM(null,CB,kB,wB,zB),DM(null,OB,kB,wB,zB),DM(null,RB,kB,wB,zB)].join(",")+").toString()"}return _B.c?EB("hcl",_B.h,_B.c,_B.l):_B.h||_B.s?EB("hsl",_B.h,_B.s,_B.l):_B.l||_B.a?EB("lab",_B.l,_B.a,_B.b):_B.r||_B.g||_B.b?EB("rgb",_B.r,_B.g,_B.b):null}function kM(_B,kB,wB,zB){var EB=Zq(_B,kB);return EB.$fields.forEach(function(SB){zB[SB]=1}),Rk(wB,EB.$params),EB.$expr}function wM(_B,kB,wB,zB){return zM(xk(_B)?_B:{datum:_B},kB,wB,zB)}function zM(_B,kB,wB,zB){var EB,SB,CB;if(_B.signal)EB="datum",CB=kM(_B.signal,kB,wB,zB);else if(_B.group||_B.parent){for(SB=Math.max(1,_B.level||1),EB="item";0<SB--;)EB+=".mark.group";_B.parent?(CB=_B.parent,EB+=".datum"):CB=_B.group}else _B.datum?(EB="datum",CB=_B.datum):yk("Invalid field reference: "+_k(_B));return _B.signal||(bk(CB)?(zB[CB]=1,CB=vk(CB).map(_k).join("][")):CB=zM(CB,kB,wB,zB)),EB+"["+CB+"]"}function EM(_B,kB,wB,zB,EB){var SB,CB,OB,RB=CM(_B.scale,wB,zB,EB);return null==_B.range?(void 0!==kB&&(kB=RB+"("+kB+")"),_B.band&&(OB=SM(_B.scale,wB))&&(CB=RB+".bandwidth",SB=+_B.band,SB=CB+"()"+(1===SB?"":"*"+SB),0>OB&&(SB="("+CB+"?"+SB+":0)"),kB=(kB?kB+"+":"")+SB,_B.extra&&(kB="(datum.extra?"+RB+"(datum.extra.value):"+kB+")")),null==kB&&(kB="0")):(SB=+_B.range,CB=RB+".range()",kB=0===SB?CB+"[0]":"($="+CB+","+(1===SB?"$[$.length-1]":"$[0]+"+SB+"*($[$.length-1]-$[0])")+")"),kB}function SM(_B,kB){if(!bk(_B))return-1;var wB=kB.scaleType(_B);return"band"===wB||"point"===wB?1:0}function CM(_B,kB,wB,zB){if(bk(_B))EB=hN+_B,wB.hasOwnProperty(EB)||(wB[EB]=kB.scaleRef(_B)),EB=_k(EB);else{for(var EB in kB.scales)wB[hN+EB]=kB.scaleRef(EB);EB=_k(hN)+"+"+(_B.signal?"("+kM(_B.signal,kB,wB,zB)+")":wM(_B,kB,wB,zB))}return"_["+EB+"]"}function OM(_B,kB,wB,zB){return"this.gradient("+CM(_B.gradient,kB,wB,zB)+","+_k(_B.start)+","+_k(_B.stop)+","+_k(_B.count)+")"}function RM(_B,kB,wB,zB){return xk(_B)?"("+DM(null,_B,kB,wB,zB)+")":_B}function DM(_B,kB,wB,zB,EB){if(null!=kB.gradient)return OM(kB,wB,zB,EB);var SB=kB.signal?kM(kB.signal,wB,zB,EB):kB.color?_M(kB.color,wB,zB,EB):null==kB.field?void 0===kB.value?void 0:_k(kB.value):wM(kB.field,wB,zB,EB);return null!=kB.scale&&(SB=EM(kB,SB,wB,zB,EB)),void 0===SB&&(SB=null),null!=kB.exponent&&(SB="Math.pow("+SB+","+RM(kB.exponent,wB,zB,EB)+")"),null!=kB.mult&&(SB+="*"+RM(kB.mult,wB,zB,EB)),null!=kB.offset&&(SB+="+"+RM(kB.offset,wB,zB,EB)),kB.round&&(SB="Math.round("+SB+")"),SB}function AM(_B,kB,wB){return _B+"["+_k(kB)+"]="+wB+";"}function PM(_B,kB,wB,zB,EB){var SB="";return kB.forEach(function(CB){var OB=DM(_B,CB,wB,zB,EB);SB+=CB.test?kM(CB.test,wB,zB,EB)+"?"+OB+":":OB}),AM("o",_B,SB)}function qM(_B,kB,wB,zB){var EB,SB,CB,OB={},RB="var o=item,datum=o.datum,$;";for(EB in _B)SB=_B[EB],KT(SB)?RB+=PM(EB,SB,zB,wB,OB):(CB=DM(EB,SB,zB,wB,OB),RB+=AM("o",EB,CB));return RB+=bM(_B,kB),RB+="return 1;",{$expr:RB,$fields:Object.keys(OB),$output:Object.keys(_B)}}function MM(_B){return xk(_B)?_B:{value:_B}}function LM(_B,kB,wB){return null==wB?0:(_B[kB]={value:wB},1)}function TM(_B,kB,wB){for(var zB in kB)wB&&wB.hasOwnProperty(zB)||(_B[zB]=Rk(_B[zB]||{},kB[zB]));return _B}function FM(_B,kB,wB,zB,EB){var SB,CB;for(CB in EB=EB||{},EB.encoders={$encode:SB={}},_B=IM(_B,kB,wB,zB.config),_B)SB[CB]=qM(_B[CB],kB,EB,zB);return EB}function IM(_B,kB,wB,zB){var EB,SB;for(SB in"legend"!=wB&&0!==(wB+"").indexOf("axis")||(wB=null),zB=wB===KN?zB.group:wB===QN||zB[kB=wB]?Rk({},zB.mark,zB[kB]):{},EB={},zB)UM(SB,_B)||("fill"===SB||"stroke"===SB)&&(UM("fill",_B)||UM("stroke",_B))||(EB[SB]={value:zB[SB]});return _B=Rk({},_B),_B.enter=Rk(EB,_B.enter),_B}function UM(_B,kB){return kB.enter&&kB.enter[_B]||kB.update&&kB.update[_B]}function $M(_B,kB,wB,zB,EB,SB){return{type:_B,name:SB?SB.name:void 0,role:kB,key:wB,from:zB,interactive:SB&&SB.interactive,encode:TM(EB,SB,mW)}}function jM(_B,kB,wB){var zB,EB,SB={value:0},CB={};return CB.enter=zB={opacity:SB,x:SB,y:SB},LM(zB,"width",kB.gradientWidth),LM(zB,"height",kB.gradientHeight),LM(zB,"stroke",kB.gradientStrokeColor),LM(zB,"strokeWidth",kB.gradientStrokeWidth),CB.exit={opacity:SB},CB.update=EB={x:SB,y:SB,fill:{gradient:_B},opacity:{value:1}},LM(EB,"width",kB.gradientWidth),LM(EB,"height",kB.gradientHeight),$M(gW,sW,void 0,void 0,CB,wB)}function NM(_B,kB,wB,zB){var EB,SB,CB={value:0},OB={};return OB.enter=EB={opacity:CB,text:{field:zW}},LM(EB,"fill",kB.labelColor),LM(EB,"font",kB.labelFont),LM(EB,"fontSize",kB.labelFontSize),LM(EB,"baseline",kB.gradientLabelBaseline),LM(EB,"limit",kB.gradientLabelLimit),OB.exit={opacity:CB},OB.update=SB={opacity:{value:1}},EB.x=SB.x={field:SW,mult:kB.gradientWidth},EB.y=SB.y={value:kB.gradientHeight,offset:kB.gradientLabelOffset},EB.align=SB.align={signal:AW},$M(vW,lW,SW,zB,OB,wB)}function WM(_B,kB,wB,zB){var EB,SB,CB={value:0},OB={};return OB.enter=EB={opacity:CB,text:{field:zW}},LM(EB,"align",kB.labelAlign),LM(EB,"baseline",kB.labelBaseline),LM(EB,"fill",kB.labelColor),LM(EB,"font",kB.labelFont),LM(EB,"fontSize",kB.labelFontSize),LM(EB,"limit",kB.labelLimit),OB.exit={opacity:CB},OB.update=SB={opacity:{value:1}},EB.x=SB.x={field:EW,offset:kB.labelOffset},EB.y=SB.y={field:CW,mult:.5,offset:{field:OW,offset:{field:{group:"entryPadding"},mult:{field:wW}}}},$M(vW,lW,RW,zB,OB,wB)}function BM(_B,kB,wB,zB){var EB,SB,CB={value:0},OB={};return OB.enter=EB={opacity:CB},LM(EB,"shape",kB.symbolType),LM(EB,"size",kB.symbolSize),LM(EB,"strokeWidth",kB.symbolStrokeWidth),_B.fill||LM(EB,"stroke",kB.symbolColor),OB.exit={opacity:CB},OB.update=SB={opacity:{value:1}},EB.x=SB.x={field:EW,mult:.5},EB.y=SB.y={field:CW,mult:.5,offset:{field:OW,offset:{field:{group:"entryPadding"},mult:{field:wW}}}},DW.forEach(function(RB){_B[RB]&&(SB[RB]=EB[RB]={scale:_B[RB],field:RW})}),$M(yW,uW,RW,zB,OB,wB)}function GM(_B,kB,wB,zB){var EB,SB={value:0},CB=_B.title,OB={};return OB.enter=EB={x:{field:{group:"padding"}},y:{field:{group:"padding"}},opacity:SB},LM(EB,"align",kB.titleAlign),LM(EB,"baseline",kB.titleBaseline),LM(EB,"fill",kB.titleColor),LM(EB,"font",kB.titleFont),LM(EB,"fontSize",kB.titleFontSize),LM(EB,"fontWeight",kB.titleFontWeight),LM(EB,"limit",kB.titleLimit),OB.exit={opacity:SB},OB.update={opacity:{value:1},text:CB&&CB.signal?{signal:CB.signal}:{value:CB+""}},$M(vW,pW,null,zB,OB,wB)}function VM(_B,kB,wB,zB,EB,SB){return{type:fW,name:kB,role:_B,from:wB,interactive:zB,encode:EB,marks:SB}}function HM(_B){var kB=_B.role||"";return kB.indexOf("axis")&&kB.indexOf("legend")?_B.type===fW?ZN:kB||QN:kB}function YM(_B){return{clip:_B.clip||!1,interactive:!1!==_B.interactive,marktype:_B.type,name:_B.name||void 0,role:_B.role||HM(_B),zindex:+_B.zindex||void 0}}function XM(_B){return _B}function JM(_B,kB,wB,zB){this.id=-1,this.type=_B,this.value=kB,this.params=wB,zB&&(this.parent=zB)}function QM(_B,kB,wB,zB){return new JM(_B,kB,wB,zB)}function KM(_B,kB){return QM("Operator",_B,kB)}function ZM(_B){var kB={$ref:_B.id};return 0>_B.id&&(_B.refs=_B.refs||[]).push(kB),kB}function eL(_B,kB){return kB?{$field:_B,$name:kB}:{$field:_B}}function tL(_B,kB){return{$compare:_B,$order:kB}}function aL(_B){return{$key:_B}}function nL(_B){return xk(_B)?(_B.order===qW?"-":"+")+iL(_B.op,_B.field):""}function iL(_B,kB){return(_B&&_B.signal?"$"+_B.signal:_B||"")+(_B&&kB?"_":"")+(kB&&kB.signal?"$"+kB.signal:kB||"")}function rL(_B){return _B&&_B.signal}function dL(_B){return function(kB,wB,zB){return QM(_B,wB,kB||void 0,zB)}}function oL(_B,kB){var wB=YS(_B.type);wB||yk("Unrecognized transform type: "+_k(_B.type));var zB=QM(wB.type,null,sL(wB,_B,kB));return _B.signal&&kB.addSignal(_B.signal,kB.proxy(zB)),zB.metadata=wB.metadata||{},zB}function sL(_B,kB,wB){var zB,EB,SB,CB={};for(EB=0,SB=_B.params.length;EB<SB;++EB)zB=_B.params[EB],CB[zB.name]=lL(zB,kB,wB);return CB}function lL(_B,kB,wB){var zB=_B.type,EB=kB[_B.name];return"index"===zB?pL(_B,kB,wB):void 0===EB?void(_B.required&&yk("Missing required "+_k(kB.type)+" parameter: "+_k(_B.name))):"param"===zB?cL(_B,kB,wB):"projection"===zB?wB.projectionRef(kB[_B.name]):_B.array&&!rL(EB)?EB.map(function(SB){return uL(_B,SB,wB)}):uL(_B,EB,wB)}function uL(_B,kB,wB){var zB=_B.type;if(rL(kB))return yL(zB)?yk("Expression references can not be signals."):vL(zB)?wB.fieldRef(kB):xL(zB)?wB.compareRef(kB):wB.signalRef(kB.signal);var EB=_B.expr||vL(zB);return EB&&fL(kB)?Zq(kB.expr,wB):EB&&gL(kB)?eL(kB.field):yL(zB)?Zq(kB,wB):hL(zB)?ZM(wB.getData(kB).values):vL(zB)?eL(kB):xL(zB)?wB.compareRef(kB):kB}function pL(_B,kB,wB){return bk(kB.from)||yk("Lookup \"from\" parameter must be a string literal."),wB.getData(kB.from).lookupRef(wB,kB.key)}function cL(_B,kB,wB){var zB=kB[_B.name];return _B.array?(KT(zB)||yk("Expected an array of sub-parameters. Instead: "+_k(zB)),zB.map(function(EB){return mL(_B,EB,wB)})):mL(_B,zB,wB)}function mL(_B,kB,wB){var zB,EB,SB,CB,OB;for(CB=0,OB=_B.params.length;CB<OB;++CB){for(SB in EB=_B.params[CB],EB.key)if(EB.key[SB]!==kB[SB]){EB=null;break}if(EB)break}return EB||yk("Unsupported parameter: "+_k(kB)),zB=Rk(sL(EB,kB,wB),EB.key),ZM(wB.add(YW(zB)))}function fL(_B){return _B&&_B.expr}function gL(_B){return _B&&_B.field}function hL(_B){return"data"===_B}function yL(_B){return"expr"===_B}function vL(_B){return"field"===_B}function xL(_B){return"compare"===_B}function bL(_B,kB,wB){var zB,EB,SB,CB,OB;return _B?(zB=_B.facet)&&(kB||yk("Only group marks can be faceted."),null==zB.field?(EB=wB.keyRef(zB.groupby),_B.data?OB=ZM(wB.getData(_B.data).aggregate):(SB=oL(Rk({type:"aggregate",groupby:Ek(zB.groupby)},zB.aggregate)),SB.params.key=EB,SB.params.pulse=ZM(wB.getData(zB.data).output),CB=OB=ZM(wB.add(SB)))):CB=OB=ZM(wB.getData(zB.data).output)):CB=ZM(wB.add(FW(null,[{}]))),CB||(CB=_B.$ref?_B:ZM(_B.mark?wB.getData(XM(_B.mark)).output:wB.getData(_B.data).output)),{key:EB,pulse:CB,parent:OB}}function _L(_B,kB,wB,zB,EB){this.scope=_B,this.input=kB,this.output=wB,this.values=zB,this.aggregate=EB,this.index={}}function kL(_B){return bk(_B)?_B:null}function wL(_B,kB,wB){var zB,EB=iL(wB.op,wB.field);if(kB.ops){for(var SB=0,CB=kB.as.length;SB<CB;++SB)if(kB.as[SB]===EB)return;}else kB.ops=["count"],kB.fields=[null],kB.as=["count"];wB.op&&(kB.ops.push((zB=wB.op.signal)?_B.signalRef(zB):wB.op),kB.fields.push(_B.fieldRef(wB.field)),kB.as.push(EB))}function zL(_B,kB,wB,zB,EB,SB,CB){var OB,RB,DB=kB[wB]||(kB[wB]={}),AB=nL(SB),PB=kL(EB);if(null!=PB&&(_B=kB.scope,PB+=AB?"|"+AB:"",OB=DB[PB]),!OB){var qB=SB?{field:PW,pulse:kB.countsRef(_B,EB,SB)}:{field:_B.fieldRef(EB),pulse:ZM(kB.output)};AB&&(qB.sort=_B.sortRef(SB)),RB=_B.add(QM(zB,void 0,qB)),CB&&(kB.index[EB]=RB),OB=ZM(RB),null!=PB&&(DB[PB]=OB)}return OB}function EL(_B,kB,wB){var zB,EB,SB,CB,OB=_B.from.facet,RB=OB.name,DB=ZM(kB.getData(OB.data).output);OB.name||yk("Facet must have a name: "+_k(OB)),OB.data||yk("Facet must reference a data set: "+_k(OB)),OB.field?CB=kB.add(XW({field:kB.fieldRef(OB.field),pulse:DB})):OB.groupby?CB=kB.add(jW({key:kB.keyRef(OB.groupby),group:ZM(kB.proxy(wB.parent)),pulse:DB})):yk("Facet must specify groupby or field: "+_k(OB)),zB=kB.fork(),EB=zB.add(FW()),SB=zB.add(tB({pulse:ZM(EB)})),zB.addData(RB,new _L(zB,EB,EB,SB)),zB.addSignal("parent",null),CB.params.subflow={$subflow:lT(_B,zB).toRuntime()}}function SL(_B,kB,wB){var zB=kB.add(XW({pulse:wB.pulse})),EB=kB.fork();EB.add(tB()),EB.addSignal("parent",null),zB.params.subflow={$subflow:lT(_B,EB).toRuntime()}}function CL(_B,kB,wB){var zB,EB,SB=_B.remove,CB=_B.insert,OB=_B.toggle,RB=_B.modify,DB=_B.values,AB=kB.add(KM());zB="if("+_B.trigger+",modify(\""+wB+"\","+[CB,SB,OB,RB,DB].map(function(PB){return null==PB?"null":PB}).join(",")+"),0)",EB=Zq(zB,kB),AB.update=EB.$expr,AB.params=EB.$params}function OL(_B,kB){var wB,zB,EB,SB,CB,OB,RB,DB,AB,PB,qB,MB,LB,TB=HM(_B),FB=_B.type===fW,IB=_B.from&&_B.from.facet,UB=_B.layout||TB===ZN||TB===KN,$B=TB===QN||UB||IB;EB=bL(_B.from,FB,kB),zB=kB.add(UW({key:EB.key||(_B.key?eL(_B.key):void 0),pulse:EB.pulse,clean:!FB})),AB=ZM(zB),zB=SB=kB.add(FW({pulse:AB})),zB=kB.add(GW({markdef:YM(_B),context:{$context:!0},groups:kB.lookup(),parent:kB.signals.parent?kB.signalRef("parent"):null,index:kB.markpath(),pulse:ZM(zB)})),PB=ZM(zB),zB=kB.add($W(FM(_B.encode,_B.type,TB,kB,{pulse:PB}))),zB.params.parent=kB.encode(),_B.transform&&_B.transform.forEach(function(jB){var NB=oL(jB,kB);(NB.metadata.generates||NB.metadata.changes)&&yk("Mark transforms should not generate new data."),NB.params.pulse=ZM(zB),kB.add(zB=NB)}),_B.sort&&(zB=kB.add(aB({sort:kB.compareRef(_B.sort),pulse:ZM(zB)}))),qB=ZM(zB),(IB||UB)&&(UB=kB.add(nB({layout:kB.objectProperty(_B.layout),legendMargin:kB.config.legendMargin,mark:PB,pulse:qB})),MB=ZM(UB)),CB=kB.add(TW({mark:PB,pulse:MB||qB})),LB=ZM(CB),FB&&($B&&(wB=kB.operators,wB.pop(),UB&&wB.pop()),kB.pushState(qB,MB||LB,AB),IB?EL(_B,kB,EB):$B?SL(_B,kB,EB):lT(_B,kB),kB.popState(),$B&&(UB&&wB.push(UB),wB.push(CB))),OB=kB.add(ZW({pulse:LB})),RB=kB.add(tB({pulse:LB},void 0,kB.parent())),null!=_B.name&&(DB=XM(_B.name),kB.addData(DB,new _L(kB,SB,OB,RB)),_B.on&&_B.on.forEach(function(jB){(jB.insert||jB.remove||jB.toggle)&&yk("Marks only support modify triggers."),CL(jB,kB,DB)}))}function RL(_B,kB){var wB,zB,EB,SB,CB,OB,RB,DB,AB=_B.type||"symbol",PB=kB.config.legend,qB=_B.name||void 0,MB=_B.encode||{},LB=!!_B.interactive,TB=_B.size||_B.shape||_B.fill||_B.stroke||_B.strokeDash||_B.opacity;return TB||yk("Missing valid scale for legend."),wB={orient:DL(_B.orient,PB.orient),title:null!=_B.title},zB=ZM(kB.add(FW(null,[wB]))),OB=TM({enter:PL(PB),update:{offset:MM(DL(_B.offset,PB.offset)),padding:MM(DL(_B.padding,PB.padding)),titlePadding:MM(DL(_B.titlePadding,PB.titlePadding))}},MB.legend),RB={update:{x:{field:{group:"padding"}},y:{field:{group:"padding"}},entryPadding:MM(DL(_B.entryPadding,PB.entryPadding))}},"gradient"===AB?(EB=ZM(kB.add(BW({type:"gradient",scale:kB.scaleRef(TB),count:kB.property(_B.tickCount),values:kB.property(_B.values),formatSpecifier:kB.property(_B.format)}))),DB=[jM(TB,PB,MB.gradient),NM(_B,PB,MB.labels,EB)]):(EB=ZM(kB.add(BW({size:AL(_B,PB,MB.labels),scale:kB.scaleRef(TB),count:kB.property(_B.tickCount),values:kB.property(_B.values),formatSpecifier:kB.property(_B.format)}))),DB=[BM(_B,PB,MB.symbols,EB),WM(_B,PB,MB.labels,EB)]),DB=[VM(oW,null,zB,LB,RB,DB)],wB.title&&(CB=GM(_B,PB,MB.title,zB),RB.update.y.offset={field:{group:"titlePadding"},offset:CB.encode.update.fontSize||CB.encode.enter.fontSize},DB.push(CB)),SB=VM(dW,qB,zB,LB,OB,DB),_B.zindex&&(SB.zindex=_B.zindex),OL(SB,kB)}function DL(_B,kB){return null==_B?kB:_B}function AL(_B,kB,wB){var zB,EB=+kB.symbolSize;return zB=wB&&wB.update&&wB.update.fontSize,zB||(zB=wB&&wB.enter&&wB.enter.fontSize),zB&&(zB=zB.value),zB||(zB=+kB.labelFontSize),_B.size?{$expr:"Math.max(Math.ceil(Math.sqrt(_.scale(datum))),"+zB+")"}:Math.max(Math.ceil(Math.sqrt(EB)),zB)}function PL(_B){var kB={};return LM(kB,"fill",_B.fillColor)+LM(kB,"stroke",_B.strokeColor)+LM(kB,"strokeWidth",_B.strokeWidth)+LM(kB,"strokeDash",_B.strokeDash)+LM(kB,"cornerRadius",_B.cornerRadius)?kB:void 0}function qL(_B){return lB.hasOwnProperty(_B)}function ML(_B){return"quantile"===_B}function LL(_B,kB){var wB,zB,EB=_B.type||"linear";for(zB in sB.hasOwnProperty(EB)||yk("Unrecognized scale type: "+_k(EB)),wB={type:EB,domain:UL(_B.domain,_B,kB)},null!=_B.range&&(wB.range=XL(_B,kB,wB)),null!=_B.interpolate&&YL(_B.interpolate,wB),_B)wB.hasOwnProperty(zB)||"name"===zB||(wB[zB]=TL(_B[zB],kB));kB.addScale(_B.name,wB)}function TL(_B,kB){return xk(_B)?_B.signal?kB.signalRef(_B.signal):yk("Unsupported object: "+_k(_B)):_B}function FL(_B,kB){return _B.signal?kB.signalRef(_B.signal):_B.map(function(wB){return TL(wB,kB)})}function IL(_B){yk("Can not find data set: "+_k(_B))}function UL(_B,kB,wB){return _B?_B.signal?wB.signalRef(_B.signal):(KT(_B)?$L:_B.fields?NL:jL)(_B,kB,wB):void(null==kB.domainMin&&null==kB.domainMax||yk("No scale domain defined for domainMin/domainMax to override."))}function $L(_B,kB,wB){return _B.map(function(zB){return TL(zB,wB)})}function jL(_B,kB,wB){var zB=wB.getData(_B.data);return zB||IL(_B.data),qL(kB.type)?zB.valuesRef(wB,_B.field,GL(_B.sort,!1)):ML(kB.type)?zB.domainRef(wB,_B.field):zB.extentRef(wB,_B.field)}function NL(_B,kB,wB){var zB=_B.data,EB=_B.fields.reduce(function(SB,CB){return CB=bk(CB)?{data:zB,field:CB}:KT(CB)||CB.signal?WL(CB,wB):CB,SB.push(CB),SB},[]);return(qL(kB.type)?BL:ML(kB.type)?VL:HL)(_B,wB,EB)}function WL(_B,kB){var wB="_:vega:_"+dB++,zB=FW({});return KT(_B)?zB.value={$ingest:_B}:_B.signal&&kB.signalRef("modify("+_k(wB)+","+_B.signal+", true)"),kB.addDataPipeline(wB,[zB,tB({})]),{data:wB,field:"data"}}function BL(_B,kB,wB){var zB,EB,SB,CB;return zB=wB.map(function(OB){var RB=kB.getData(OB.data);return RB||IL(OB.data),RB.countsRef(kB,OB.field)}),EB=kB.add(MW({groupby:PW,ops:["sum"],fields:[kB.fieldRef("count")],as:["count"],pulse:zB})),SB=kB.add(FW({pulse:ZM(EB)})),CB=kB.add(iB({field:PW,sort:kB.sortRef(GL(_B.sort,!0)),pulse:ZM(SB)})),ZM(CB)}function GL(_B,kB){return _B&&(_B.field||_B.op?_B.field||"count"===_B.op?kB&&_B.field?yk("Multiple domain scales can not sort by field."):kB&&_B.op&&"count"!==_B.op&&yk("Multiple domain scales support op count only."):yk("No field provided for sort aggregate op: "+_B.op):xk(_B)?_B.field="key":_B={field:"key"}),_B}function VL(_B,kB,wB){var zB=wB.map(function(EB){var SB=kB.getData(EB.data);return SB||IL(EB.data),SB.domainRef(kB,EB.field)});return ZM(kB.add(HW({values:zB})))}function HL(_B,kB,wB){var zB=wB.map(function(EB){var SB=kB.getData(EB.data);return SB||IL(EB.data),SB.extentRef(kB,EB.field)});return ZM(kB.add(VW({extents:zB})))}function YL(_B,kB){kB.interpolate=TL(_B.type||_B),null!=_B.gamma&&(kB.interpolateGamma=TL(_B.gamma))}function XL(_B,kB,wB){var zB=_B.range,EB=kB.config.range;if(zB.signal)return kB.signalRef(zB.signal);if(bk(zB)){if(EB&&EB.hasOwnProperty(zB))return _B=Rk({},_B,{range:EB[zB]}),XL(_B,kB,wB);"width"===zB?zB=[0,{signal:"width"}]:"height"===zB?zB=qL(_B.type)?[0,{signal:"height"}]:[{signal:"height"},0]:yk("Unrecognized scale range value: "+_k(zB))}else{if(zB.scheme)return wB.scheme=TL(zB.scheme,kB),zB.extent&&(wB.schemeExtent=FL(zB.extent,kB)),void(zB.count&&(wB.schemeCount=TL(zB.count,kB)));if(zB.step)return void(wB.rangeStep=TL(zB.step,kB));if(qL(_B.type)&&!KT(zB))return UL(zB,_B,kB);KT(zB)||yk("Unsupported range type: "+_k(zB))}return zB.map(function(SB){return TL(SB,kB)})}function JL(_B,kB){_B=bk(_B)?{text:_B}:_B;var wB,zB,EB,SB=kB.config.title,CB=Rk({},_B.encode);return wB={orient:null==_B.orient?SB.orient:_B.orient},zB=ZM(kB.add(FW(null,[wB]))),CB.name=_B.name,CB.interactive=_B.interactive,EB=QL(_B,SB,CB,zB),_B.zindex&&(EB.zindex=_B.zindex),OL(EB,kB)}function QL(_B,kB,wB,zB){var EB,SB,CB,OB,RB,DB,AB=_B.text,PB=_B.orient||kB.orient,qB=_B.anchor||kB.anchor,MB=PB===bW||PB===xW?-1:1,LB=PB===xW||PB===kW,TB={group:LB?"width":"height"},FB={};return FB.enter=EB={opacity:{value:0}},LM(EB,"fill",kB.color),LM(EB,"font",kB.font),LM(EB,"fontSize",kB.fontSize),LM(EB,"fontWeight",kB.fontWeight),FB.exit={opacity:{value:0}},FB.update=SB={opacity:{value:1},text:xk(AB)?AB:{value:AB+""},offset:MM(_B.offset||0)},"start"===qB?(RB=0,DB="left"):"end"===qB?(RB=1,DB="right"):(RB=.5,DB="center"),CB={field:TB,mult:RB},OB=0>MB?{value:0}:LB?{field:{group:"height"}}:{field:{group:"width"}},LB?(SB.x=CB,SB.y=OB,SB.angle={value:0},SB.baseline={value:PB===xW?"bottom":"top"}):(SB.x=OB,SB.y=CB,SB.angle={value:90*MB},SB.baseline={value:"bottom"}),SB.align={value:DB},SB.limit={field:TB},LM(SB,"angle",kB.angle),LM(SB,"baseline",kB.baseline),LM(SB,"limit",kB.limit),$M(vW,cW,null,zB,FB,wB)}function KL(_B,kB){var wB=[];_B.transform&&_B.transform.forEach(function(zB){wB.push(oL(zB,kB))}),_B.on&&_B.on.forEach(function(zB){CL(zB,kB,_B.name)}),kB.addDataPipeline(_B.name,ZL(_B,kB,wB))}function ZL(_B,kB,wB){var zB,EB,SB,CB,OB,RB=[],DB=null,AB=!1,PB=!1;for(_B.values?RB.push(DB=eT({$ingest:_B.values,$format:_B.format})):_B.url?RB.push(DB=eT({$request:_B.url,$format:_B.format})):_B.source&&(zB=kB.getData(_B.source),DB=zB.output,RB.push(null)),EB=0,SB=wB.length;EB<SB;++EB)CB=wB[EB],OB=CB.metadata,DB||OB.source||RB.push(DB=eT()),RB.push(CB),OB.generates&&(PB=!0),OB.modifies&&!PB&&(AB=!0),OB.source?DB=CB:OB.changes&&(DB=null);return zB&&(RB[0]=KW({derive:AB,pulse:ZM(zB.output)}),AB&&RB.splice(1,0,eT())),DB||RB.push(eT()),RB.push(tB({})),RB}function eT(_B){var kB=FW({},_B);return kB.metadata={source:!0},kB}function tT(_B,kB){var wB=kB.config,zB=_B.orient,EB=zB===xW||zB===kW?wB.axisX:wB.axisY,SB=wB["axis"+zB[0].toUpperCase()+zB.slice(1)],CB="band"===kB.scaleType(_B.scale)&&wB.axisBand;return EB||SB||CB?Rk({},wB.axis,EB,SB,CB):wB.axis}function aT(_B,kB,wB,zB){var EB,SB,CB,OB,RB,DB=_B.orient,AB={value:0},PB={};return PB.enter=EB={opacity:AB},LM(EB,"stroke",kB.tickColor),LM(EB,"strokeWidth",kB.tickWidth),PB.exit={opacity:AB},PB.update=SB={opacity:{value:1}},DB===xW||DB===kW?(CB="x",RB="y"):(CB="y",RB="x"),OB=CB+"2",EB[RB]=AB,SB[CB]=EB[CB]=nT(_B,0),SB[OB]=EB[OB]=nT(_B,1),$M(hW,tW,null,zB,PB,wB)}function nT(_B,kB){return{scale:_B.scale,range:kB}}function iT(_B,kB,wB,zB){var EB,SB,CB,OB,RB,DB,AB,PB,qB=_B.orient,MB=_B.gridScale,LB=qB===bW||qB===xW?1:-1,TB=LB*_B.offset||0,FB={value:0},IB={};return IB.enter=EB={opacity:FB},LM(EB,"stroke",kB.gridColor),LM(EB,"strokeWidth",kB.gridWidth),LM(EB,"strokeDash",kB.gridDash),IB.exit=SB={opacity:FB},IB.update=CB={},LM(CB,"opacity",kB.gridOpacity),OB={scale:_B.scale,field:RW,band:kB.bandPosition,round:kB.tickRound,extra:kB.tickExtra},qB===xW||qB===kW?(RB="x",DB="y",PB="height"):(RB="y",DB="x",PB="width"),AB=DB+"2",CB[RB]=EB[RB]=SB[RB]=OB,MB?(EB[DB]={scale:MB,range:0,mult:LB,offset:TB},CB[AB]=EB[AB]={scale:MB,range:1,mult:LB,offset:TB}):(EB[DB]={value:TB},CB[AB]=EB[AB]={signal:PB,mult:LB,offset:TB}),$M(hW,aW,RW,zB,IB,wB)}function rT(_B,kB,wB,zB,EB){var SB,CB,OB,RB,DB,AB=_B.orient,PB=AB===bW||AB===xW?-1:1,qB={value:0},MB={};return MB.enter=SB={opacity:qB},LM(SB,"stroke",kB.tickColor),LM(SB,"strokeWidth",kB.tickWidth),MB.exit=CB={opacity:qB},MB.update=OB={opacity:{value:1}},RB=MM(EB),RB.mult=PB,DB={scale:_B.scale,field:RW,band:kB.bandPosition,round:kB.tickRound,extra:kB.tickExtra},AB===xW||AB===kW?(OB.y=SB.y=qB,OB.y2=SB.y2=RB,OB.x=SB.x=CB.x=DB):(OB.x=SB.x=qB,OB.x2=SB.x2=RB,OB.y=SB.y=CB.y=DB),$M(hW,iW,RW,zB,MB,wB)}function dT(_B,kB,wB,zB,EB){var SB,CB,OB,RB,DB,AB=_B.orient,PB=AB===bW||AB===xW?-1:1,qB=null==_B.labelPadding?kB.labelPadding:_B.labelPadding,MB={value:0},LB={};return LB.enter=SB={opacity:MB},LM(SB,"angle",kB.labelAngle),LM(SB,"fill",kB.labelColor),LM(SB,"font",kB.labelFont),LM(SB,"fontSize",kB.labelFontSize),LM(SB,"limit",kB.labelLimit),LB.exit=CB={opacity:MB},LB.update=OB={opacity:{value:1},text:{field:zW}},RB=MM(EB),RB.mult=PB,RB.offset=MM(qB),RB.offset.mult=PB,DB={scale:_B.scale,field:RW,band:.5},AB===xW||AB===kW?(OB.y=SB.y=RB,OB.x=SB.x=CB.x=DB,LM(OB,"align","center"),LM(OB,"baseline",AB===xW?"bottom":"top")):(OB.x=SB.x=RB,OB.y=SB.y=CB.y=DB,LM(OB,"align",AB===_W?"left":"right"),LM(OB,"baseline","middle")),$M(vW,nW,RW,zB,LB,wB)}function oT(_B,kB,wB,zB){var EB,SB,CB,OB=_B.orient,RB=_B.title,DB=OB===bW||OB===xW?-1:1,AB=OB===xW||OB===kW,PB={};return PB.enter=EB={opacity:{value:0}},LM(EB,"align",kB.titleAlign),LM(EB,"fill",kB.titleColor),LM(EB,"font",kB.titleFont),LM(EB,"fontSize",kB.titleFontSize),LM(EB,"fontWeight",kB.titleFontWeight),LM(EB,"limit",kB.titleLimit),PB.exit={opacity:{value:0}},PB.update=SB={opacity:{value:1},text:RB&&RB.signal?{signal:RB.signal}:{value:RB+""}},CB={scale:_B.scale,range:.5},AB?(SB.x=CB,SB.angle={value:0},SB.baseline={value:OB===xW?"bottom":"top"}):(SB.y=CB,SB.angle={value:90*DB},SB.baseline={value:"bottom"}),LM(SB,"angle",kB.titleAngle),LM(SB,"baseline",kB.titleBaseline),!LM(SB,"x",kB.titleX)&&AB&&!UM(wB,"x")&&(PB.enter.auto={value:!0}),!LM(SB,"y",kB.titleY)&&!AB&&!UM(wB,"y")&&(PB.enter.auto={value:!0}),$M(vW,rW,null,zB,PB,wB)}function sT(_B,kB){var wB,zB,EB,SB,CB,OB,RB,DB=tT(_B,kB),AB=_B.name||void 0,PB=_B.encode||{},qB=!!_B.interactive;return wB={orient:_B.orient,ticks:null==_B.ticks?DB.ticks:!!_B.ticks,labels:null==_B.labels?DB.labels:!!_B.labels,grid:null==_B.grid?DB.grid:!!_B.grid,domain:null==_B.domain?DB.domain:!!_B.domain,title:null!=_B.title},zB=ZM(kB.add(FW({},[wB]))),OB=TM({update:{range:{signal:"abs(span(range(\""+_B.scale+"\")))"},offset:MM(_B.offset||0),position:MM(_B.position||0),titlePadding:MM(_B.titlePadding||DB.titlePadding),minExtent:MM(_B.minExtent||DB.minExtent),maxExtent:MM(_B.maxExtent||DB.maxExtent)}},PB.axis),EB=ZM(kB.add(LW({scale:kB.scaleRef(_B.scale),extra:DB.tickExtra,count:kB.property(_B.tickCount),values:kB.property(_B.values),formatSpecifier:kB.property(_B.format)}))),RB=[],wB.grid&&RB.push(iT(_B,DB,PB.grid,EB)),wB.ticks&&(SB=null==_B.tickSize?DB.tickSize:_B.tickSize,RB.push(rT(_B,DB,PB.ticks,EB,SB))),wB.labels&&(SB=wB.ticks?SB:0,RB.push(dT(_B,DB,PB.labels,EB,SB))),wB.domain&&RB.push(aT(_B,DB,PB.domain,zB)),wB.title&&RB.push(oT(_B,DB,PB.title,zB)),CB=VM(eW,AB,zB,qB,OB,RB),_B.zindex&&(CB.zindex=_B.zindex),OL(CB,kB)}function lT(_B,kB,wB){var zB=Ek(_B.signals);return wB||zB.forEach(function(EB){NA(EB,kB)}),Ek(_B.projections).forEach(function(EB){vM(EB,kB)}),Ek(_B.data).forEach(function(EB){KL(EB,kB)}),Ek(_B.scales).forEach(function(EB){LL(EB,kB)}),zB.forEach(function(EB){yM(EB,kB)}),Ek(_B.axes).forEach(function(EB){sT(EB,kB)}),Ek(_B.marks).forEach(function(EB){OL(EB,kB)}),Ek(_B.legends).forEach(function(EB){RL(EB,kB)}),_B.title&&JL(_B.title,kB),kB.parseLambdas(),kB}function uT(_B,kB){var wB,zB,EB,SB,CB,OB=kB.config;return kB.background=_B.background||OB.background,CB=ZM(kB.root=kB.add(KM())),kB.addSignal("width",_B.width||-1),kB.addSignal("height",_B.height||-1),kB.addSignal("padding",$A(_B.padding,OB)),Ek(_B.signals).forEach(function(RB){uB[RB.name]||NA(RB,kB)}),zB=kB.add(FW()),EB=TM({enter:{x:{value:0},y:{value:0}},update:{width:{signal:"width"},height:{signal:"height"}}},_B.encode),EB=kB.add($W(FM(EB,fW,KN,kB,{pulse:ZM(zB)}))),SB=kB.add(nB({layout:kB.objectProperty(_B.layout),legendMargin:OB.legendMargin,autosize:UA(_B.autosize,OB),mark:CB,pulse:ZM(EB)})),kB.operators.pop(),kB.pushState(ZM(EB),ZM(SB),null),lT(_B,kB,!0),kB.operators.push(SB),wB=kB.add(TW({mark:CB,pulse:ZM(SB)})),wB=kB.add(ZW({pulse:ZM(wB)})),wB=kB.add(tB({pulse:ZM(wB)})),kB.addData("root",new _L(kB,zB,zB,wB)),kB}function pT(_B){this.config=_B,this.bindings=[],this.field={},this.signals={},this.lambdas={},this.scales={},this.events={},this.data={},this.streams=[],this.updates=[],this.operators=[],this.background=null,this._id=0,this._subid=0,this._nextsub=[0],this._parent=[],this._encode=[],this._lookup=[],this._markpath=[]}function cT(_B){this.config=_B.config,this.field=Object.create(_B.field),this.signals=Object.create(_B.signals),this.lambdas=Object.create(_B.lambdas),this.scales=Object.create(_B.scales),this.events=Object.create(_B.events),this.data=Object.create(_B.data),this.streams=[],this.updates=[],this.operators=[],this._id=0,this._subid=++_B._nextsub[0],this._nextsub=_B._nextsub,this._parent=_B._parent.slice(),this._encode=_B._encode.slice(),this._lookup=_B._lookup.slice(),this._markpath=_B._markpath}function mT(_B){var kB,wB,zB="{",EB=0;for(kB in _B)wB=_B[kB],zB+=(1<++EB?",":"")+_k(kB)+":"+(xk(wB)?wB.signal||mT(wB):_k(wB));return zB+"}"}function fT(_B){var kB,wB=gT();for(kB in _B)wB[kB]=xk(wB[kB])?Rk(wB[kB],_B[kB]):wB[kB]=_B[kB];return wB}function gT(){return{padding:0,autosize:"pad",background:null,group:null,mark:null,arc:{fill:fB},area:{fill:fB},image:null,line:{stroke:fB,strokeWidth:mB},path:{stroke:fB},rect:{fill:fB},rule:{stroke:gB},shape:{stroke:fB},symbol:{fill:fB,size:64},text:{fill:gB,font:"sans-serif",fontSize:11},point:{size:cB,strokeWidth:mB,shape:"circle"},circle:{size:cB,strokeWidth:mB},square:{size:cB,strokeWidth:mB},axis:{minExtent:0,maxExtent:200,bandPosition:.5,domain:!0,domainWidth:1,domainColor:gB,grid:!1,gridWidth:1,gridColor:yB,gridDash:[],gridOpacity:1,labels:!0,labelAngle:0,labelColor:gB,labelFont:"sans-serif",labelFontSize:10,labelPadding:2,labelLimit:180,ticks:!0,tickRound:!0,tickSize:5,tickWidth:1,tickColor:gB,titleAlign:"center",titlePadding:2,titleColor:gB,titleFont:"sans-serif",titleFontSize:11,titleFontWeight:"bold"},legend:{orient:"right",offset:18,padding:0,entryPadding:5,titlePadding:5,gradientWidth:100,gradientHeight:20,gradientStrokeColor:yB,gradientStrokeWidth:0,gradientLabelBaseline:"top",gradientLabelOffset:2,labelColor:gB,labelFontSize:10,labelFont:"sans-serif",labelAlign:"left",labelBaseline:"middle",labelOffset:8,labelLimit:160,symbolType:"circle",symbolSize:100,symbolColor:hB,symbolStrokeWidth:1.5,titleColor:gB,titleFont:"sans-serif",titleFontSize:11,titleFontWeight:"bold",titleAlign:"left",titleBaseline:"top",titleLimit:180},title:{orient:"top",anchor:"middle",offset:2,color:gB,font:"sans-serif",fontSize:13,fontWeight:"bold"},range:{category:{scheme:"tableau10"},ordinal:{scheme:"blues",extent:[0.2,1]},heatmap:{scheme:"viridis"},ramp:{scheme:"blues",extent:[0.2,1]},diverging:{scheme:"blueorange"},symbol:["circle","square","triangle-up","cross","diamond","triangle-right","triangle-down","triangle-left"]}}}function yT(_B,kB,wB){";"!==kB[kB.length-1]&&(kB="return("+kB+");");var zB=Function.apply(null,_B.concat(kB));return wB&&wB.functions?zB.bind(wB.functions):zB}function vT(_B,kB){return yT(["_"],_B,kB)}function xT(_B,kB){return yT(["datum","_"],_B,kB)}function bT(_B,kB){return yT(["event"],_B,kB)}function _T(_B,kB){return yT(["_","event"],_B,kB)}function kT(_B,kB){return yT(["item","_"],_B,kB)}function wT(_B,kB,wB){wB=wB||{};var zB,EB;for(zB in _B)EB=_B[zB],EB&&EB.$expr&&EB.$params&&wT(EB.$params,kB,wB),wB[zB]=KT(EB)?EB.map(function(SB){return zT(SB,kB)}):zT(EB,kB);return wB}function zT(_B,kB){if(!_B||!xk(_B))return _B;for(var wB,zB=0,EB=vB.length;zB<EB;++zB)if(wB=vB[zB],_B.hasOwnProperty(wB.key))return wB.parse(_B,kB);return _B}function qT(_B,kB){"Operator"!==_B.type&&_B.type?kB.transform(_B,_B.type):kB.operator(_B,_B.update?vT(_B.update,kB):null)}function MT(_B,kB){var wB,zB;_B.params&&((wB=kB.get(_B.id))||yk("Invalid operator id: "+_B.id),zB=wT(_B.params,kB),kB.dataflow.connect(wB,wB.parameters(zB)))}function LT(_B,kB){var wB,zB=null==_B.filter?void 0:bT(_B.filter,kB),EB=null==_B.stream?void 0:kB.get(_B.stream);_B.source?EB=kB.events(_B.source,_B.type,zB):_B.merge&&(wB=_B.merge.map(kB.get.bind(kB)),EB=wB[0].merge.apply(wB[0],wB.slice(1))),_B.between&&(wB=_B.between.map(kB.get.bind(kB)),EB=EB.between(wB[0],wB[1])),_B.filter&&(EB=EB.filter(zB)),null!=_B.throttle&&(EB=EB.throttle(+_B.throttle)),null!=_B.debounce&&(EB=EB.debounce(+_B.debounce)),null==EB&&yk("Invalid stream definition: "+JSON.stringify(_B)),_B.consume&&EB.consume(!0),kB.stream(_B,EB)}function TT(_B,kB){var wB=kB.get(_B.source),zB=null,EB=_B.update,SB;wB||yk("Source not defined: "+_B.source),zB=_B.target&&_B.target.$expr?bT(_B.target.$expr,kB):kB.get(_B.target),EB&&EB.$expr&&(EB.$params&&(SB=wT(EB.$params,kB)),EB=_T(EB.$expr,kB)),kB.update(_B,wB,zB,EB,SB)}function FT(_B,kB){var wB=_B.operators||[];return _B.background&&(kB.background=_B.background),wB.forEach(function(zB){qT(zB,kB)}),wB.forEach(function(zB){MT(zB,kB)}),(_B.streams||[]).forEach(function(zB){LT(zB,kB)}),(_B.updates||[]).forEach(function(zB){TT(zB,kB)}),kB.resolve()}function $T(_B,kB,wB){return new jT(_B,kB,wB)}function jT(_B,kB,wB){this.dataflow=_B,this.transforms=kB,this.events=_B.events.bind(_B),this.signals={},this.scales={},this.nodes={},this.data={},this.fn={},wB&&(this.functions=Object.create(wB),this.functions.context=this)}function NT(_B){this.dataflow=_B.dataflow,this.transforms=_B.transforms,this.functions=_B.functions,this.events=_B.events,this.signals=Object.create(_B.signals),this.scales=Object.create(_B.scales),this.nodes=Object.create(_B.nodes),this.data=Object.create(_B.data),this.fn=Object.create(_B.fn),_B.functions&&(this.functions=Object.create(_B.functions),this.functions.context=this)}function WT(_B,kB,wB){return FT(kB,$T(_B,eU,wB||EN))}function BT(_B,kB){var wB=_B.add(null,function(zB){_B["_"+kB]=zB.size,_B._autosize=_B._resize=1},{size:_B._signals[kB]});return wB.rank=0,wB}function HT(_B,kB){return kB.modified&&KT(kB.input.value)&&_B.indexOf("_:vega:_")}function YT(_B,kB){return!("parent"===_B||kB instanceof eU.Proxy)}function JT(_B,kB){kB=kB||{},BS.call(this),this.loader(kB.loader||this._loader),this.logLevel(kB.logLevel||0),this._el=null,this._renderType=kB.renderer||LI.Canvas,this._scenegraph=new EE;var wB=this._scenegraph.root;this._renderer=null,this._queue=null,this._handler=new DE().scene(wB),this._eventListeners=[],this._preventDefault=!0;var zB=WT(this,_B,kB.functions);this._runtime=zB,this._signals=zB.signals,this._bind=(_B.bindings||[]).map(function(EB){return{state:null,param:Rk({},EB)}}),zB.root&&zB.root.set(wB),wB.source=zB.data.root.input,this.pulse(zB.data.root.input,this.changeset().insert(wB.items)),this._background=zB.background||null,this._width=this.width(),this._height=this.height(),this._origin=[0,0],this._resize=0,this._autosize=1,this._resizeWidth=BT(this,"width"),this._resizeHeight=BT(this,"height"),aA(this)}function QT(_B,kB){return _B._signals.hasOwnProperty(kB)?_B._signals[kB]:_B.error("Unrecognized signal name: "+_k(kB))}var KT=Array.isArray,ZT=[],eF=kk("id"),tF=fk(function(_B){return _B},ZT,"identity"),aF=fk(function(){return 0},ZT,"zero"),nF=fk(function(){return 1},ZT,"one"),iF=fk(function(){return!0},ZT,"true"),rF=fk(function(){return!1},ZT,"false"),dF=0,oF=1,sF=2,lF=3,uF={},pF=/^([A-Za-z]+:)?\/\//,cF="file://",mF=["mimeType","responseType","user","password"],fF={boolean:Nk,integer:Bk,number:Bk,date:Wk,string:Gk},gF=[function(_B){return"true"===_B||"false"===_B||!0===_B||!1===_B},function(_B){return sw(_B)&&(_B=+_B)==~~_B},sw,function(_B){return!isNaN(Date.parse(_B))}],hF=["boolean","integer","number","date"],yF={dsv:pw,csv:uw(","),tsv:uw("\t"),json:mw,topojson:function(_B,kB){var wB,zB;return _B=mw(_B,kB),kB&&(zB=kB.feature)?(wB=_B.objects[zB])?W_.feature(_B,wB).features:yk("Invalid TopoJSON object: "+zB):kB&&(zB=kB.mesh)?(wB=_B.objects[zB])?[W_.mesh(_B,wB)]:yk("Invalid TopoJSON object: "+zB):void yk("Missing TopoJSON feature or mesh parameter.")}},vF=xw.prototype;vF.clone=function(){return new xw(this)},vF.clear=function(){return this.x1=+Number.MAX_VALUE,this.y1=+Number.MAX_VALUE,this.x2=-Number.MAX_VALUE,this.y2=-Number.MAX_VALUE,this},vF.set=function(_B,kB,wB,zB){return wB<_B?(this.x2=_B,this.x1=wB):(this.x1=_B,this.x2=wB),zB<kB?(this.y2=kB,this.y1=zB):(this.y1=kB,this.y2=zB),this},vF.add=function(_B,kB){return _B<this.x1&&(this.x1=_B),kB<this.y1&&(this.y1=kB),_B>this.x2&&(this.x2=_B),kB>this.y2&&(this.y2=kB),this},vF.expand=function(_B){return this.x1-=_B,this.y1-=_B,this.x2+=_B,this.y2+=_B,this},vF.round=function(){return this.x1=Math.floor(this.x1),this.y1=Math.floor(this.y1),this.x2=Math.ceil(this.x2),this.y2=Math.ceil(this.y2),this},vF.translate=function(_B,kB){return this.x1+=_B,this.x2+=_B,this.y1+=kB,this.y2+=kB,this},vF.rotate=function(_B,kB,wB){var zB=Math.cos(_B),EB=Math.sin(_B),SB=kB-kB*zB+wB*EB,CB=wB-kB*EB-wB*zB,OB=this.x1,RB=this.x2,DB=this.y1,AB=this.y2;return this.clear().add(zB*OB-EB*DB+SB,EB*OB+zB*DB+CB).add(zB*OB-EB*AB+SB,EB*OB+zB*AB+CB).add(zB*RB-EB*DB+SB,EB*RB+zB*DB+CB).add(zB*RB-EB*AB+SB,EB*RB+zB*AB+CB)},vF.union=function(_B){return _B.x1<this.x1&&(this.x1=_B.x1),_B.y1<this.y1&&(this.y1=_B.y1),_B.x2>this.x2&&(this.x2=_B.x2),_B.y2>this.y2&&(this.y2=_B.y2),this},vF.intersect=function(_B){return _B.x1>this.x1&&(this.x1=_B.x1),_B.y1>this.y1&&(this.y1=_B.y1),_B.x2<this.x2&&(this.x2=_B.x2),_B.y2<this.y2&&(this.y2=_B.y2),this},vF.encloses=function(_B){return _B&&this.x1<=_B.x1&&this.x2>=_B.x2&&this.y1<=_B.y1&&this.y2>=_B.y2},vF.alignsWith=function(_B){return _B&&(this.x1==_B.x1||this.x2==_B.x2||this.y1==_B.y1||this.y2==_B.y2)},vF.intersects=function(_B){return _B&&!(this.x2<_B.x1||this.x1>_B.x2||this.y2<_B.y1||this.y1>_B.y2)},vF.contains=function(_B,kB){return!(_B<this.x1||_B>this.x2||kB<this.y1||kB>this.y2)},vF.width=function(){return this.x2-this.x1},vF.height=function(){return this.y2-this.y1};var xF=0;Pk(kw,_w);var bF;try{bF=require("canvas")}catch(_B){bF=null}var _F="undefined"==typeof Image?bF&&bF.Image||null:Image,kF=Rw.prototype;kF.pending=function(){return this._pending},kF.sanitizeURL=function(_B){var kB=this;return Dw(kB),kB._loader.sanitize(_B,{context:"href"}).then(function(wB){return Aw(kB),wB}).catch(function(){return Aw(kB),null})},kF.loadImage=function(_B){var kB=this;return Dw(kB),kB._loader.sanitize(_B,{context:"image"}).then(function(wB){var zB=wB.href;if(!zB||!_F)throw"Image unsupported.";var EB=new _F;return EB.onload=function(){Aw(kB),EB.loaded=!0},EB.onerror=function(){Aw(kB),EB.loaded=!1},EB.src=zB,EB}).catch(function(){return Aw(kB),{loaded:!1,width:0,height:0}})},kF.ready=function(){var _B=this;return new Promise(function(kB){function wB(zB){_B.pending()?setTimeout(function(){wB(!0)},10):kB(zB)}wB(!1)})};var wF,zF={basis:{curve:G_.curveBasis},"basis-closed":{curve:G_.curveBasisClosed},"basis-open":{curve:G_.curveBasisOpen},bundle:{curve:G_.curveBundle,tension:"beta",value:.85},cardinal:{curve:G_.curveCardinal,tension:"tension",value:0},"cardinal-open":{curve:G_.curveCardinalOpen,tension:"tension",value:0},"cardinal-closed":{curve:G_.curveCardinalClosed,tension:"tension",value:0},"catmull-rom":{curve:G_.curveCatmullRom,tension:"alpha",value:.5},"catmull-rom-closed":{curve:G_.curveCatmullRomClosed,tension:"alpha",value:.5},"catmull-rom-open":{curve:G_.curveCatmullRomOpen,tension:"alpha",value:.5},linear:{curve:G_.curveLinear},"linear-closed":{curve:G_.curveLinearClosed},monotone:{horizontal:G_.curveMonotoneY,vertical:G_.curveMonotoneX},natural:{curve:G_.curveNatural},step:{curve:G_.curveStep},"step-after":{curve:G_.curveStepAfter},"step-before":{curve:G_.curveStepBefore}},EF={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7},SF=[/([MLHVCSQTAZmlhvcsqtaz])/g,/###/,/(\d)([-+])/g,/\s|,|###/],CF={},OF={},RF=[].join,DF=["l",0,0,0,0,0,0,0],AF=2*Math.PI,PF=Math.sqrt(3)/2,qF={circle:{draw:function(kB,wB){var zB=Math.sqrt(wB)/2;kB.moveTo(zB,0),kB.arc(0,0,zB,0,AF)}},cross:{draw:function(kB,wB){var zB=Math.sqrt(wB)/2,EB=zB/2.5;kB.moveTo(-zB,-EB),kB.lineTo(-zB,EB),kB.lineTo(-EB,EB),kB.lineTo(-EB,zB),kB.lineTo(EB,zB),kB.lineTo(EB,EB),kB.lineTo(zB,EB),kB.lineTo(zB,-EB),kB.lineTo(EB,-EB),kB.lineTo(EB,-zB),kB.lineTo(-EB,-zB),kB.lineTo(-EB,-EB),kB.closePath()}},diamond:{draw:function(kB,wB){var zB=Math.sqrt(wB)/2;kB.moveTo(-zB,0),kB.lineTo(0,-zB),kB.lineTo(zB,0),kB.lineTo(0,zB),kB.closePath()}},square:{draw:function(kB,wB){var zB=Math.sqrt(wB),EB=-zB/2;kB.rect(EB,EB,zB,zB)}},"triangle-up":{draw:function(kB,wB){var zB=Math.sqrt(wB)/2,EB=PF*zB;kB.moveTo(0,-EB),kB.lineTo(-zB,EB),kB.lineTo(zB,EB),kB.closePath()}},"triangle-down":{draw:function(kB,wB){var zB=Math.sqrt(wB)/2,EB=PF*zB;kB.moveTo(0,EB),kB.lineTo(-zB,-EB),kB.lineTo(zB,-EB),kB.closePath()}},"triangle-right":{draw:function(kB,wB){var zB=Math.sqrt(wB)/2,EB=PF*zB;kB.moveTo(EB,0),kB.lineTo(-EB,-zB),kB.lineTo(-EB,zB),kB.closePath()}},"triangle-left":{draw:function(kB,wB){var zB=Math.sqrt(wB)/2,EB=PF*zB;kB.moveTo(-EB,0),kB.lineTo(EB,-zB),kB.lineTo(EB,zB),kB.closePath()}}},MF={},LF=Math.PI,TF=G_.arc().cornerRadius(tz).padAngle(function(_B){return _B.padAngle||0}),FF=G_.area().x(Yw).y1(Xw).y0(function(_B){return(_B.y||0)+(_B.height||0)}).defined(nz),IF=G_.area().y(Xw).x1(Yw).x0(function(_B){return(_B.x||0)+(_B.width||0)}).defined(nz),UF=G_.line().x(Yw).y(Xw).defined(nz),$F=Vw().x(Yw).y(Xw).width(function(_B){return _B.width||0}).height(function(_B){return _B.height||0}).cornerRadius(tz),jF=G_.symbol().type(function(_B){return Uw(_B.shape||"circle")}).size(function(_B){return null==_B.size?64:_B.size}),NF=Hw().x(Yw).y(Xw).defined(nz).size(function(_B){return _B.size||1}),WF=2*Math.PI,BF=WF/4;fz.beginPath=gz,fz.closePath=gz,fz.moveTo=hz,fz.lineTo=hz,fz.rect=function(_B,kB,wB,zB){hz(_B,kB),hz(_B+wB,kB+zB)},fz.quadraticCurveTo=function(_B,kB,wB,zB){hz(_B,kB),hz(wB,zB)},fz.bezierCurveTo=function(_B,kB,wB,zB,EB,SB){hz(_B,kB),hz(wB,zB),hz(EB,SB)},fz.arc=function(_B,kB,wB,zB,EB,SB){function CB(TB){DB=wB*Math.cos(TB),AB=wB*Math.sin(TB),DB<PB&&(PB=DB),DB>qB&&(qB=DB),AB<MB&&(MB=AB),AB>LB&&(LB=AB)}if(Math.abs(EB-zB)>WF-1e-8)return hz(_B-wB,kB-wB),void hz(_B+wB,kB+wB);var OB,RB,DB,AB,PB=1/0,qB=-1/0,MB=1/0,LB=-1/0;if(CB(zB),CB(EB),EB!==zB)if(zB%=WF,0>zB&&(zB+=WF),EB%=WF,0>EB&&(EB+=WF),EB<zB&&(SB=!SB,OB=zB,zB=EB,EB=OB),SB)for(EB-=WF,OB=zB-zB%BF,RB=0;3>RB&&OB>EB;++RB,OB-=BF)CB(OB);else for(OB=zB-zB%BF+BF,RB=0;3>RB&&OB<EB;++RB,OB+=BF)CB(OB);hz(_B+PB,kB+MB),hz(_B+qB,kB+LB)};var VF,HF,YF=[],XF=function(){return!0},JF=qz("arc",function(_B,kB){return TF.context(_B)(kB)}),QF=Mz("area",function(_B,kB){var wB=kB[0],zB=wB.interpolate||"linear";return("horizontal"===wB.orient?IF:FF).curve(Pw(zB,wB.orient,wB.tension)).context(_B)(kB)}),ZF={type:"image",tag:"image",nested:!1,attr:function(_B,kB,wB){var zB=Wz(kB,wB),EB=kB.x||0,SB=kB.y||0,CB=(null==kB.width?zB.width:kB.width)||0,OB=(null==kB.height?zB.height:kB.height)||0,RB=!1===kB.aspect?"none":"xMidYMid";EB-=Bz(kB.align,CB),SB-=Gz(kB.baseline,OB),_B("href",zB.src||"","http://www.w3.org/1999/xlink","xlink:href"),_B("transform",Az(EB,SB)),_B("width",CB),_B("height",OB),_B("preserveAspectRatio",RB)},bound:function(_B,kB){var wB=kB.image,zB=kB.x||0,EB=kB.y||0,SB=(null==kB.width?wB&&wB.width:kB.width)||0,CB=(null==kB.height?wB&&wB.height:kB.height)||0;return zB-=Bz(kB.align,SB),EB-=Gz(kB.baseline,CB),_B.set(zB,EB,zB+SB,EB+CB)},draw:function(_B,kB,wB){var zB=this;wz(kB,function(EB){if(!wB||wB.intersects(EB.bounds)){var SB,CB,OB,RB,DB=Wz(EB,zB),AB=EB.x||0,PB=EB.y||0,qB=(null==EB.width?DB.width:EB.width)||0,MB=(null==EB.height?DB.height:EB.height)||0;AB-=Bz(EB.align,qB),PB-=Gz(EB.baseline,MB),!1!==EB.aspect&&(CB=DB.width/DB.height,OB=EB.width/EB.height,CB===CB&&OB===OB&&CB!==OB&&(OB<CB?(RB=qB/CB,PB+=(MB-RB)/2,MB=RB):(RB=MB*CB,AB+=(qB-RB)/2,qB=RB))),DB.loaded&&(_B.globalAlpha=null==(SB=EB.opacity)?1:SB,_B.drawImage(DB,AB,PB,qB,MB))}})},pick:Oz(),get:Wz,xOffset:Bz,yOffset:Gz},eI=Mz("line",function(_B,kB){var wB=kB[0],zB=wB.interpolate||"linear";return UF.curve(Pw(zB,wB.orient,wB.tension)).context(_B)(kB)}),tI={type:"path",tag:"path",nested:!1,attr:function(_B,kB){_B("transform",Pz(kB)),_B("d",kB.path)},bound:function(_B,kB){return Jz(fz(_B),kB)?_B.set(0,0,0,0):mz(_B,kB)},draw:Ez(Jz),pick:Dz(Jz)},aI={type:"rect",tag:"path",nested:!1,attr:function(_B,kB){_B("d",lz(null,kB))},bound:function(_B,kB){var wB,zB;return mz(_B.set(wB=kB.x||0,zB=kB.y||0,wB+kB.width||0,zB+kB.height||0),kB)},draw:Ez(eE),pick:Dz(eE)},nI={type:"rule",tag:"line",nested:!1,attr:function(_B,kB){_B("transform",Pz(kB)),_B("x2",null==kB.x2?0:kB.x2-(kB.x||0)),_B("y2",null==kB.y2?0:kB.y2-(kB.y||0))},bound:function(_B,kB){var wB,zB;return mz(_B.set(wB=kB.x||0,zB=kB.y||0,null==kB.x2?wB:kB.x2,null==kB.y2?zB:kB.y2),kB)},draw:function(_B,kB,wB){wz(kB,function(zB){if(!wB||wB.intersects(zB.bounds)){var EB=null==zB.opacity?1:zB.opacity;EB&&nE(_B,zB,EB)&&_B.stroke()}})},pick:Oz(function(_B,kB,wB,zB){return!!_B.isPointInStroke&&nE(_B,kB,1)&&_B.isPointInStroke(wB,zB)})},iI=qz("shape",function(_B,kB){return(kB.mark.shape||kB.shape).context(_B)(kB)}),rI=qz("symbol",function(_B,kB){return jF.context(_B)(kB)}),dI={height:uE,measureWidth:sE,estimateWidth:dE,width:dE,canvas:pE};pE(!0);var oI={left:"start",center:"middle",right:"end"},sI=new xw,lI={type:"text",tag:"text",nested:!1,attr:function(_B,kB){var wB,zB=kB.dx||0,EB=(kB.dy||0)+gE(kB),SB=kB.x||0,CB=kB.y||0,OB=kB.angle||0,RB=kB.radius||0;RB&&(wB=(kB.theta||0)-Math.PI/2,SB+=RB*Math.cos(wB),CB+=RB*Math.sin(wB)),_B("text-anchor",oI[kB.align]||"start"),OB?(wB=Az(SB,CB)+" rotate("+OB+")",(zB||EB)&&(wB+=" "+Az(zB,EB))):wB=Az(SB+zB,CB+EB),_B("transform",wB)},bound:yE,draw:function(_B,kB,wB){wz(kB,function(zB){var EB,SB,CB,OB,RB,DB;wB&&!wB.intersects(zB.bounds)||(DB=cE(zB))&&0!==(EB=null==zB.opacity?1:zB.opacity)&&(_B.font=fE(zB),_B.textAlign=zB.align||"left",SB=zB.x||0,CB=zB.y||0,(OB=zB.radius)&&(RB=(zB.theta||0)-Math.PI/2,SB+=OB*Math.cos(RB),CB+=OB*Math.sin(RB)),zB.angle&&(_B.save(),_B.translate(SB,CB),_B.rotate(zB.angle*Math.PI/180),SB=CB=0),SB+=zB.dx||0,CB+=(zB.dy||0)+gE(zB),zB.fill&&xz(_B,zB,EB)&&_B.fillText(DB,SB,CB),zB.stroke&&bz(_B,zB,EB)&&_B.strokeText(DB,SB,CB),zB.angle&&_B.restore())})},pick:Oz(function(_B,kB,wB,zB,EB,SB){if(0>=kB.fontSize)return!1;if(!kB.angle)return!0;var CB=yE(sI,kB,!0),OB=-kB.angle*Math.PI/180,RB=Math.cos(OB),DB=Math.sin(OB),AB=kB.x,PB=kB.y;return CB.contains(RB*EB-DB*SB+(AB-AB*RB+PB*DB),DB*EB+RB*SB+(PB-AB*DB-PB*RB))})},uI=Mz("trail",function(_B,kB){return NF.context(_B)(kB)}),pI={arc:JF,area:QF,group:{type:"group",tag:"g",nested:!1,attr:function(_B,kB){_B("transform",Pz(kB))},bound:function(_B,kB){if(!kB.clip&&kB.items)for(var wB=kB.items,zB=0,EB=wB.length;zB<EB;++zB)_B.union(wB[zB].bounds);return(kB.clip||kB.width||kB.height)&&mz(_B.add(0,0).add(kB.width||0,kB.height||0),kB),_B.translate(kB.x||0,kB.y||0)},draw:function(_B,kB,wB){var zB=this;wz(kB,function(EB){var SB,CB,OB=EB.x||0,RB=EB.y||0,DB=EB.width||0,AB=EB.height||0;_B.save(),_B.translate(OB,RB),(EB.stroke||EB.fill)&&0<(CB=null==EB.opacity?1:EB.opacity)&&(_B.beginPath(),SB=EB.stroke?.5:0,lz(_B,EB,SB,SB),EB.fill&&xz(_B,EB,CB)&&_B.fill(),EB.stroke&&bz(_B,EB,CB)&&_B.stroke()),EB.clip&&(_B.beginPath(),_B.rect(0,0,DB,AB),_B.clip()),wB&&wB.translate(-OB,-RB),wz(EB,function(PB){zB.draw(_B,PB,wB)}),wB&&wB.translate(OB,RB),_B.restore()})},pick:function(_B,kB,wB,zB,EB,SB){if(kB.bounds&&!kB.bounds.contains(EB,SB)||!kB.items)return null;var CB=this;return zz(kB,function(OB){var RB,DB,AB,PB;if(!(PB=OB.bounds)||PB.contains(EB,SB))return DB=OB.x||0,AB=OB.y||0,_B.save(),_B.translate(DB,AB),DB=EB-DB,AB=SB-AB,RB=zz(OB,function(qB){return Nz(qB,DB,AB)?CB.pick(qB,wB,zB,DB,AB):null}),_B.restore(),RB||(RB=!1!==kB.interactive&&(OB.fill||OB.stroke)&&0<=DB&&DB<=OB.width&&0<=AB&&AB<=OB.height,RB?OB:null)})},background:function(_B,kB){var wB=kB.stroke?.5:0;_B("class","background"),_B("d",lz(null,kB,wB,wB))},foreground:function(_B,kB,wB){_B("clip-path",kB.clip?Lz(wB,kB,kB):null)}},image:ZF,line:eI,path:tI,rect:aI,rule:nI,shape:iI,symbol:rI,text:lI,trail:uI},cI={mark:null},mI=["marktype","name","role","interactive","clip","items","zindex","x","y","width","height","align","baseline","fill","fillOpacity","opacity","stroke","strokeOpacity","strokeWidth","strokeCap","strokeDash","strokeDashOffset","startAngle","endAngle","innerRadius","outerRadius","cornerRadius","padAngle","interpolate","tension","orient","defined","url","path","x2","y2","size","shape","text","angle","theta","radius","dx","dy","font","fontSize","fontWeight","fontStyle","fontVariant"],fI=EE.prototype;fI.toJSON=function(_B){return kE(this.root,_B||0)},fI.mark=function(_B,kB,wB){kB=kB||this.root.items[0];var zB=SE(_B,kB);return kB.items[wB]=zB,zB.zindex&&(zB.group.zdirty=!0),zB};var gI=CE.prototype;gI.initialize=function(_B,kB,wB){return this._el=_B,this._obj=wB||null,this.origin(kB)},gI.element=function(){return this._el},gI.origin=function(_B){return this._origin=_B||[0,0],this},gI.scene=function(_B){return arguments.length?(this._scene=_B,this):this._scene},gI.on=function(){},gI.off=function(){},gI.handlers=function(){var _B,kB=this._handlers,wB=[];for(_B in kB)wB.push.apply(wB,kB[_B]);return wB},gI.eventName=function(_B){var kB=_B.indexOf(".");return 0>kB?_B:_B.slice(0,kB)},gI.handleHref=function(_B,kB,wB){this._loader.sanitize(wB,{context:"href"}).then(function(zB){var EB=new MouseEvent(_B.type,_B),SB=ww(null,"a");for(var CB in zB)SB.setAttribute(CB,zB[CB]);SB.dispatchEvent(EB)}).catch(function(){})},gI.handleTooltip=function(_B,kB,wB){this._el.setAttribute("title",wB||"")};var hI=OE.prototype;hI.initialize=function(_B,kB,wB,zB){return this._el=_B,this.resize(kB,wB,zB)},hI.element=function(){return this._el},hI.scene=function(){return this._el&&this._el.firstChild},hI.background=function(_B){return 0===arguments.length?this._bgcolor:(this._bgcolor=_B,this)},hI.resize=function(_B,kB,wB){return this._width=_B,this._height=kB,this._origin=wB||[0,0],this},hI.render=function(_B,kB){var wB=this;return wB._call=function(){wB._render(_B,kB)},wB._call(),wB._call=null,wB},hI._render=function(){},hI.renderAsync=function(_B,kB){var wB=this.render(_B,kB);return this._ready?this._ready.then(function(){return wB}):Promise.resolve(wB)},hI._load=function(_B,kB){var wB=this,zB=wB._loader[_B](kB);if(!wB._ready){var EB=wB._call;wB._ready=wB._loader.ready().then(function(SB){SB&&EB(),wB._ready=null})}return zB},hI.sanitizeURL=function(_B){return this._load("sanitizeURL",_B)},hI.loadImage=function(_B){return this._load("loadImage",_B)};var yI=Pk(DE,CE);yI.initialize=function(_B,kB,wB){var zB=this._canvas=_B&&zw(_B,"canvas");if(zB){var EB=this;this.events.forEach(function(SB){zB.addEventListener(SB,function(CB){yI[SB]?yI[SB].call(EB,CB):EB.fire(SB,CB)})})}return CE.prototype.initialize.call(this,_B,kB,wB)},yI.canvas=function(){return this._canvas},yI.context=function(){return this._canvas.getContext("2d")},yI.events=["keydown","keypress","keyup","dragenter","dragleave","dragover","mousedown","mouseup","mousemove","mouseout","mouseover","click","dblclick","wheel","mousewheel","touchstart","touchmove","touchend"],yI.DOMMouseScroll=function(_B){this.fire("mousewheel",_B)},yI.mousemove=AE("mousemove","mouseover","mouseout"),yI.dragover=AE("dragover","dragenter","dragleave"),yI.mouseout=PE("mouseout"),yI.dragleave=PE("dragleave"),yI.mousedown=function(_B){this._down=this._active,this.fire("mousedown",_B)},yI.click=function(_B){this._down===this._active&&(this.fire("click",_B),this._down=null)},yI.touchstart=function(_B){this._touch=this.pickEvent(_B.changedTouches[0]),this._first&&(this._active=this._touch,this._first=!1),this.fire("touchstart",_B,!0)},yI.touchmove=function(_B){this.fire("touchmove",_B,!0)},yI.touchend=function(_B){this.fire("touchend",_B,!0),this._touch=null},yI.fire=function(_B,kB,wB){var zB,EB,SB=wB?this._touch:this._active,CB=this._handlers[_B];if("click"===_B&&SB&&SB.href?this.handleHref(kB,SB,SB.href):("mouseover"===_B||"mouseout"===_B)&&SB&&SB.tooltip&&this.handleTooltip(kB,SB,"mouseover"===_B?SB.tooltip:null),CB)for(kB.vegaType=_B,zB=0,EB=CB.length;zB<EB;++zB)CB[zB].handler.call(this._obj,kB,SB)},yI.on=function(_B,kB){var wB=this.eventName(_B),zB=this._handlers;return(zB[wB]||(zB[wB]=[])).push({type:_B,handler:kB}),this},yI.off=function(_B,kB){var wB,zB=this.eventName(_B),EB=this._handlers[zB];if(EB){for(wB=EB.length;0<=--wB;)EB[wB].type===_B&&(kB&&EB[wB].handler!==kB||EB.splice(wB,1));return this}},yI.pickEvent=function(_B){var kB=RE(_B,this._canvas),wB=this._origin;return this.pick(this._scene,kB[0],kB[1],kB[0]-wB[0],kB[1]-wB[1])},yI.pick=function(_B,kB,wB,zB,EB){var SB=this.context();return pI[_B.marktype].pick.call(this,SB,_B,kB,wB,zB,EB)};var vI="undefined"==typeof window?1:window.devicePixelRatio||1,xI=Pk(LE,OE),bI=OE.prototype,_I=new xw;xI.initialize=function(_B,kB,wB,zB){return this._canvas=Ow(1,1),_B&&(Sw(_B,0).appendChild(this._canvas),this._canvas.setAttribute("class","marks")),bI.initialize.call(this,_B,kB,wB,zB)},xI.resize=function(_B,kB,wB){return bI.resize.call(this,_B,kB,wB),ME(this._canvas,this._width,this._height,this._origin),this._redraw=!0,this},xI.canvas=function(){return this._canvas},xI.context=function(){return this._canvas?this._canvas.getContext("2d"):null},xI._render=function(_B,kB){var wB,zB=this.context(),EB=this._origin,SB=this._width,CB=this._height;return zB.save(),wB=!kB||this._redraw?(this._redraw=!1,null):TE(zB,kB),this.clear(-EB[0],-EB[1],SB,CB),this.draw(zB,_B,wB),zB.restore(),this},xI.draw=function(_B,kB,wB){var zB=pI[kB.marktype];kB.clip&&qE(_B,kB),zB.draw.call(this,_B,kB,wB),kB.clip&&_B.restore()},xI.clear=function(_B,kB,wB,zB){var EB=this.context();EB.clearRect(_B,kB,wB,zB),null!=this._bgcolor&&(EB.fillStyle=this._bgcolor,EB.fillRect(_B,kB,wB,zB))};var kI=Pk(IE,CE);kI.initialize=function(_B,kB,wB){var zB=this._svg;return zB&&(zB.removeEventListener("click",this._hrefHandler),zB.removeEventListener("mouseover",this._tooltipHandler),zB.removeEventListener("mouseout",this._tooltipHandler)),this._svg=zB=_B&&zw(_B,"svg"),zB&&(zB.addEventListener("click",this._hrefHandler),zB.addEventListener("mouseover",this._tooltipHandler),zB.addEventListener("mouseout",this._tooltipHandler)),CE.prototype.initialize.call(this,_B,kB,wB)},kI.svg=function(){return this._svg},kI.on=function(_B,kB){var wB=this.eventName(_B),zB=this._handlers,EB={type:_B,handler:kB,listener:UE(this,kB)};return(zB[wB]||(zB[wB]=[])).push(EB),this._svg&&this._svg.addEventListener(wB,EB.listener),this},kI.off=function(_B,kB){var wB,zB=this.eventName(_B),EB=this._svg,SB=this._handlers[zB];if(SB){for(wB=SB.length;0<=--wB;)(SB[wB].type!==_B||kB)&&SB[wB].handler!==kB||(this._svg&&EB.removeEventListener(zB,SB[wB].listener),SB.splice(wB,1));return this}};var wI={version:"1.1",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink"},zI={fill:"fill",fillOpacity:"fill-opacity",stroke:"stroke",strokeWidth:"stroke-width",strokeOpacity:"stroke-opacity",strokeCap:"stroke-linecap",strokeJoin:"stroke-linejoin",strokeDash:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeMiterLimit:"stroke-miterlimit",opacity:"opacity"},EI=Object.keys(zI),SI=wI.xmlns,CI=Pk(NE,OE),OI=OE.prototype;CI.initialize=function(_B,kB,wB,zB){return _B&&(this._svg=Ew(_B,0,"svg",SI),this._svg.setAttribute("class","marks"),Sw(_B,1),this._root=Ew(this._svg,0,"g",SI),Sw(this._svg,1)),this._defs={clip_id:1,gradient:{},clipping:{}},this.background(this._bgcolor),OI.initialize.call(this,_B,kB,wB,zB)},CI.background=function(_B){return arguments.length&&this._svg&&this._svg.style.setProperty("background-color",_B),OI.background.apply(this,arguments)},CI.resize=function(_B,kB,wB){return OI.resize.call(this,_B,kB,wB),this._svg&&(this._svg.setAttribute("width",this._width),this._svg.setAttribute("height",this._height),this._svg.setAttribute("viewBox","0 0 "+this._width+" "+this._height),this._root.setAttribute("transform","translate("+this._origin+")")),this},CI.svg=function(){if(!this._svg)return null;var _B={class:"marks",width:this._width,height:this._height,viewBox:"0 0 "+this._width+" "+this._height};for(var kB in wI)_B[kB]=wI[kB];return $E("svg",_B)+this._svg.innerHTML+jE("svg")},CI._render=function(_B,kB){return this._dirtyCheck(kB)&&(this._dirtyAll&&this._resetDefs(),this.draw(this._root,_B),Sw(this._root,1)),this.updateDefs(),this},CI.updateDefs=function(){var _B,kB=this._svg,wB=this._defs,zB=wB.el,EB=0;for(_B in wB.gradient)zB||(wB.el=zB=Ew(kB,0,"defs",SI)),WE(zB,wB.gradient[_B],EB++);for(_B in wB.clipping)zB||(wB.el=zB=Ew(kB,0,"defs",SI)),BE(zB,wB.clipping[_B],EB++);zB&&(0===EB?(kB.removeChild(zB),wB.el=null):Sw(zB,EB))},CI._resetDefs=function(){var _B=this._defs;_B.clip_id=1,_B.gradient={},_B.clipping={}},CI.isDirty=function(_B){return this._dirtyAll||!_B._svg||_B.dirty===this._dirtyID},CI._dirtyCheck=function(_B){if(this._dirtyAll=!0,!_B)return!0;var kB,wB,zB,EB,SB,CB,OB,RB=++this._dirtyID;for(SB=0,CB=_B.length;SB<CB;++SB)kB=_B[SB],wB=kB.mark,wB.marktype!==zB&&(zB=wB.marktype,EB=pI[zB]),wB.zdirty&&wB.dirty!==RB&&(this._dirtyAll=!1,wB.dirty=RB,GE(wB.group,RB)),kB.exit?(EB.nested&&wB.items.length?(OB=wB.items[0],OB._svg&&this._update(EB,OB._svg,OB)):kB._svg&&kB._svg.parentNode.removeChild(kB._svg),kB._svg=null):(kB=EB.nested?wB.items[0]:kB,kB._update!==RB&&(kB._svg&&kB._svg.ownerSVGElement?this._update(EB,kB._svg,kB):(this._dirtyAll=!1,GE(kB,RB)),kB._update=RB));return!this._dirtyAll},CI.draw=function(_B,kB,wB){function zB(PB){var qB=SB.isDirty(PB),MB=HE(PB,EB,DB,CB.tag);qB&&(SB._update(CB,MB,PB),RB&&VE(SB,MB,PB)),DB=MB,++AB}if(!this.isDirty(kB))return kB._svg;var EB,SB=this,CB=pI[kB.marktype],OB=!1===kB.interactive?"none":null,RB="g"===CB.tag,DB=null,AB=0;return EB=HE(kB,_B,wB,"g"),EB.setAttribute("class",Cw(kB)),!RB&&OB&&EB.style.setProperty("pointer-events",OB),kB.clip&&EB.setAttribute("clip-path",Lz(SB,kB,kB.group)),CB.nested?kB.items.length&&zB(kB.items[0]):wz(kB,zB),Sw(EB,AB),EB};var RI=null,DI=null,AI={group:function(kB,wB,zB){DI=wB.__values__,RI=wB.childNodes[1],kB.foreground(YE,zB,this),RI=wB.childNodes[0],kB.background(YE,zB,this);var EB=!1===zB.mark.interactive?"none":null;EB!==DI.events&&(RI.style.setProperty("pointer-events",EB),DI.events=EB)},text:function(kB,wB,zB){var EB=cE(zB);EB!==DI.text&&(wB.textContent=EB,DI.text=EB),(EB=fE(zB))!==DI.font&&(wB.style.setProperty("font",EB),DI.font=EB)}};CI._update=function(_B,kB,wB){RI=kB,DI=kB.__values__,_B.attr(YE,wB,this);var zB=AI[_B.type];zB&&zB.call(this,_B,kB,wB),this.style(RI,wB)},CI.style=function(_B,kB){if(null!=kB){var wB,zB,EB,SB,CB;for(wB=0,zB=EI.length;wB<zB;++wB)EB=EI[wB],(CB=kB[EB])!==DI[EB]&&(SB=zI[EB],null==CB?"fill"===SB?_B.style.setProperty(SB,"none"):_B.style.removeProperty(SB):(CB.id&&(this._defs.gradient[CB.id]=CB,CB="url("+XE()+"#"+CB.id+")"),_B.style.setProperty(SB,CB+"")),DI[EB]=CB)}};var PI=Pk(JE,OE),qI=OE.prototype;PI.resize=function(_B,kB,wB){qI.resize.call(this,_B,kB,wB);var zB=this._origin,EB=this._text,SB={class:"marks",width:this._width,height:this._height,viewBox:"0 0 "+this._width+" "+this._height};for(var CB in wI)SB[CB]=wI[CB];return EB.head=$E("svg",SB),EB.root=$E("g",{transform:"translate("+zB+")"}),EB.foot=jE("g")+jE("svg"),this},PI.svg=function(){var _B=this._text;return _B.head+_B.defs+_B.root+_B.body+_B.foot},PI._render=function(_B){return this._text.body=this.mark(_B),this._text.defs=this.buildDefs(),this},PI.reset=function(){return this._defs.clip_id=0,this},PI.buildDefs=function(){var _B,kB,wB,zB,EB=this._defs,SB="";for(kB in EB.gradient){for(wB=EB.gradient[kB],zB=wB.stops,SB+=$E("linearGradient",{id:kB,x1:wB.x1,x2:wB.x2,y1:wB.y1,y2:wB.y2}),_B=0;_B<zB.length;++_B)SB+=$E("stop",{offset:zB[_B].offset,"stop-color":zB[_B].color})+jE("stop");SB+=jE("linearGradient")}for(kB in EB.clipping)wB=EB.clipping[kB],SB+=$E("clipPath",{id:kB}),SB+=$E("rect",{x:0,y:0,width:wB.width,height:wB.height})+jE("rect"),SB+=jE("clipPath");return 0<SB.length?$E("defs")+SB+jE("defs"):""};var MI;PI.attributes=function(_B,kB){return MI={},_B(QE,kB,this),MI},PI.href=function(_B){var kB,wB=this,zB=_B.href;if(zB){if(kB=wB._hrefs&&wB._hrefs[zB])return kB;wB.sanitizeURL(zB).then(function(EB){EB["xlink:href"]=EB.href,EB.href=null,(wB._hrefs||(wB._hrefs={}))[zB]=EB})}return null},PI.mark=function(_B){function kB(RB){var DB=zB.href(RB);DB&&(OB+=$E("a",DB)),wB="g"===SB?null:KE(RB,_B,SB,CB),OB+=$E(SB,zB.attributes(EB.attr,RB),wB),"text"===SB?OB+=ZE(cE(RB)):"g"===SB&&(OB+=$E("path",zB.attributes(EB.background,RB),KE(RB,_B,"bgrect",CB))+jE("path"),OB+=$E("g",zB.attributes(EB.foreground,RB))+zB.markGroup(RB)+jE("g")),OB+=jE(SB),DB&&(OB+=jE("a"))}var wB,zB=this,EB=pI[_B.marktype],SB=EB.tag,CB=this._defs,OB="";return"g"!==SB&&!1===_B.interactive&&(wB="style=\"pointer-events: none;\""),OB+=$E("g",{class:Cw(_B),"clip-path":_B.clip?Lz(zB,_B,_B.group):null},wB),EB.nested?_B.items&&_B.items.length&&kB(_B.items[0]):wz(_B,kB),OB+jE("g")},PI.markGroup=function(_B){var kB=this,wB="";return wz(_B,function(zB){wB+=kB.mark(zB)}),wB};var LI={Canvas:"canvas",PNG:"png",SVG:"svg",None:"none"},TI={};TI.canvas=TI.png={renderer:LE,headless:LE,handler:DE},TI.svg={renderer:NE,headless:JE,handler:IE},TI.none={};var FI=1e-9,II=1,UI="_:mod:_",$I=mS.prototype;$I.set=function(_B,kB,wB,zB){var EB=this,SB=EB[_B],CB=EB[UI];return null!=kB&&0<=kB?(SB[kB]!==wB||zB)&&(SB[kB]=wB,CB[kB+":"+_B]=-1,CB[_B]=-1):(SB!==wB||zB)&&(EB[_B]=wB,CB[_B]=KT(wB)?wB.length:-1),EB},$I.modified=function(_B,kB){var wB,zB=this[UI];if(!arguments.length){for(wB in zB)if(zB[wB])return!0;return!1}if(KT(_B)){for(wB=0;wB<_B.length;++wB)if(zB[_B[wB]])return!0;return!1}return null!=kB&&0<=kB?kB<zB[_B]||!!zB[kB+":"+_B]:!!zB[_B]},$I.clear=function(){return this[UI]={},this};var jI=0,NI=new mS,WI=fS.prototype;WI.targets=function(){return this._targets||(this._targets=iS(eF))},WI.set=function(_B){return this.value===_B?0:(this.value=_B,1)},WI.skip=gS(1),WI.modified=gS(2),WI.parameters=function(_B,kB){function wB(PB,qB,MB){MB instanceof fS?(MB!==OB&&(kB&&MB.targets().add(OB),AB.push(MB)),DB.push({op:MB,name:PB,index:qB})):RB.set(PB,qB,MB)}kB=!1!==kB;var zB,EB,SB,CB,OB=this,RB=OB._argval=OB._argval||new mS,DB=OB._argops=OB._argops||[],AB=[];for(zB in _B)if(EB=_B[zB],"pulse"===zB)Ek(EB).forEach(function(PB){PB instanceof fS?PB!==OB&&(PB.targets().add(OB),AB.push(PB)):yk("Pulse parameters must be operator instances.")}),OB.source=EB;else if(KT(EB))for(RB.set(zB,-1,Array(SB=EB.length)),CB=0;CB<SB;++CB)wB(zB,CB,EB[CB]);else wB(zB,-1,EB);return this.marshall().clear(),AB},WI.marshall=function(_B){var kB,wB,zB,EB,SB,CB=this._argval||NI,OB=this._argops;if(OB&&(zB=OB.length))for(wB=0;wB<zB;++wB)kB=OB[wB],EB=kB.op,SB=EB.modified()&&EB.stamp===_B,CB.set(kB.name,kB.index,EB.value,SB);return CB},WI.evaluate=function(_B){if(this._update){var kB=this.marshall(_B.stamp),wB=this._update(kB,_B);if(kB.clear(),wB!==this.value)this.value=wB;else if(!this.modified())return _B.StopPropagation}},WI.run=function(_B){if(_B.stamp<=this.stamp)return _B.StopPropagation;var kB=this.skip()?(this.skip(!1),0):this.evaluate(_B);return this.stamp=_B.stamp,this.pulse=kB||_B};var BI=0,GI=vS.prototype;GI._filter=iF,GI._apply=tF,GI.targets=function(){return this._targets||(this._targets=iS(eF))},GI.consume=function(_B){return arguments.length?(this._consume=!!_B,this):!!this._consume},GI.receive=function(_B){if(this._filter(_B)){for(var kB=this.value=this._apply(_B),wB=this._targets,zB=wB?wB.length:0,EB=0;EB<zB;++EB)wB[EB].receive(kB);this._consume&&(_B.preventDefault(),_B.stopPropagation())}},GI.filter=function(_B){var kB=xS(_B);return this.targets().add(kB),kB},GI.apply=function(_B){var kB=xS(null,_B);return this.targets().add(kB),kB},GI.merge=function(){var _B=xS();this.targets().add(_B);for(var kB=0,wB=arguments.length;kB<wB;++kB)arguments[kB].targets().add(_B);return _B},GI.throttle=function(_B){var kB=-1;return this.filter(function(){var wB=Date.now();return wB-kB>_B?(kB=wB,1):0})},GI.debounce=function(_B){function kB(){var SB=zB.dataflow;wB.receive(zB),zB=null,EB=null,SB&&SB.run&&SB.run()}var wB=xS(),zB=null,EB=null;return this.targets().add(xS(null,null,function(SB){zB=SB,EB&&clearTimeout(EB),EB=setTimeout(kB,_B)})),wB},GI.between=function(_B,kB){var wB=!1;return _B.targets().add(xS(null,null,function(){wB=!0})),kB.targets().add(xS(null,null,function(){wB=!1})),this.filter(function(){return wB})};var VI={skip:!0},HI={},YI=SS.prototype;YI.StopPropagation=HI,YI.ADD=1,YI.REM=2,YI.MOD=4,YI.ADD_REM=3,YI.ADD_MOD=5,YI.ALL=7,YI.REFLOW=8,YI.SOURCE=16,YI.NO_SOURCE=32,YI.NO_FIELDS=64,YI.fork=function(_B){return new SS(this.dataflow).init(this,_B)},YI.addAll=function(){var _B=this;return this.source&&this.source.length!==this.add.length?(_B=new SS(this.dataflow).init(this),_B.add=_B.source,_B):_B},YI.init=function(_B,kB){var wB=this;return wB.stamp=_B.stamp,wB.encode=_B.encode,!_B.fields||64&kB||(wB.fields=_B.fields),wB.add=1&kB?(wB.addF=_B.addF,_B.add):(wB.addF=null,[]),wB.rem=2&kB?(wB.remF=_B.remF,_B.rem):(wB.remF=null,[]),wB.mod=4&kB?(wB.modF=_B.modF,_B.mod):(wB.modF=null,[]),wB.source=32&kB?(wB.srcF=null,null):(wB.srcF=_B.srcF,_B.source),wB},YI.runAfter=function(_B){this.dataflow.runAfter(_B)},YI.changed=function(_B){var kB=_B||7;return 1&kB&&this.add.length||2&kB&&this.rem.length||4&kB&&this.mod.length},YI.reflow=function(_B){if(_B)return this.fork(7).reflow();var kB=this.add.length,wB=this.source&&this.source.length;return wB&&wB!==kB&&(this.mod=this.source,kB&&this.filter(4,OS(this,1))),this},YI.modifies=function(_B){var kB=Ek(_B),wB=this.fields||(this.fields={});return kB.forEach(function(zB){wB[zB]=!0}),this},YI.modified=function(_B){var kB=this.fields;return this.mod.length&&kB&&(arguments.length?KT(_B)?_B.some(function(wB){return kB[wB]}):kB[_B]:!!kB)},YI.filter=function(_B,kB){var wB=this;return 1&_B&&(wB.addF=CS(wB.addF,kB)),2&_B&&(wB.remF=CS(wB.remF,kB)),4&_B&&(wB.modF=CS(wB.modF,kB)),16&_B&&(wB.srcF=CS(wB.srcF,kB)),wB},YI.materialize=function(_B){_B=_B||7;var kB=this;return 1&_B&&kB.addF&&(kB.add=kB.add.filter(kB.addF),kB.addF=null),2&_B&&kB.remF&&(kB.rem=kB.rem.filter(kB.remF),kB.remF=null),4&_B&&kB.modF&&(kB.mod=kB.mod.filter(kB.modF),kB.modF=null),16&_B&&kB.srcF&&(kB.source=kB.source.filter(kB.srcF),kB.srcF=null),kB},YI.visit=function(_B,kB){var wB,zB,EB=kB;return 16&_B?(Yk(this.source,this.srcF,EB),this):(1&_B&&Yk(this.add,this.addF,EB),2&_B&&Yk(this.rem,this.remF,EB),4&_B&&Yk(this.mod,this.modF,EB),8&_B&&(wB=this.source)&&((zB=this.add.length+this.mod.length)===wB.length||(zB?Yk(wB,OS(this,5),EB):Yk(wB,this.srcF,EB))),this)};var XI={skip:!1,force:!1},JI=Pk(LS,SS);JI.fork=function(){return arguments.length&&arguments[0]&SS.prototype.ALL&&yk("MultiPulse fork does not support tuple change sets."),new SS(this.dataflow).init(this,0)},JI.changed=function(_B){return this.changes&_B},JI.modified=function(_B){var kB=this,wB=kB.fields;return wB&&kB.changes&kB.MOD?KT(_B)?_B.some(function(zB){return wB[zB]}):wB[_B]:0},JI.filter=function(){yk("MultiPulse does not support filtering.")},JI.materialize=function(){yk("MultiPulse does not support materialization.")},JI.visit=function(_B,kB){var wB,zB,EB=this.pulses;for(wB=0,zB=EB.length;wB<zB;++wB)EB[wB].stamp===this.stamp&&EB[wB].visit(_B,kB);return this};var QI=jS.prototype;QI.size=function(){return this.nodes.length},QI.clear=function(){return this.nodes=[],this},QI.peek=function(){return this.nodes[0]},QI.push=function(_B){var kB=this.nodes;return kB.push(_B),NS(kB,0,kB.length-1,this.cmp)},QI.pop=function(){var _B,kB=this.nodes,wB=kB.pop();return kB.length?(_B=kB[0],kB[0]=wB,WS(kB,0,this.cmp)):_B=wB,_B},QI.replace=function(_B){var kB=this.nodes,wB=kB[0];return kB[0]=_B,WS(kB,0,this.cmp),wB},QI.pushpop=function(_B){var kB=this.nodes,wB=kB[0];return kB.length&&0>this.cmp(wB,_B)&&(kB[0]=_B,_B=wB,WS(kB,0,this.cmp)),_B};var KI=BS.prototype;KI.stamp=function(){return this._clock},KI.loader=function(_B){return arguments.length?(this._loader=_B,this):this._loader},KI.cleanThreshold=1e4,KI.add=function(_B,kB,wB,zB){var EB=1,SB=_B instanceof fS?_B:_B&&_B.prototype instanceof fS?new _B:Ck(_B)?new fS(null,_B):(EB=0,new fS(_B,kB));return this.rank(SB),EB&&(zB=wB,wB=kB),wB&&this.connect(SB,SB.parameters(wB,zB)),this.touch(SB),SB},KI.connect=function(_B,kB){var wB,zB,EB=_B.rank;for(wB=0,zB=kB.length;wB<zB;++wB)if(EB<kB[wB].rank)return void this.rerank(_B)},KI.rank=function(_B){_B.rank=++this._rank},KI.rerank=function(_B){for(var kB,wB,zB,EB=[_B];EB.length;)if(this.rank(kB=EB.pop()),wB=kB._targets)for(zB=wB.length;0<=--zB;)EB.push(wB[zB])},KI.pulse=function(_B,kB,wB){var zB=new SS(this,this._clock+(this._pulse?0:1));return zB.target=_B,this._pulses[_B.id]=kB.pulse(zB,_B.value),this.touch(_B,wB||XI)},KI.touch=function(_B,kB){return this._pulse?this._enqueue(_B):this._touched.add(_B),(kB||XI).skip&&_B.skip(!0),this},KI.update=function(_B,kB,wB){var zB=wB||XI;return(_B.set(kB)||zB.force)&&this.touch(_B,zB),this},KI.changeset=cS,KI.ingest=function(_B,kB,wB){return this.pulse(_B,this.changeset().insert(yw(kB,wB)))},KI.request=function(_B,kB,wB){var zB=this,EB=zB._pending||qS(zB);EB.requests+=1,zB.loader().load(kB,{context:"dataflow"}).then(function(SB){zB.ingest(_B,SB,wB)},function(SB){zB.warn("Loading failed: "+kB,SB),EB.done()}).then(EB.done).catch(function(SB){zB.warn(SB)})},KI.events=function(_B,kB,wB,zB){var EB,SB=this,CB=xS(wB,zB),OB=function(PB){PB.dataflow=SB,CB.receive(PB),SB.run()};EB="string"==typeof _B&&"undefined"!=typeof document?document.querySelectorAll(_B):Ek(_B);for(var RB=0,DB=EB.length;RB<DB;++RB)EB[RB].addEventListener(kB,OB);return CB},KI.on=function(_B,kB,wB,zB,EB){return(_B instanceof fS?wS:kS)(this,_B,kB,wB,zB,EB),this},KI.run=function(_B){if(!this._touched.length)return 0;if(this._pending)return this.info("Awaiting requests, delaying dataflow run."),0;var kB,wB,zB,EB=this,SB=0,CB=EB.logLevel();EB._pulse=new SS(EB,++EB._clock,_B),CB>=sF&&(zB=Date.now(),EB.debug("-- START PROPAGATION ("+EB._clock+") -----")),EB._touched.forEach(function(RB){EB._enqueue(RB,!0)}),EB._touched=iS(eF);try{for(;0<EB._heap.size();)kB=EB._heap.pop(),kB.rank===kB.qrank?(wB=kB.run(EB._getPulse(kB,_B)),CB>=lF&&EB.debug(kB.id,wB===HI?"STOP":wB,kB),wB!==HI&&(EB._pulse=wB,kB._targets&&kB._targets.forEach(function(RB){EB._enqueue(RB)})),++SB):EB._enqueue(kB,!0)}catch(RB){EB.error(RB)}if(EB._pulses={},EB._pulse=null,CB>=sF&&(zB=Date.now()-zB,EB.info("> Pulse "+EB._clock+": "+SB+" operators; "+zB+"ms")),EB._postrun.length){var OB=EB._postrun;EB._postrun=[],OB.forEach(function(RB){try{RB(EB)}catch(DB){EB.error(DB)}})}return SB},KI.runAsync=function(){return this._pending||Promise.resolve(this.run())},KI.runAfter=function(_B){if(this._pulse)this._postrun.push(_B);else try{_B(this)}catch(kB){this.error(kB)}},KI._enqueue=function(_B,kB){var wB=!this._pulses[_B.id];wB&&(this._pulses[_B.id]=this._pulse),(wB||kB)&&(_B.qrank=_B.rank,this._heap.push(_B))},KI._getPulse=function(_B,kB){var wB,zB=_B.source,EB=this._clock;return zB&&KT(zB)?(wB=zB.map(function(SB){return SB.pulse}),new LS(this,EB,wB,kB)):(zB=zB&&zB.pulse,wB=this._pulses[_B.id],zB&&zB!==HI&&(zB.stamp===EB&&wB.target!==_B?wB=zB:wB.source=zB.source),wB)},KI.warn=GS("warn"),KI.info=GS("info"),KI.debug=GS("debug"),KI.logLevel=GS("level"),KI.error=function(_B){throw _B};var ZI=Pk(VS,fS);ZI.evaluate=function(_B){var kB=this.marshall(_B.stamp),wB=this.transform(kB,_B);return kB.clear(),wB},ZI.transform=function(){};var eU={},tU={},aU=JS.prototype;aU.add=function(_B){this._add.push(_B)},aU.rem=function(_B){this._rem.push(_B)},aU.values=function(){if(this._get=null,0===this._rem.length)return this._add;var _B,kB,wB,zB=this._add,EB=this._rem,SB=this._key,CB=zB.length,OB=EB.length,RB=Array(CB-OB),DB={};for(_B=0;_B<OB;++_B)DB[EB[_B][SB]]=1;for(_B=0,kB=0;_B<CB;++_B)DB[(wB=zB[_B])[SB]]?DB[wB[SB]]=0:RB[kB++]=wB;return this._rem=[],this._add=RB},aU.distinct=function(_B){for(var kB,wB=this.values(),zB=wB.length,EB={},SB=0;0<=--zB;)kB=_B(wB[zB])+"",EB.hasOwnProperty(kB)||(EB[kB]=1,++SB);return SB},aU.extent=function(_B){if(this._get!==_B||!this._ext){var kB=this.values(),wB=Dk(kB,_B);this._ext=[kB[wB[0]],kB[wB[1]]],this._get=_B}return this._ext},aU.argmin=function(_B){return this.extent(_B)[0]||{}},aU.argmax=function(_B){return this.extent(_B)[1]||{}},aU.min=function(_B){var kB=this.extent(_B)[0];return null==kB?1/0:_B(kB)},aU.max=function(_B){var kB=this.extent(_B)[1];return null==kB?-1/0:_B(kB)},aU.quartile=function(_B){return this._get===_B&&this._q||(this._q=lk(this.values(),_B),this._get=_B),this._q},aU.q1=function(_B){return this.quartile(_B)[0]},aU.q2=function(_B){return this.quartile(_B)[1]},aU.q3=function(_B){return this.quartile(_B)[2]},aU.ci=function(_B){return this._get===_B&&this._ci||(this._ci=dk(this.values(),1e3,.05,_B),this._get=_B),this._ci},aU.ci0=function(_B){return this.ci(_B)[0]},aU.ci1=function(_B){return this.ci(_B)[1]};var nU={values:KS({name:"values",init:"cell.store = true;",set:"cell.data.values()",idx:-1}),count:KS({name:"count",set:"cell.num"}),missing:KS({name:"missing",set:"this.missing"}),valid:KS({name:"valid",set:"this.valid"}),sum:KS({name:"sum",init:"this.sum = 0;",add:"this.sum += v;",rem:"this.sum -= v;",set:"this.sum"}),mean:KS({name:"mean",init:"this.mean = 0;",add:"var d = v - this.mean; this.mean += d / this.valid;",rem:"var d = v - this.mean; this.mean -= this.valid ? d / this.valid : this.mean;",set:"this.mean"}),average:KS({name:"average",set:"this.mean",req:["mean"],idx:1}),variance:KS({name:"variance",init:"this.dev = 0;",add:"this.dev += d * (v - this.mean);",rem:"this.dev -= d * (v - this.mean);",set:"this.valid > 1 ? this.dev / (this.valid-1) : 0",req:["mean"],idx:1}),variancep:KS({name:"variancep",set:"this.valid > 1 ? this.dev / this.valid : 0",req:["variance"],idx:2}),stdev:KS({name:"stdev",set:"this.valid > 1 ? Math.sqrt(this.dev / (this.valid-1)) : 0",req:["variance"],idx:2}),stdevp:KS({name:"stdevp",set:"this.valid > 1 ? Math.sqrt(this.dev / this.valid) : 0",req:["variance"],idx:2}),stderr:KS({name:"stderr",set:"this.valid > 1 ? Math.sqrt(this.dev / (this.valid * (this.valid-1))) : 0",req:["variance"],idx:2}),distinct:KS({name:"distinct",set:"cell.data.distinct(this.get)",req:["values"],idx:3}),ci0:KS({name:"ci0",set:"cell.data.ci0(this.get)",req:["values"],idx:3}),ci1:KS({name:"ci1",set:"cell.data.ci1(this.get)",req:["values"],idx:3}),median:KS({name:"median",set:"cell.data.q2(this.get)",req:["values"],idx:3}),q1:KS({name:"q1",set:"cell.data.q1(this.get)",req:["values"],idx:3}),q3:KS({name:"q3",set:"cell.data.q3(this.get)",req:["values"],idx:3}),argmin:KS({name:"argmin",add:"if (v < this.min) this.argmin = t;",rem:"if (v <= this.min) this.argmin = null;",set:"this.argmin || cell.data.argmin(this.get)",req:["min"],str:["values"],idx:3}),argmax:KS({name:"argmax",add:"if (v > this.max) this.argmax = t;",rem:"if (v >= this.max) this.argmax = null;",set:"this.argmax || cell.data.argmax(this.get)",req:["max"],str:["values"],idx:3}),min:KS({name:"min",init:"this.min = null;",add:"if (v < this.min || this.min === null) this.min = v;",rem:"if (v <= this.min) this.min = NaN;",set:"this.min = (isNaN(this.min) ? cell.data.min(this.get) : this.min)",str:["values"],idx:4}),max:KS({name:"max",init:"this.max = null;",add:"if (v > this.max || this.max === null) this.max = v;",rem:"if (v >= this.max) this.max = NaN;",set:"this.max = (isNaN(this.max) ? cell.data.max(this.get) : this.max)",str:["values"],idx:4})},iU=Pk(aC,VS);iU.transform=function(_B,kB){var wB,zB=this,EB=kB.fork(kB.NO_SOURCE|kB.NO_FIELDS);return this.stamp=EB.stamp,this.value&&((wB=_B.modified())||kB.modified(this._inputs))?(this._prev=this.value,this.value=wB?this.init(_B):{},kB.visit(kB.SOURCE,function(SB){zB.add(SB)})):(this.value=this.value||this.init(_B),kB.visit(kB.REM,function(SB){zB.rem(SB)}),kB.visit(kB.ADD,function(SB){zB.add(SB)})),EB.modifies(this._outputs),zB._drop=!1!==_B.drop,_B.cross&&1<zB._dims.length&&(zB._drop=!1,this.cross()),zB.changes(EB)},iU.cross=function(){function _B(OB){var RB,DB,AB,PB;for(RB in OB)for(AB=OB[RB].tuple,DB=0;DB<CB;++DB)SB[DB][PB=AB[EB[DB]]]=PB}function kB(OB,RB,DB){var AB,PB,qB=EB[DB],MB=SB[DB++];for(AB in MB)RB[qB]=MB[AB],PB=OB?OB+"|"+AB:AB,DB<CB?kB(PB,RB,DB):zB[PB]||wB.cell(PB,RB)}var wB=this,zB=wB.value,EB=wB._dnames,SB=EB.map(function(){return{}}),CB=EB.length;_B(wB._prev),_B(zB),kB("",{},0)},iU.init=function(_B){function kB(FB){for(var IB,UB=FB.fields,$B=0,jB=UB.length;$B<jB;++$B)EB[IB=UB[$B]]||(EB[IB]=1,wB.push(IB))}var wB=this._inputs=[],zB=this._outputs=[],EB={};this._dims=Ek(_B.groupby),this._dnames=this._dims.map(function(FB){var IB=gk(FB);return kB(FB),zB.push(IB),IB}),this.cellkey=_B.key?_B.key:0===this._dims.length?function(){return""}:1===this._dims.length?this._dims[0]:iC,this._countOnly=!0,this._counts=[],this._measures=[];var SB,CB,OB,RB,DB,AB,PB=_B.fields||[null],qB=_B.ops||["count"],MB=_B.as||[],LB=PB.length,TB={};for(LB!==qB.length&&yk("Unmatched number of fields and aggregate ops."),AB=0;AB<LB;++AB)SB=PB[AB],CB=qB[AB],null==SB&&"count"!==CB&&yk("Null aggregate field specified."),RB=gk(SB),DB=nC(CB,RB,MB[AB]),zB.push(DB),"count"===CB?this._counts.push(DB):(OB=TB[RB],OB||(kB(SB),OB=TB[RB]=[],OB.field=SB,this._measures.push(OB)),"count"!==CB&&(this._countOnly=!1),OB.push(QS(CB,DB)));return this._measures=this._measures.map(function(FB){return tC(FB,FB.field)}),{}},iU.cellkey=iC,iU.cell=function(_B,kB){var wB=this.value[_B];return wB?0===wB.num&&this._drop&&wB.stamp<this.stamp?(wB.stamp=this.stamp,this._adds[this._alen++]=wB):wB.stamp<this.stamp&&(wB.stamp=this.stamp,this._mods[this._mlen++]=wB):(wB=this.value[_B]=this.newcell(_B,kB),this._adds[this._alen++]=wB),wB},iU.newcell=function(_B,kB){var wB={key:_B,num:0,agg:null,tuple:this.newtuple(kB,this._prev&&this._prev[_B]),stamp:this.stamp,store:!1};if(!this._countOnly){var zB,EB=this._measures,SB=EB.length;for(wB.agg=Array(SB),zB=0;zB<SB;++zB)wB.agg[zB]=new EB[zB](wB,wB.tuple)}return wB.store&&(wB.data=new JS),wB},iU.newtuple=function(_B,kB){var wB,zB,EB=this._dnames,SB=this._dims,CB={};for(wB=0,zB=SB.length;wB<zB;++wB)CB[EB[wB]]=SB[wB](_B);return kB?uS(kB.tuple,CB):oS(CB)},iU.add=function(_B){var kB,wB,zB,EB=this.cellkey(_B),SB=this.cell(EB,_B);if(SB.num+=1,!this._countOnly)for(SB.store&&SB.data.add(_B),kB=SB.agg,wB=0,zB=kB.length;wB<zB;++wB)kB[wB].add(kB[wB].get(_B),_B)},iU.rem=function(_B){var kB,wB,zB,EB=this.cellkey(_B),SB=this.cell(EB,_B);if(SB.num-=1,!this._countOnly)for(SB.store&&SB.data.rem(_B),kB=SB.agg,wB=0,zB=kB.length;wB<zB;++wB)kB[wB].rem(kB[wB].get(_B),_B)},iU.celltuple=function(_B){var kB,wB,zB,EB=_B.tuple,SB=this._counts;for(_B.store&&_B.data.values(),wB=0,zB=SB.length;wB<zB;++wB)EB[SB[wB]]=_B.num;if(!this._countOnly)for(kB=_B.agg,wB=0,zB=kB.length;wB<zB;++wB)kB[wB].set();return EB},iU.changes=function(_B){var kB,wB,zB,EB,SB=this._adds,CB=this._mods,OB=this._prev,RB=this._drop,DB=_B.add,AB=_B.rem,PB=_B.mod;if(OB)for(wB in OB)AB.push(OB[wB].tuple);for(zB=0,EB=this._alen;zB<EB;++zB)DB.push(this.celltuple(SB[zB])),SB[zB]=null;for(zB=0,EB=this._mlen;zB<EB;++zB)kB=CB[zB],(0===kB.num&&RB?AB:PB).push(this.celltuple(kB)),CB[zB]=null;return this._alen=this._mlen=0,this._prev=null,_B};var rU=Pk(rC,VS);rU.transform=function(_B,kB){var wB=this._bins(_B),zB=wB.step,EB=_B.as||["bin0","bin1"],SB=EB[0],CB=EB[1],OB=_B.modified()?(kB=kB.reflow(!0),kB.SOURCE):kB.modified(hk(_B.field))?kB.ADD_MOD:kB.ADD;return kB.visit(OB,function(RB){var DB=wB(RB);RB[SB]=DB,RB[CB]=null==DB?null:DB+zB}),kB.modifies(EB)},rU._bins=function(_B){if(this.value&&!_B.modified())return this.value;var kB,wB,zB=_B.field,EB=nk(_B),SB=EB.start,CB=EB.stop,OB=EB.step;null!=(kB=_B.anchor)&&(wB=kB-(SB+OB*Math.floor((kB-SB)/OB)),SB+=wB,CB+=wB);var RB=function(AB){var PB=zB(AB);return null==PB?null:(PB=Math.max(SB,Math.min(+PB,CB-OB)),SB+OB*Math.floor((PB-SB)/OB))};return RB.start=SB,RB.stop=CB,RB.step=OB,this.value=fk(RB,hk(zB),_B.name||"bin_"+gk(zB))},Pk(dC,VS).transform=function(_B,kB){var wB,zB=kB.fork(kB.ALL),EB=kB.changed(kB.ADD),SB=kB.changed(),CB=_B.sort,OB=this.value,DB=0;return zB.rem.length&&(wB={},zB.visit(zB.REM,function(AB){wB[AB._id]=1,++DB}),OB=OB.filter(function(AB){return!wB[AB._id]})),CB?((_B.modified("sort")||kB.modified(CB.fields))&&(OB.sort(CB),SB=!0),EB&&(OB=Ik(CB,OB,zB.add.sort(CB)))):EB&&zB.visit(zB.ADD,function(PB){OB.push(PB)}),this.modified(SB),this.value=zB.source=OB,zB},Pk(oC,fS);var dU=Pk(lC,VS);dU.transform=function(_B,kB){function wB(PB){return function(qB){for(var MB,LB=uC(OB(qB),_B.case,SB)||[],TB=0,FB=LB.length;TB<FB;++TB)CB.test(MB=LB[TB])||PB(MB)}}var zB=this._parameterCheck(_B,kB),EB=this._counts,SB=this._match,CB=this._stop,OB=_B.field,RB=_B.as||["text","count"],DB=wB(function(PB){EB[PB]=1+(EB[PB]||0)}),AB=wB(function(PB){EB[PB]-=1});return zB?kB.visit(kB.SOURCE,DB):(kB.visit(kB.ADD,DB),kB.visit(kB.REM,AB)),this._finish(kB,RB)},dU._parameterCheck=function(_B,kB){var wB=!1;return!_B.modified("stopwords")&&this._stop||(this._stop=new RegExp("^"+(_B.stopwords||"")+"$","i"),wB=!0),!_B.modified("pattern")&&this._match||(this._match=new RegExp(_B.pattern||"[\\w']+","g"),wB=!0),(_B.modified("field")||kB.modified(_B.field.fields))&&(wB=!0),wB&&(this._counts={}),wB},dU._finish=function(_B,kB){var wB,zB,EB,SB=this._counts,CB=this._tuples||(this._tuples={}),OB=kB[0],RB=kB[1],DB=_B.fork();for(wB in SB)zB=CB[wB],EB=SB[wB]||0,!zB&&EB?(CB[wB]=zB=oS({}),zB[OB]=wB,zB[RB]=EB,DB.add.push(zB)):0===EB?(zB&&DB.rem.push(zB),SB[wB]=null,CB[wB]=null):zB[RB]!==EB&&(zB[RB]=EB,DB.mod.push(zB));return DB.modifies(kB)},Pk(pC,VS).transform=function(_B,kB){var wB=kB.fork(kB.NO_SOURCE),zB=this.value,EB=_B.as||["a","b"],SB=EB[0],CB=EB[1];return!zB||kB.changed(kB.ADD_REM)||_B.modified("as")||_B.modified("filter")?(zB&&(wB.rem=zB),wB.add=this.value=cC(kB.source,SB,CB,_B.filter||iF)):wB.mod=zB,wB.source=this.value,wB.modifies(EB)};var oU={kde:uk,mixture:ck,normal:sk,uniform:mk},sU="distributions",lU="function",uU="field";Pk(fC,VS).transform=function(_B,kB){var wB=kB.fork(kB.NO_SOURCE|kB.NO_FIELDS);if(!this.value||kB.changed()||_B.modified()){var zB=mC(_B.distribution,gC(kB)),EB=_B.method||"pdf";"pdf"!==EB&&"cdf"!==EB&&yk("Invalid density method: "+EB),_B.extent||zB.data||yk("Missing density extent parameter."),EB=zB[EB];var SB=_B.as||["value","density"],CB=_B.extent||U_.extent(zB.data()),OB=(CB[1]-CB[0])/(_B.steps||100),RB=U_.range(CB[0],CB[1]+OB/2,OB).map(function(DB){var AB={};return AB[SB[0]]=DB,AB[SB[1]]=EB(DB),oS(AB)});this.value&&(wB.rem=this.value),this.value=wB.add=wB.source=RB}return wB},Pk(hC,VS).transform=function(_B,kB){var wB,zB=this.value,EB=_B.field,SB=zB[0],CB=zB[1],OB=kB.ADD;wB=kB.changed()||kB.modified(EB.fields)||_B.modified("field"),wB&&(OB=kB.SOURCE,SB=1/0,CB=-1/0),kB.visit(OB,function(RB){var DB=EB(RB);DB<SB&&(SB=DB),DB>CB&&(CB=DB)}),this.value=[SB,CB]};var pU=Pk(yC,fS);pU.connect=function(_B){return this.targets().add(_B),_B.source=this},pU.add=function(_B){this.value.add.push(_B)},pU.rem=function(_B){this.value.rem.push(_B)},pU.mod=function(_B){this.value.mod.push(_B)},pU.init=function(_B){this.value.init(_B,_B.NO_SOURCE)},pU.evaluate=function(){return this.value};var cU=Pk(vC,VS);cU.activate=function(_B){this._targets[this._targets.active++]=_B},cU.subflow=function(_B,kB,wB,zB){var EB,SB,CB=this.value,OB=CB.hasOwnProperty(_B)&&CB[_B];return OB?OB.value.stamp<wB.stamp&&(OB.init(wB),this.activate(OB)):(SB=zB||(SB=this._group[_B])&&SB.tuple,EB=wB.dataflow,OB=EB.add(new yC(wB.fork(wB.NO_SOURCE),this)).connect(kB(EB,_B,SB)),CB[_B]=OB,this.activate(OB)),OB},cU.transform=function(_B,kB){function wB(DB){return EB.subflow(DB,CB,kB)}var zB=kB.dataflow,EB=this,SB=_B.key,CB=_B.subflow,OB=this._keys,RB=_B.modified("key");return this._group=_B.group||{},this._targets.active=0,kB.visit(kB.ADD,function(DB){var AB=SB(DB);OB.set(DB._id,AB),wB(AB).add(DB)}),kB.visit(kB.REM,function(DB){var AB=OB.get(DB._id);OB.delete(DB._id),wB(AB).rem(DB)}),RB||kB.modified(SB.fields)?kB.visit(kB.MOD,function(DB){var AB=OB.get(DB._id),PB=SB(DB);AB===PB?wB(PB).mod(DB):(OB.set(DB._id,PB),wB(AB).rem(DB),wB(PB).add(DB))}):kB.changed(kB.MOD)&&kB.visit(kB.MOD,function(DB){wB(OB.get(DB._id)).mod(DB)}),RB&&kB.visit(kB.REFLOW,function(DB){var AB=OB.get(DB._id),PB=SB(DB);AB!==PB&&(OB.set(DB._id,PB),wB(AB).rem(DB),wB(PB).add(DB))}),OB.empty>zB.cleanThreshold&&zB.runAfter(OB.clean),kB},Pk(xC,fS),Pk(_C,VS).transform=function(_B,kB){function wB(PB){var qB=DB(PB,_B),MB=EB.get(PB._id);qB&&MB?(EB.delete(PB._id),CB.push(PB)):qB||MB?AB&&qB&&!MB&&RB.push(PB):(EB.set(PB._id,1),OB.push(PB))}var zB=kB.dataflow,EB=this.value,SB=kB.fork(),CB=SB.add,OB=SB.rem,RB=SB.mod,DB=_B.expr,AB=!0;return kB.visit(kB.REM,function(PB){EB.has(PB._id)?EB.delete(PB._id):OB.push(PB)}),kB.visit(kB.ADD,function(PB){DB(PB,_B)?CB.push(PB):EB.set(PB._id,1)}),kB.visit(kB.MOD,wB),_B.modified()&&(AB=!1,kB.visit(kB.REFLOW,wB)),EB.empty>zB.cleanThreshold&&zB.runAfter(EB.clean),SB},Pk(kC,VS).transform=function(_B,kB){function wB(IB){for(var UB,$B=SB[IB._id]=Array(qB),jB=0;jB<qB;++jB)UB=$B[jB]=sS(IB),UB[DB]=PB[jB],UB[AB]=OB[jB](IB),LB.add.push(UB)}function zB(IB){for(var UB,$B=SB[IB._id],jB=0;jB<qB;++jB)FB&1<<jB&&(UB=lS(IB,$B[jB],MB),UB[DB]=PB[jB],UB[AB]=OB[jB](IB),LB.mod.push(UB))}var EB,SB=this.value,CB=_B.modified("fields"),OB=_B.fields,RB=_B.as||["key","value"],DB=RB[0],AB=RB[1],PB=OB.map(wC),qB=OB.length,MB=kB.stamp,LB=kB.fork(kB.NO_SOURCE),TB=0,FB=0;if(CB){for(EB in SB)LB.rem.push.apply(LB.rem,SB[EB]);SB=this.value={},kB.visit(kB.SOURCE,wB)}else{for(kB.visit(kB.ADD,wB);TB<qB;++TB)kB.modified(OB[TB].fields)&&(FB|=1<<TB);FB&&kB.visit(kB.MOD,zB),kB.visit(kB.REM,function(IB){LB.rem.push.apply(LB.rem,SB[IB._id]),SB[IB._id]=null})}return LB.modifies(RB)},Pk(zC,VS).transform=function(_B,kB){var zB=_B.expr,EB=_B.as,SB=_B.modified(),CB=_B.initonly?kB.ADD:SB?kB.SOURCE:kB.modified(zB.fields)?kB.ADD_MOD:kB.ADD;return SB&&(kB=kB.materialize().reflow(!0)),kB.visit(CB,function(OB){OB[EB]=zB(OB,_B)}).modifies(EB)},Pk(EC,VS).transform=function(_B,kB){var wB,zB,EB,SB=this.value,CB=kB.fork(kB.ALL),OB=_B.size-SB.length,RB=_B.generator;if(0<OB){for(wB=[];0<=--OB;)wB.push(EB=oS(RB(_B))),SB.push(EB);CB.add=CB.add.length?CB.materialize(CB.ADD).add.concat(wB):wB}else zB=SB.slice(0,-OB),CB.rem=CB.rem.length?CB.materialize(CB.REM).rem.concat(zB):zB,SB=SB.slice(-OB);return CB.source=this.value=SB,CB};var mU={value:"value",median:U_.median,mean:U_.mean,min:U_.min,max:U_.max},fU=[];Pk(SC,VS).transform=function(_B,kB){var wB,zB,EB,SB,CB,OB,RB,DB,AB,PB,qB=kB.fork(kB.ALL),MB=CC(_B),LB=OC(_B),TB=gk(_B.field),FB=_B.groupby.map(gk),IB=_B.orderby.map(gk),UB=RC(kB.source,_B.groupby,_B.orderby),$B=[],jB=this.value,NB=UB.domain.length;for(CB=0,DB=UB.length;CB<DB;++CB)for(wB=UB[CB],EB=wB.values,zB=NaN,RB=0;RB<NB;++RB)if(null==wB[RB]){for(SB=UB.domain[RB],PB={_impute:!0},OB=0,AB=EB.length;OB<AB;++OB)PB[FB[OB]]=EB[OB];for(OB=0,AB=SB.length;OB<AB;++OB)PB[IB[OB]]=SB[OB];PB[TB]=isNaN(zB)?zB=MB(wB,LB):zB,$B.push(oS(PB))}return $B.length&&(qB.add=qB.materialize(qB.ADD).add.concat($B)),jB.length&&(qB.rem=qB.materialize(qB.REM).rem.concat(jB)),this.value=$B,qB},Pk(DC,fS),Pk(PC,VS).transform=function(_B,kB){var wB,zB,EB,SB=kB,CB=_B.as,OB=_B.fields,RB=_B.index,DB=_B.values,AB=null==_B.default?null:_B.default,PB=_B.modified(),qB=PB?kB.SOURCE:kB.ADD,MB=OB.length;return DB?(zB=DB.length,1<MB&&!CB&&yk("Multi-field lookup requires explicit \"as\" parameter."),CB&&CB.length!==MB*zB&&yk("The \"as\" parameter has too few output field names."),CB=CB||DB.map(gk),wB=function(TB){for(var FB,LB,IB=0,UB=0;IB<MB;++IB)if(null==(LB=RB.get(OB[IB](TB))))for(FB=0;FB<zB;++FB,++UB)TB[CB[UB]]=AB;else for(FB=0;FB<zB;++FB,++UB)TB[CB[UB]]=DB[FB](LB)}):(CB||yk("Missing output field names."),wB=function(TB){for(var FB,LB=0;LB<MB;++LB)FB=RB.get(OB[LB](TB)),TB[CB[LB]]=null==FB?AB:FB}),PB?SB=kB.reflow(!0):(EB=OB.some(function(LB){return kB.modified(LB.fields)}),qB|=EB?kB.MOD:0),kB.visit(qB,wB),SB.modifies(CB)},Pk(qC,fS),Pk(LC,fS),Pk(FC,VS),FC.prototype.transform=function(_B,kB){return this.modified(_B.modified()),this.value=_B,kB.fork(kB.NO_SOURCE|kB.NO_FIELDS)},Pk(IC,vC).transform=function(_B,kB){var wB=this,zB=_B.subflow,EB=_B.field;return _B.modified("field")&&yk("PreFacet does not support field modification."),this._targets.active=0,kB.visit(kB.MOD,function(SB){var CB=wB.subflow(SB._id,zB,kB,SB);EB?EB(SB).forEach(function(OB){CB.mod(OB)}):CB.mod(SB)}),kB.visit(kB.ADD,function(SB){var CB=wB.subflow(SB._id,zB,kB,SB);EB?EB(SB).forEach(function(OB){CB.add(oS(OB))}):CB.add(SB)}),kB.visit(kB.REM,function(SB){var CB=wB.subflow(SB._id,zB,kB,SB);EB?EB(SB).forEach(function(OB){CB.rem(OB)}):CB.rem(SB)}),kB},Pk(UC,VS).transform=function(_B,kB){return this.value=_B.value,_B.modified("value")?kB.fork(kB.NO_SOURCE|kB.NO_FIELDS):kB.StopPropagation},Pk($C,VS).transform=function(_B,kB){kB.source||yk("Rank transform requires an upstream data source.");var wB,zB=_B.normalize,EB=_B.field,SB=_B.as||"rank",CB={},OB=-1;return EB?(kB.visit(kB.SOURCE,function(RB){var DB=EB(RB);null==CB[DB]&&(CB[DB]=++OB)}),kB.visit(kB.SOURCE,zB&&--OB?function(RB){RB[SB]=CB[EB(RB)]/OB}:function(RB){RB[SB]=CB[EB(RB)]})):(OB+=kB.source.length,wB=-1,kB.visit(kB.SOURCE,zB&&OB?function(RB){RB[SB]=++wB/OB}:function(RB){RB[SB]=++wB})),kB.reflow(_B.modified()).modifies(SB)},Pk(jC,VS).transform=function(_B,kB){var wB,zB=this.value||(wB=kB=kB.addAll(),this.value={});return _B.derive&&(wB=kB.fork(),kB.visit(kB.ADD,function(EB){var SB=sS(EB);zB[EB._id]=SB,wB.add.push(SB)}),kB.visit(kB.MOD,function(EB){wB.mod.push(lS(EB,zB[EB._id]))}),kB.visit(kB.REM,function(EB){wB.rem.push(zB[EB._id]),zB[EB._id]=null})),wB},Pk(NC,VS).transform=function(_B,kB){function wB(qB){var MB,LB;CB.length<SB?CB.push(qB):(LB=~~(OB*Math.random()))<CB.length&&LB>=RB&&(MB=CB[LB],DB[MB._id]&&zB.rem.push(MB),CB[LB]=qB),++OB}var zB=kB.fork(),EB=_B.modified("size"),SB=_B.size,CB=this.value,OB=this.count,RB=0,DB=CB.reduce(function(qB,MB){return qB[MB._id]=1,qB},{});if(kB.rem.length&&(kB.visit(kB.REM,function(qB){DB[qB._id]&&(DB[qB._id]=-1,zB.rem.push(qB)),--OB}),CB=CB.filter(function(qB){return-1!==DB[qB._id]})),(kB.rem.length||EB)&&CB.length<SB&&kB.source&&(RB=OB=CB.length,kB.visit(kB.SOURCE,function(qB){DB[qB._id]||wB(qB)}),RB=-1),EB&&CB.length>SB){for(var AB=0,PB=CB.length-SB;AB<PB;++AB)DB[CB[AB]._id]=-1,zB.rem.push(CB[AB]);CB=CB.slice(PB)}return kB.mod.length&&kB.visit(kB.MOD,function(qB){DB[qB._id]&&zB.mod.push(qB)}),kB.add.length&&kB.visit(kB.ADD,wB),(kB.add.length||0>RB)&&(zB.add=CB.filter(function(qB){return!DB[qB._id]})),this.count=OB,this.value=zB.source=CB,zB},Pk(WC,VS).transform=function(_B,kB){if(!this.value||_B.modified()){var wB=kB.materialize().fork(kB.MOD);return wB.rem=this.value?kB.rem.concat(this.value):kB.rem,wB.source=this.value=U_.range(_B.start,_B.stop,_B.step||1).map(oS),wB.add=kB.add.concat(this.value),wB}},Pk(BC,VS).transform=function(_B,kB){return this.value=kB.source,kB.changed()?kB.fork(kB.NO_SOURCE|kB.NO_FIELDS):kB.StopPropagation},Pk(GC,VS).transform=function(_B,kB){function wB(OB){SB.set(EB(OB),OB)}var zB=kB.dataflow,EB=_B.field,SB=this.value,CB=!0;return _B.modified("field")||kB.modified(EB.fields)?(SB.clear(),kB.visit(kB.SOURCE,wB)):kB.changed()?(kB.visit(kB.REM,function(OB){SB.delete(EB(OB))}),kB.visit(kB.ADD,wB)):CB=!1,this.modified(CB),SB.empty>zB.cleanThreshold&&zB.runAfter(SB.clean),kB.fork()},Pk(VC,VS).transform=function(_B,kB){(!this.value||_B.modified("field")||_B.modified("sort")||kB.changed()||_B.sort&&kB.modified(_B.sort.fields))&&(this.value=(_B.sort?kB.source.slice().sort(_B.sort):kB.source).map(_B.field))};var bU=[{key:{function:"normal"},params:[{name:"mean",type:"number",default:0},{name:"stdev",type:"number",default:1}]},{key:{function:"uniform"},params:[{name:"min",type:"number",default:0},{name:"max",type:"number",default:1}]},{key:{function:"kde"},params:[{name:"field",type:"field",required:!0},{name:"from",type:"data"},{name:"bandwidth",type:"number",default:0}]}],kU={type:"Density",metadata:{generates:!0,source:!0},params:[{name:"extent",type:"number",array:!0,length:2},{name:"steps",type:"number",default:100},{name:"method",type:"string",default:"pdf",values:["pdf","cdf"]},{name:"distribution",type:"param",params:bU.concat({key:{function:"mixture"},params:[{name:"distributions",type:"param",array:!0,params:bU},{name:"weights",type:"number",array:!0}]})},{name:"as",type:"string",array:!0,default:["value","density"]}]};HS({type:"Aggregate",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"fields",type:"field",array:!0},{name:"ops",type:"enum",array:!0,values:["count","valid","missing","distinct","sum","mean","average","variance","variancep","stdev","stdevp","stderr","median","q1","q3","ci0","ci1","min","max","argmin","argmax"]},{name:"as",type:"string",array:!0},{name:"drop",type:"boolean",default:!0},{name:"cross",type:"boolean",default:!1},{name:"key",type:"field"}]},aC),HS({type:"Bin",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"anchor",type:"number"},{name:"maxbins",type:"number",default:20},{name:"base",type:"number",default:10},{name:"divide",type:"number",array:!0,default:[5,2]},{name:"extent",type:"number",array:!0,length:2,required:!0},{name:"step",type:"number"},{name:"steps",type:"number",array:!0},{name:"minstep",type:"number",default:0},{name:"nice",type:"boolean",default:!0},{name:"name",type:"string"},{name:"as",type:"string",array:!0,length:2,default:["bin0","bin1"]}]},rC),HS({type:"Collect",metadata:{source:!0},params:[{name:"sort",type:"compare"}]},dC),HS({type:"CountPattern",metadata:{generates:!0,changes:!0},params:[{name:"field",type:"field",required:!0},{name:"case",type:"enum",values:["upper","lower","mixed"],default:"mixed"},{name:"pattern",type:"string",default:"[\\w\"]+"},{name:"stopwords",type:"string",default:""},{name:"as",type:"string",array:!0,length:2,default:["text","count"]}]},lC),HS({type:"Cross",metadata:{source:!0,generates:!0,changes:!0},params:[{name:"filter",type:"expr"},{name:"as",type:"string",array:!0,length:2,default:["a","b"]}]},pC),HS(kU,fC),HS({type:"Extent",metadata:{},params:[{name:"field",type:"field",required:!0}]},hC),HS({type:"Filter",metadata:{changes:!0},params:[{name:"expr",type:"expr",required:!0}]},_C),HS({type:"Fold",metadata:{generates:!0,changes:!0},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"as",type:"string",array:!0,length:2,default:["key","value"]}]},kC),HS({type:"Formula",metadata:{modifies:!0},params:[{name:"expr",type:"expr",required:!0},{name:"as",type:"string",required:!0},{name:"initonly",type:"boolean"}]},zC),HS({type:"Impute",metadata:{changes:!0},params:[{name:"field",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"orderby",type:"field",array:!0},{name:"method",type:"enum",default:"value",values:["value","mean","median","max","min"]},{name:"value",default:0}]},SC),HS({type:"Lookup",metadata:{modifies:!0},params:[{name:"index",type:"index",params:[{name:"from",type:"data",required:!0},{name:"key",type:"field",required:!0}]},{name:"values",type:"field",array:!0},{name:"fields",type:"field",array:!0,required:!0},{name:"as",type:"string",array:!0},{name:"default",default:null}]},PC),HS({type:"Rank",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"normalize",type:"boolean",default:!1},{name:"as",type:"string",default:"rank"}]},$C),HS({type:"Sample",metadata:{source:!0,changes:!0},params:[{name:"size",type:"number",default:1e3}]},NC),HS({type:"Sequence",metadata:{generates:!0,source:!0},params:[{name:"start",type:"number",required:!0},{name:"stop",type:"number",required:!0},{name:"step",type:"number",default:1}],output:["value"]},WC),XS("Compare",oC),XS("Facet",vC),XS("Field",xC),XS("Generate",EC),XS("Key",DC),XS("MultiExtent",qC),XS("MultiValues",LC),XS("Params",FC),XS("PreFacet",IC),XS("Proxy",UC),XS("Relay",jC),XS("Sieve",BC),XS("Subflow",yC),XS("TupleIndex",GC),XS("Values",VC);var PU=Array.prototype.map,qU=Array.prototype.slice,MU={identity:H_.scaleIdentity,linear:H_.scaleLinear,log:H_.scaleLog,ordinal:H_.scaleOrdinal,pow:H_.scalePow,sqrt:H_.scaleSqrt,quantile:H_.scaleQuantile,quantize:H_.scaleQuantize,threshold:H_.scaleThreshold,time:H_.scaleTime,utc:H_.scaleUtc,band:JC,point:function(){return QC(JC().paddingInner(1))},sequential:aO,"bin-linear":eO,"bin-ordinal":tO};for(var LU in MU)iO(LU,MU[LU]);var TU=rO("4c78a8f58518e4575672b7b254a24beeca3bb279a2ff9da69d755dbab0ac"),FU=rO("4c78a89ecae9f58518ffbf7954a24b88d27ab79a20f2cf5b43989483bcb6e45756ff9d9879706ebab0acd67195fcbfd2b279a2d6a5c99e765fd8b5a5"),IU=[,,,].concat("67a9cff7f7f7f1a340","0571b092c5defdb863e66101","0571b092c5def7f7f7fdb863e66101","2166ac67a9cfd1e5f0fee0b6f1a340b35806","2166ac67a9cfd1e5f0f7f7f7fee0b6f1a340b35806","2166ac4393c392c5ded1e5f0fee0b6fdb863e08214b35806","2166ac4393c392c5ded1e5f0f7f7f7fee0b6fdb863e08214b35806","0530612166ac4393c392c5ded1e5f0fee0b6fdb863e08214b358067f3b08","0530612166ac4393c392c5ded1e5f0f7f7f7fee0b6fdb863e08214b358067f3b08").map(rO),UU={blueorange:IU},$U={category10:H_.schemeCategory10,category20:H_.schemeCategory20,category20b:H_.schemeCategory20b,category20c:H_.schemeCategory20c,accent:Y_.schemeAccent,dark2:Y_.schemeDark2,paired:Y_.schemePaired,pastel1:Y_.schemePastel1,pastel2:Y_.schemePastel2,set1:Y_.schemeSet1,set2:Y_.schemeSet2,set3:Y_.schemeSet3,tableau10:TU,tableau20:FU,viridis:H_.interpolateViridis,magma:H_.interpolateMagma,inferno:H_.interpolateInferno,plasma:H_.interpolatePlasma,blueorange:X_.interpolateRgbBasis(jk(IU))};dO("blues","Blues"),dO("greens","Greens"),dO("greys","Greys"),dO("purples","Purples"),dO("reds","Reds"),dO("oranges","Oranges"),dO("brownbluegreen","BrBG"),dO("purplegreen","PRGn"),dO("pinkyellowgreen","PiYG"),dO("purpleorange","PuOr"),dO("redblue","RdBu"),dO("redgrey","RdGy"),dO("redyellowblue","RdYlBu"),dO("redyellowgreen","RdYlGn"),dO("spectral","Spectral"),dO("bluegreen","BuGn"),dO("bluepurple","BuPu"),dO("greenblue","GnBu"),dO("orangered","OrRd"),dO("purplebluegreen","PuBuGn"),dO("purpleblue","PuBu"),dO("purplered","PuRd"),dO("redpurple","RdPu"),dO("yellowgreenblue","YlGnBu"),dO("yellowgreen","YlGn"),dO("yelloworangebrown","YlOrBr"),dO("yelloworangered","YlOrRd");var jU=Array.prototype,NU=jU.slice,WU=[[],[[[1,1.5],[0.5,1]]],[[[1.5,1],[1,1.5]]],[[[1.5,1],[0.5,1]]],[[[1,0.5],[1.5,1]]],[[[1,0.5],[0.5,1]],[[1,1.5],[1.5,1]]],[[[1,0.5],[1,1.5]]],[[[1,0.5],[0.5,1]]],[[[0.5,1],[1,0.5]]],[[[1,1.5],[1,0.5]]],[[[0.5,1],[1,1.5]],[[1.5,1],[1,0.5]]],[[[1.5,1],[1,0.5]]],[[[0.5,1],[1.5,1]]],[[[1,1.5],[1.5,1]]],[[[0.5,1],[1,1.5]]],[]],BU=["values","size","thresholds"],GU=["x","y","size","cellSize","bandwidth","thresholds"];Pk(OO,VS).transform=function(_B,kB){if(this.value&&!kB.changed()&&!_B.modified())return kB.StopPropagation;var wB,zB,EB,SB=kB.fork(kB.NO_SOURCE|kB.NO_FIELDS);return _B.values?(wB=kO(),zB=BU,EB=_B.values):(wB=CO(),zB=GU,EB=kB.materialize(kB.SOURCE).source),zB.forEach(function(CB){null!=_B[CB]&&wB[CB](_B[CB])}),this.value&&(SB.rem=this.value),this.value=SB.source=SB.add=wB(EB).map(oS),SB};var VU=J_.geoPath(),HU=["clipAngle","clipExtent","scale","translate","center","rotate","parallels","precision","coefficient","distance","fraction","lobes","parallel","radius","ratio","spacing","tilt"],YU={albers:J_.geoAlbers,albersusa:J_.geoAlbersUsa,azimuthalequalarea:J_.geoAzimuthalEqualArea,azimuthalequidistant:J_.geoAzimuthalEquidistant,conicconformal:J_.geoConicConformal,conicequalarea:J_.geoConicEqualArea,conicequidistant:J_.geoConicEquidistant,equirectangular:J_.geoEquirectangular,gnomonic:J_.geoGnomonic,mercator:J_.geoMercator,orthographic:J_.geoOrthographic,stereographic:J_.geoStereographic,transversemercator:J_.geoTransverseMercator};for(var XU in YU)DO(XU,YU[XU]);Pk(PO,VS).transform=function(_B,kB){function wB(RB){RB[OB]=SB(CB(RB))}var zB,EB=kB.fork(kB.ALL),SB=this.value,CB=_B.field||tF,OB=_B.as||"path";return!SB||_B.modified()?(this.value=SB=AO(_B.projection),EB.materialize().reflow().visit(EB.SOURCE,wB)):(zB=CB===tF||kB.modified(CB.fields),EB.visit(zB?EB.ADD_MOD:EB.ADD,wB)),EB.modifies(OB)},Pk(qO,VS).transform=function(_B,kB){function wB(AB){var PB=EB([SB(AB),CB(AB)]);PB?(AB[RB]=PB[0],AB[DB]=PB[1]):(AB[RB]=void 0,AB[DB]=void 0)}var zB,EB=_B.projection,SB=_B.fields[0],CB=_B.fields[1],OB=_B.as||["x","y"],RB=OB[0],DB=OB[1];return _B.modified()?kB.materialize().reflow(!0).visit(kB.SOURCE,wB):(zB=kB.modified(SB.fields)||kB.modified(CB.fields),kB.visit(zB?kB.ADD_MOD:kB.ADD,wB)),kB.modifies(OB)},Pk(MO,VS).transform=function(_B,kB){var wB=kB.fork(kB.ALL),zB=this.value,EB=_B.field||kk("datum"),SB=_B.as||"shape",CB=wB.ADD_MOD;return zB&&!_B.modified()||(this.value=zB=LO(AO(_B.projection),EB),wB.materialize().reflow(),CB=wB.SOURCE),wB.visit(CB,function(OB){OB[SB]=zB}),wB.modifies(SB)},Pk(TO,VS).transform=function(_B,kB){var wB,zB=kB.fork(),EB=this.value,SB=this.generator;if(!EB.length||_B.modified())for(var CB in _B)Ck(SB[CB])&&SB[CB](_B[CB]);return wB=SB(),EB.length?(wB._id=EB[0]._id,zB.mod.push(wB)):zB.add.push(oS(wB)),EB[0]=wB,zB.source=EB,zB},Pk(FO,VS).transform=function(_B){var kB=this.value;!kB||_B.modified("type")?(this.value=kB=$O(_B.type),HU.forEach(function(wB){null!=_B[wB]&&jO(kB,wB,_B[wB])})):HU.forEach(function(wB){_B.modified(wB)&&jO(kB,wB,_B[wB])}),null!=_B.pointRadius&&kB.path.pointRadius(_B.pointRadius),_B.fit&&IO(kB,_B)};HS({type:"Contour",metadata:{generates:!0,source:!0},params:[{name:"size",type:"number",array:!0,length:2,required:!0},{name:"values",type:"number",array:!0},{name:"x",type:"field"},{name:"y",type:"field"},{name:"cellSize",type:"number"},{name:"bandwidth",type:"number"},{name:"thresholds",type:"number"}]},OO),HS({type:"GeoPath",metadata:{modifies:!0},params:[{name:"projection",type:"projection"},{name:"field",type:"field"},{name:"as",type:"string",default:"path"}]},PO),HS({type:"GeoPoint",metadata:{modifies:!0},params:[{name:"projection",type:"projection",required:!0},{name:"fields",type:"field",array:!0,required:!0,length:2},{name:"as",type:"string",array:!0,length:2,default:["x","y"]}]},qO),HS({type:"GeoShape",metadata:{modifies:!0},params:[{name:"projection",type:"projection"},{name:"field",type:"field",default:"datum"},{name:"as",type:"string",default:"shape"}]},MO),HS({type:"Graticule",metadata:{source:!0,generates:!0,changes:!0},params:[{name:"extent",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"extentMajor",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"extentMinor",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"step",type:"number",array:!0,length:2},{name:"stepMajor",type:"number",array:!0,length:2,default:[90,360]},{name:"stepMinor",type:"number",array:!0,length:2,default:[10,10]},{name:"precision",type:"number",default:2.5}]},TO),XS("Projection",FO);var t$="log",a$="band",n$="point",i$="ordinal",r$="quantile",d$="quantize",o$="threshold",s$="bin-ordinal",l$="sequential";Pk(YO,VS).transform=function(_B,kB){if(this.value&&!_B.modified())return kB.StopPropagation;var wB=kB.fork(kB.NO_SOURCE|kB.NO_FIELDS),zB=this.value,EB=_B.scale,SB=_B.count,CB=_B.format||WO(EB,SB,_B.formatSpecifier),OB=_B.values||NO(EB,SB);return zB&&(wB.rem=zB),zB=OB.map(function(RB){return oS({value:RB,label:CB(RB)})}),_B.extra&&zB.push(oS({extra:{value:zB[0].value},label:""})),wB.source=wB.add=this.value=zB,wB},Pk(XO,VS).transform=function(_B,kB){var wB=kB.dataflow,zB=kB.fork(kB.NO_SOURCE|kB.NO_FIELDS),EB=_B.item||JO,SB=_B.key||rS,CB=this.value;return CB||(kB=kB.addAll(),this.value=CB=Ak().test(QO),CB.lookup=function(OB){return CB.get(SB(OB))}),(_B.modified("key")||kB.modified(SB))&&yk("DataJoin does not support modified key function or fields."),kB.visit(kB.ADD,function(OB){var RB=SB(OB),DB=CB.get(RB);DB?(DB.exit?(--CB.empty,zB.add):zB.mod).push(DB):(CB.set(RB,DB=EB(OB)),zB.add.push(DB)),DB.datum=OB,DB.exit=!1}),kB.visit(kB.MOD,function(OB){var RB=SB(OB),DB=CB.get(RB);DB&&(DB.datum=OB,zB.mod.push(DB))}),kB.visit(kB.REM,function(OB){var RB=SB(OB),DB=CB.get(RB);OB!==DB.datum||DB.exit||(zB.rem.push(DB),DB.exit=!0,++CB.empty)}),kB.changed(kB.ADD_MOD)&&zB.modifies("datum"),_B.clean&&CB.empty>wB.cleanThreshold&&wB.runAfter(CB.clean),zB},Pk(KO,VS).transform=function(_B,kB){var wB=kB.fork(kB.ADD_REM),zB=kB.encode,EB="enter"===zB,SB=_B.encoders.update||rF,CB=_B.encoders.enter||rF,OB=_B.encoders.exit||rF,RB=(zB&&!EB?_B.encoders[zB]:SB)||rF;if(kB.changed(kB.ADD)&&(kB.visit(kB.ADD,function(AB){CB(AB,_B),SB(AB,_B),RB!==rF&&RB!==SB&&RB(AB,_B)}),wB.modifies(CB.output),wB.modifies(SB.output),RB!==rF&&RB!==SB&&wB.modifies(RB.output)),kB.changed(kB.REM)&&OB!==rF&&(kB.visit(kB.REM,function(AB){OB(AB,_B)}),wB.modifies(OB.output)),EB||RB!==rF){var DB=kB.MOD|(_B.modified()?kB.REFLOW:0);EB?(kB.visit(DB,function(AB){var PB=CB(AB,_B);(RB(AB,_B)||PB)&&wB.mod.push(AB)}),wB.mod.length&&wB.modifies(CB.output)):kB.visit(DB,function(AB){RB(AB,_B)&&wB.mod.push(AB)}),wB.mod.length&&wB.modifies(RB.output)}return wB};var u$={};u$[r$]=function(_B){var kB=_B.domain(),wB=[kB[0]].concat(_B.quantiles());return wB.max=jk(kB),wB},u$[d$]=function(_B){var kB=_B.domain(),wB=kB[0],zB=jk(kB),EB=_B.range().length,SB=Array(EB),CB=0;for(SB[0]=wB;++CB<EB;)SB[CB]=(CB*zB-(CB-EB)*wB)/EB;return SB.max=zB,SB},u$[o$]=function(_B){var kB=[-Infinity].concat(_B.domain());return kB.max=1/0,kB},u$["bin-linear"]=nR,u$[s$]=nR,Pk(sR,VS).transform=function(_B,kB){if(null!=this.value&&!_B.modified())return kB.StopPropagation;var wB=kB.fork(kB.NO_SOURCE|kB.NO_FIELDS),zB=0,EB=this.value,SB="gradient"===_B.type,CB=_B.scale,OB=null==_B.count?5:_B.count,RB=_B.format||WO(CB,OB,_B.formatSpecifier),DB=_B.values||ZO(CB,OB,SB);if(RB=iR(CB,RB),EB&&(wB.rem=EB),SB)var AB=_B.values?CB.domain():DB,PB=lO(CB,AB[0],jk(AB));else{var qB,MB=_B.size;Ck(MB)?(_B.values||0!==CB(DB[0])||(DB=DB.slice(1)),qB=DB.reduce(function(LB,TB){return Math.max(LB,MB(TB,_B))},0)):MB=Ok(qB=MB||8)}return EB=DB.map(function(LB,TB){var FB=oS({index:TB,label:RB(LB,TB,DB),value:LB});return SB?FB.perc=PB(LB):(FB.offset=qB,FB.size=MB(LB,_B),FB.total=Math.round(zB),zB+=FB.size),FB}),wB.source=wB.add=this.value=EB,wB};var p$=Ak({line:fR,"line-radial":function(_B,kB,wB,zB){return fR(kB*Math.cos(_B),kB*Math.sin(_B),zB*Math.cos(wB),zB*Math.sin(wB))},arc:hR,"arc-radial":function(_B,kB,wB,zB){return hR(kB*Math.cos(_B),kB*Math.sin(_B),zB*Math.cos(wB),zB*Math.sin(wB))},curve:vR,"curve-radial":function(_B,kB,wB,zB){return vR(kB*Math.cos(_B),kB*Math.sin(_B),zB*Math.cos(wB),zB*Math.sin(wB))},"orthogonal-horizontal":function(_B,kB,wB,zB){return"M"+_B+","+kB+"V"+zB+"H"+wB},"orthogonal-vertical":function(_B,kB,wB,zB){return"M"+_B+","+kB+"H"+wB+"V"+zB},"orthogonal-radial":function(_B,kB,wB,zB){var EB=Math.cos(_B),SB=Math.sin(_B),CB=Math.cos(wB),OB=Math.sin(wB);return"M"+kB*EB+","+kB*SB+"A"+kB+","+kB+" 0 0,"+((Math.abs(wB-_B)>Math.PI?wB<=_B:wB>_B)?1:0)+" "+kB*CB+","+kB*OB+"L"+zB*CB+","+zB*OB},"diagonal-horizontal":function(_B,kB,wB,zB){var EB=(_B+wB)/2;return"M"+_B+","+kB+"C"+EB+","+kB+" "+EB+","+zB+" "+wB+","+zB},"diagonal-vertical":function(_B,kB,wB,zB){var EB=(kB+zB)/2;return"M"+_B+","+kB+"C"+_B+","+EB+" "+wB+","+EB+" "+wB+","+zB},"diagonal-radial":function(_B,kB,wB,zB){var EB=Math.cos(_B),SB=Math.sin(_B),CB=Math.cos(wB),OB=Math.sin(wB),RB=(kB+zB)/2;return"M"+kB*EB+","+kB*SB+"C"+RB*EB+","+RB*SB+" "+RB*CB+","+RB*OB+" "+zB*CB+","+zB*OB}});Pk(mR,VS).transform=function(_B,kB){var wB=_B.sourceX||lR,zB=_B.sourceY||uR,EB=_B.targetX||pR,SB=_B.targetY||cR,CB=_B.as||"path",OB=_B.orient||"vertical",RB=_B.shape||"line",DB=p$.get(RB+"-"+OB)||p$.get(RB);return DB||yk("LinkPath unsupported type: "+_B.shape+(_B.orient?"-"+_B.orient:"")),kB.visit(kB.SOURCE,function(AB){AB[CB]=DB(wB(AB),zB(AB),EB(AB),SB(AB))}),kB.reflow(_B.modified()).modifies(CB)},Pk(SR,VS).transform=function(_B,kB){var wB,zB,EB,SB=_B.as||["startAngle","endAngle"],CB=SB[0],OB=SB[1],RB=_B.field||nF,DB=_B.startAngle||0,AB=null==_B.endAngle?2*Math.PI:_B.endAngle,PB=kB.source,qB=PB.map(RB),MB=qB.length,LB=DB,TB=(AB-DB)/U_.sum(qB),FB=U_.range(MB);for(_B.sort&&FB.sort(function(IB,UB){return qB[IB]-qB[UB]}),wB=0;wB<MB;++wB)EB=qB[FB[wB]],zB=PB[FB[wB]],zB[CB]=LB,zB[OB]=LB+=EB*TB;return this.value=qB,kB.reflow(_B.modified()).modifies(SB)};var c$=5,m$=Vk(["linear","pow","sqrt"]),f$=Vk(["set","modified","clear","type","scheme","schemeExtent","schemeCount","domain","domainMin","domainMid","domainMax","domainRaw","nice","zero","range","rangeStep","round","reverse","interpolate","interpolateGamma"]);Pk(CR,VS).transform=function(_B,kB){var wB,zB=kB.dataflow,EB=this.value;for(wB in EB&&!_B.modified("type")||(this.value=EB=iO((_B.type||"linear").toLowerCase())()),_B)f$[wB]||(Ck(EB[wB])?EB[wB](_B[wB]):zB.warn("Unsupported scale property: "+wB));return DR(EB,_B,OR(EB,_B)),kB.fork(kB.NO_SOURCE|kB.NO_FIELDS)},Pk(TR,VS).transform=function(_B,kB){var wB=_B.modified("sort")||kB.changed(kB.ADD)||kB.modified(_B.sort.fields)||kB.modified("datum");return wB&&kB.source.sort(_B.sort),this.modified(wB),kB},Pk(FR,VS).transform=function(_B,kB){var wB,zB,EB,SB,CB=_B.as||["y0","y1"],OB=CB[0],RB=CB[1],DB=_B.field||nF,AB="center"===_B.offset?IR:"normalize"===_B.offset?UR:$R;for(wB=jR(kB.source,_B.groupby,_B.sort,DB),zB=0,EB=wB.length,SB=wB.max;zB<EB;++zB)AB(wB[zB],SB,DB,OB,RB);return kB.reflow(_B.modified()).modifies(CB)};HS({type:"LinkPath",metadata:{modifies:!0},params:[{name:"sourceX",type:"field",default:"source.x"},{name:"sourceY",type:"field",default:"source.y"},{name:"targetX",type:"field",default:"target.x"},{name:"targetY",type:"field",default:"target.y"},{name:"orient",type:"enum",default:"vertical",values:["horizontal","vertical","radial"]},{name:"shape",type:"enum",default:"line",values:["line","arc","curve","diagonal","orthogonal"]},{name:"as",type:"string",default:"path"}]},mR),HS({type:"Pie",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"startAngle",type:"number",default:0},{name:"endAngle",type:"number",default:6.283185307179586},{name:"sort",type:"boolean",default:!1},{name:"as",type:"string",array:!0,length:2,default:["startAngle","endAngle"]}]},SR),HS({type:"Stack",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"groupby",type:"field",array:!0},{name:"sort",type:"compare"},{name:"offset",type:"enum",default:"zero",values:["zero","center","normalize"]},{name:"as",type:"string",array:!0,length:2,default:["y0","y1"]}]},FR),XS("AxisTicks",YO),XS("DataJoin",XO),XS("Encode",KO),XS("LegendEntries",sR),XS("Scale",CR),XS("SortItems",TR);var v$={center:K_.forceCenter,collide:K_.forceCollide,nbody:K_.forceManyBody,link:K_.forceLink,x:K_.forceX,y:K_.forceY},x$="forces",b$=["alpha","alphaMin","alphaTarget","velocityDecay","forces"],_$=["static","iterations"],k$=["x","y","vx","vy"],w$=Pk(NR,VS);w$.transform=function(_B,kB){var wB=this.value,zB=kB.changed(kB.ADD_REM),EB=_B.modified(b$),SB=_B.iterations||300;if(wB?(zB&&(kB.modifies("index"),wB.nodes(kB.source)),EB&&GR(wB,_B)):(this.value=wB=BR(kB.source,_B),wB.on("tick",WR(kB.dataflow,this)),_B.static||(zB=!0,wB.tick()),kB.modifies("index")),EB||zB||_B.modified(_$)||kB.changed()&&_B.restart)if(wB.alpha(Math.max(wB.alpha(),_B.alpha||1)).alphaDecay(1-Math.pow(wB.alphaMin(),1/SB)),_B.static)for(wB.stop();0<=--SB;)wB.tick();else if(wB.stopped()&&wB.restart(),!zB)return kB.StopPropagation;return this.finish(_B,kB)},w$.finish=function(_B,kB){for(var wB,zB=kB.dataflow,EB=this._argops,SB=0,CB=EB.length;SB<CB;++SB)if(wB=EB[SB],wB.name===x$&&"link"===wB.op._argval.force)for(var OB,RB=wB.op._argops,DB=0,AB=RB.length;DB<AB;++DB)if("links"===RB[DB].name&&(OB=RB[DB].op.source)){zB.touch(OB);break}return kB.reflow(_B.modified()).modifies(k$)},HS({type:"Force",metadata:{modifies:!0},params:[{name:"static",type:"boolean",default:!1},{name:"restart",type:"boolean",default:!1},{name:"iterations",type:"number",default:300},{name:"alpha",type:"number",default:1},{name:"alphaMin",type:"number",default:.001},{name:"alphaTarget",type:"number",default:0},{name:"velocityDecay",type:"number",default:.4},{name:"forces",type:"param",array:!0,params:[{key:{force:"center"},params:[{name:"x",type:"number",default:0},{name:"y",type:"number",default:0}]},{key:{force:"collide"},params:[{name:"radius",type:"number",expr:!0},{name:"strength",type:"number",default:.7},{name:"iterations",type:"number",default:1}]},{key:{force:"nbody"},params:[{name:"strength",type:"number",default:-30},{name:"theta",type:"number",default:.9},{name:"distanceMin",type:"number",default:1},{name:"distanceMax",type:"number"}]},{key:{force:"link"},params:[{name:"links",type:"data"},{name:"id",type:"field"},{name:"distance",type:"number",default:30,expr:!0},{name:"strength",type:"number",expr:!0},{name:"iterations",type:"number",default:1}]},{key:{force:"x"},params:[{name:"strength",type:"number",default:.1},{name:"x",type:"field"}]},{key:{force:"y"},params:[{name:"strength",type:"number",default:.1},{name:"y",type:"field"}]}]},{name:"as",type:"string",array:!0,modify:!1,default:["x","y","vx","vy"]}]},NR),Pk(HR,VS).transform=function(_B,kB){kB.source||yk("Nest transform requires an upstream data source.");var wB,zB,EB,SB,CB=_B.key||rS;return(!this.value||(SB=_B.modified())||kB.changed())&&(wB=Ek(_B.keys).reduce(function(OB,RB){return OB.key(RB),OB},Z_.nest()).entries(kB.source),zB=ek.hierarchy({values:wB},YR),EB=zB.lookup={},zB.each(function(OB){null!=rS(OB.data)&&(EB[CB(OB.data)]=OB)}),this.value=zB),kB.source.root=this.value,SB?kB.fork(kB.ALL):kB},Pk(XR,VS).transform=function(_B,kB){kB.source||yk("Stratify transform requires an upstream data source.");var wB,zB,EB=_B.modified();return(!this.value||EB||kB.changed(kB.ADD_REM)||kB.modified(_B.key.fields)||kB.modified(_B.parentKey.fields))&&(wB=ek.stratify().id(_B.key).parentId(_B.parentKey)(kB.source),zB=wB.lookup={},wB.each(function(SB){zB[_B.key(SB.data)]=SB}),this.value=wB),kB.source.root=this.value,EB?kB.fork(kB.ALL):kB},Pk(JR,VS).transform=function(_B,kB){function wB(DB){var AB=SB[DB];AB&&(OB[DB]=1,RB.mod.push(AB))}kB.source&&kB.source.root||yk("TreeLinks transform requires a backing tree data source.");var zB=kB.source.root,EB=zB.lookup,SB=this.value,CB=_B.key||rS,OB={},RB=kB.fork();return kB.visit(kB.REM,function(DB){var AB=CB(DB),PB=SB[AB];PB&&(delete SB[AB],RB.rem.push(PB))}),kB.visit(kB.ADD,function(DB){var AB,PB=CB(DB);(AB=QR(EB[PB]))&&(RB.add.push(SB[PB]=oS({source:AB,target:DB})),OB[PB]=1)}),kB.visit(kB.MOD,function(DB){var AB=CB(DB),PB=EB[AB],qB=PB.children;if(wB(AB),qB)for(var MB=0,LB=qB.length;MB<LB;++MB)OB[AB=CB(qB[MB].data)]||wB(AB)}),RB};var z$={binary:ek.treemapBinary,dice:ek.treemapDice,slice:ek.treemapSlice,slicedice:ek.treemapSliceDice,squarify:ek.treemapSquarify,resquarify:ek.treemapResquarify},E$={tidy:ek.tree,cluster:ek.cluster};Pk(eD,VS).transform=function(_B,kB){kB.source&&kB.source.root||yk(this.constructor.name+" transform requires a backing tree data source.");var wB=this.layout(_B.method),zB=this.fields,EB=kB.source.root,SB=_B.as||zB;_B.field&&EB.sum(_B.field),_B.sort&&EB.sort(_B.sort),tD(wB,this.params,_B);try{this.value=wB(EB)}catch(CB){yk(CB)}return EB.each(function(CB){aD(CB,zB,SB)}),kB.reflow(_B.modified()).modifies(SB).modifies("leaf")},Pk(nD,eD),nD.prototype.layout=function(_B){var kB=_B||"tidy";return E$.hasOwnProperty(kB)?E$[kB]():void yk("Unrecognized Tree layout method: "+kB)},nD.prototype.params=["size","nodeSize","separation"],nD.prototype.fields=["x","y","depth","children"],Pk(iD,eD),iD.prototype.layout=function(){var _B=ek.treemap();return _B.ratio=function(kB){var wB=_B.tile();wB.ratio&&_B.tile(wB.ratio(kB))},_B.method=function(kB){z$.hasOwnProperty(kB)?_B.tile(z$[kB]):yk("Unrecognized Treemap layout method: "+kB)},_B},iD.prototype.params=["method","ratio","size","round","padding","paddingInner","paddingOuter","paddingTop","paddingRight","paddingBottom","paddingLeft"],iD.prototype.fields=["x0","y0","x1","y1","depth","children"],Pk(rD,eD),rD.prototype.layout=ek.partition,rD.prototype.params=["size","round","padding"],rD.prototype.fields=iD.prototype.fields,Pk(dD,eD),dD.prototype.layout=ek.pack,dD.prototype.params=["size","padding"],dD.prototype.fields=["x","y","r","depth","children"];HS({type:"Nest",metadata:{treesource:!0},params:[{name:"keys",type:"field",array:!0},{name:"key",type:"field"}]},HR),HS({type:"Stratify",metadata:{treesource:!0},params:[{name:"key",type:"field",required:!0},{name:"parentKey",type:"field",required:!0}]},XR),HS({type:"TreeLinks",metadata:{tree:!0,generates:!0,changes:!0},params:[{name:"key",type:"field"}]},JR),HS({type:"Pack",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"padding",type:"number",default:0},{name:"radius",type:"field",default:null},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:3,default:["x","y","r","depth","children"]}]},dD),HS({type:"Partition",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"padding",type:"number",default:0},{name:"round",type:"boolean",default:!1},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:4,default:["x0","y0","x1","y1","depth","children"]}]},rD),HS({type:"Tree",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"method",type:"enum",default:"tidy",values:["tidy","cluster"]},{name:"size",type:"number",array:!0,length:2},{name:"nodeSize",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:4,default:["x","y","depth","children"]}]},nD),HS({type:"Treemap",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"method",type:"enum",default:"squarify",values:["squarify","resquarify","binary","dice","slice","slicedice"]},{name:"padding",type:"number",default:0},{name:"paddingInner",type:"number",default:0},{name:"paddingOuter",type:"number",default:0},{name:"paddingTop",type:"number",default:0},{name:"paddingRight",type:"number",default:0},{name:"paddingBottom",type:"number",default:0},{name:"paddingLeft",type:"number",default:0},{name:"ratio",type:"number",default:1.618033988749895},{name:"round",type:"boolean",default:!1},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:4,default:["x0","y0","x1","y1","depth","children"]}]},iD);var q$=[[-100000,-100000],[100000,100000]];Pk(oD,VS).transform=function(_B,kB){var wB,zB,EB,SB,CB=_B.as||"path",OB=kB.source;for(wB=tk.voronoi().x(_B.x).y(_B.y),_B.size?wB.size(_B.size):wB.extent(_B.extent||q$),this.value=wB=wB(OB),zB=wB.polygons(),EB=0,SB=OB.length;EB<SB;++EB)OB[EB][CB]=zB[EB]?"M"+zB[EB].join("L")+"Z":null;return kB.reflow(_B.modified()).modifies(CB)},HS({type:"Voronoi",metadata:{modifies:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"size",type:"number",array:!0,length:2},{name:"extent",type:"array",array:!0,length:2,default:[[-100000,-100000],[100000,100000]],content:{type:"number",array:!0,length:2}},{name:"as",type:"string",default:"path"}]},oD);var M$=Math.PI/180,L$=64,T$=2048,F$={archimedean:mD,rectangular:function(_B){var kB=4*_B[0]/_B[1],wB=0,zB=0;return function(EB){var SB=0>EB?-1:1;switch(3&Math.sqrt(1+4*SB*EB)-SB){case 0:wB+=kB;break;case 1:zB+=4;break;case 2:wB-=kB;break;default:zB-=4;}return[wB,zB]}}},I$=["x","y","font","fontSize","fontStyle","fontWeight","angle"],U$=["text","font","rotate","fontSize","fontStyle","fontWeight"];Pk(vD,VS).transform=function(_B,kB){var zB=_B.modified();if(zB||kB.changed(kB.ADD_REM)||U$.some(function($B){var jB=_B[$B];return Ck(jB)&&kB.modified(jB.fields)})){var EB,SB=this.value,CB=_B.as||I$,OB=_B.fontSize||14;if(Ck(OB)?EB=_B.fontSizeRange:OB=Ok(OB),EB){var RB=OB,DB=iO("sqrt")().domain(xD(RB,kB)).range(EB);OB=function(jB){return DB(RB(jB))}}var AB=kB.materialize(kB.SOURCE).source;AB.forEach(function($B){$B[CB[0]]=NaN,$B[CB[1]]=NaN,$B[CB[3]]=0});for(var PB,qB,MB=SB.words(AB).text(_B.text).size(_B.size||[500,500]).padding(_B.padding||1).spiral(_B.spiral||"archimedean").rotate(_B.rotate||0).font(_B.font||"sans-serif").fontStyle(_B.fontStyle||"normal").fontWeight(_B.fontWeight||"normal").fontSize(OB).layout(),LB=SB.size(),TB=LB[0]>>1,FB=LB[1]>>1,IB=0,UB=MB.length;IB<UB;++IB)PB=MB[IB],qB=PB.datum,qB[CB[0]]=PB.x+TB,qB[CB[1]]=PB.y+FB,qB[CB[2]]=PB.font,qB[CB[3]]=PB.size,qB[CB[4]]=PB.style,qB[CB[5]]=PB.weight,qB[CB[6]]=PB.rotate;return kB.reflow(zB).modifies(CB)}},HS({type:"Wordcloud",metadata:{modifies:!0},params:[{name:"size",type:"number",array:!0,length:2},{name:"font",type:"string",expr:!0,default:"sans-serif"},{name:"fontStyle",type:"string",expr:!0,default:"normal"},{name:"fontWeight",type:"string",expr:!0,default:"normal"},{name:"fontSize",type:"number",expr:!0,default:14},{name:"fontSizeRange",type:"number",array:!0,null:!0,default:[10,50]},{name:"rotate",type:"number",expr:!0,default:0},{name:"text",type:"field"},{name:"spiral",type:"string",values:["archimedean","rectangular"]},{name:"padding",type:"number",expr:!0},{name:"as",type:"string",array:!0,length:7,default:["x","y","font","fontSize","fontStyle","fontWeight","angle"]}]},vD);var $$=Pk(DD,VS);$$.transform=function(_B,kB){return this._dims?_B.modified("fields")||_B.fields.some(function(wB){return kB.modified(wB.fields)})?this.reinit(_B,kB):this.eval(_B,kB):this.init(_B,kB)},$$.init=function(_B,kB){for(var wB,zB,EB=_B.fields,SB=_B.query,CB=this._indices={},OB=this._dims=[],RB=SB.length,DB=0;DB<RB;++DB)wB=EB[DB].fname,zB=CB[wB]||(CB[wB]=CD()),OB.push(SD(zB,DB,SB[DB]));return this.eval(_B,kB)},$$.reinit=function(_B,kB){var wB,zB,EB,SB,CB,OB,RB,DB,AB,PB=kB.materialize().fork(),qB=_B.fields,MB=_B.query,LB=this._indices,TB=this._dims,FB=this.value,IB=FB.curr(),UB=FB.prev(),$B=FB.all(),jB=PB.rem=PB.add,NB=PB.mod,WB=MB.length,BB={};if(UB.set(IB),kB.rem.length&&(CB=this.remove(_B,kB,PB)),kB.add.length&&FB.add(kB.add),kB.mod.length)for(OB={},SB=kB.mod,RB=0,DB=SB.length;RB<DB;++RB)OB[SB[RB]._index]=1;for(RB=0;RB<WB;++RB)AB=qB[RB],(!TB[RB]||_B.modified("fields",RB)||kB.modified(AB.fields))&&(EB=AB.fname,(wB=BB[EB])||(LB[EB]=zB=CD(),BB[EB]=wB=zB.insert(AB,kB.source,0)),TB[RB]=SD(zB,RB,MB[RB]).onAdd(wB,IB));for(RB=0,DB=FB.data().length;RB<DB;++RB)CB[RB]||(UB[RB]===IB[RB]?OB[RB]&&IB[RB]!==$B&&NB.push(RB):jB.push(RB));return FB.mask=(1<<WB)-1,PB},$$.eval=function(_B,kB){var wB=kB.materialize().fork(),zB=this._dims.length,EB=0;return kB.rem.length&&(this.remove(_B,kB,wB),EB|=(1<<zB)-1),_B.modified("query")&&!_B.modified("fields")&&(EB|=this.update(_B,kB,wB)),kB.add.length&&(this.insert(_B,kB,wB),EB|=(1<<zB)-1),kB.mod.length&&(this.modify(kB,wB),EB|=(1<<zB)-1),this.value.mask=EB,wB},$$.insert=function(_B,kB,wB){var zB,EB,SB,CB=kB.add,OB=this.value,RB=this._dims,DB=this._indices,AB=_B.fields,PB={},qB=wB.add,MB=OB.size(),LB=MB+CB.length,TB=RB.length;OB.resize(LB,TB),OB.add(CB);var FB=OB.curr(),IB=OB.prev(),UB=OB.all();for(zB=0;zB<TB;++zB)EB=AB[zB].fname,SB=PB[EB]||(PB[EB]=DB[EB].insert(AB[zB],CB,MB)),RB[zB].onAdd(SB,FB);for(;MB<LB;++MB)IB[MB]=UB,FB[MB]!==UB&&qB.push(MB)},$$.modify=function(_B,kB){var wB,zB,EB,SB=kB.mod,CB=this.value,OB=CB.curr(),RB=CB.all(),DB=_B.mod;for(wB=0,zB=DB.length;wB<zB;++wB)EB=DB[wB]._index,OB[EB]!==RB&&SB.push(EB)},$$.remove=function(_B,kB,wB){var zB,EB,SB,CB,OB=this._indices,RB=this.value,DB=RB.curr(),AB=RB.prev(),PB=RB.all(),qB={},MB=wB.rem,LB=kB.rem;for(zB=0,EB=LB.length;zB<EB;++zB)SB=LB[zB]._index,qB[SB]=1,AB[SB]=CB=DB[SB],DB[SB]=PB,CB!==PB&&MB.push(SB);for(SB in OB)OB[SB].remove(EB,qB);return this.reindex(kB,EB,qB),qB},$$.reindex=function(_B,kB,wB){var zB=this._indices,EB=this.value;_B.runAfter(function(){var SB=EB.remove(kB,wB);for(var CB in zB)zB[CB].reindex(SB)})},$$.update=function(_B,kB,wB){var zB,EB,SB=this._dims,CB=_B.query,OB=kB.stamp,RB=SB.length,DB=0;for(wB.filters=0,EB=0;EB<RB;++EB)_B.modified("query",EB)&&(zB=EB,++DB);if(1===DB)DB=SB[zB].one,this.incrementOne(SB[zB],CB[zB],wB.add,wB.rem);else for(EB=0,DB=0;EB<RB;++EB)_B.modified("query",EB)&&(DB|=SB[EB].one,this.incrementAll(SB[EB],CB[EB],OB,wB.add),wB.rem=wB.add);return DB},$$.incrementAll=function(_B,kB,wB,zB){var EB,SB,CB,OB=this.value,RB=OB.seen(),DB=OB.curr(),AB=OB.prev(),PB=_B.index(),qB=_B.bisect(_B.range),MB=_B.bisect(kB),LB=MB[0],TB=MB[1],FB=qB[0],IB=qB[1],UB=_B.one;if(LB<FB)for(EB=LB,SB=Math.min(FB,TB);EB<SB;++EB)CB=PB[EB],RB[CB]!==wB&&(AB[CB]=DB[CB],RB[CB]=wB,zB.push(CB)),DB[CB]^=UB;else if(LB>FB)for(EB=FB,SB=Math.min(LB,IB);EB<SB;++EB)CB=PB[EB],RB[CB]!==wB&&(AB[CB]=DB[CB],RB[CB]=wB,zB.push(CB)),DB[CB]^=UB;if(TB>IB)for(EB=Math.max(LB,IB),SB=TB;EB<SB;++EB)CB=PB[EB],RB[CB]!==wB&&(AB[CB]=DB[CB],RB[CB]=wB,zB.push(CB)),DB[CB]^=UB;else if(TB<IB)for(EB=Math.max(FB,TB),SB=IB;EB<SB;++EB)CB=PB[EB],RB[CB]!==wB&&(AB[CB]=DB[CB],RB[CB]=wB,zB.push(CB)),DB[CB]^=UB;_B.range=kB.slice()},$$.incrementOne=function(_B,kB,wB,zB){var EB,SB,CB,OB=this.value,RB=OB.curr(),DB=_B.index(),AB=_B.bisect(_B.range),PB=_B.bisect(kB),qB=PB[0],MB=PB[1],LB=AB[0],TB=AB[1],FB=_B.one;if(qB<LB)for(EB=qB,SB=Math.min(LB,MB);EB<SB;++EB)CB=DB[EB],RB[CB]^=FB,wB.push(CB);else if(qB>LB)for(EB=LB,SB=Math.min(qB,TB);EB<SB;++EB)CB=DB[EB],RB[CB]^=FB,zB.push(CB);if(MB>TB)for(EB=Math.max(qB,TB),SB=MB;EB<SB;++EB)CB=DB[EB],RB[CB]^=FB,wB.push(CB);else if(MB<TB)for(EB=Math.max(LB,MB),SB=TB;EB<SB;++EB)CB=DB[EB],RB[CB]^=FB,zB.push(CB);_B.range=kB.slice()};Pk(AD,VS).transform=function(_B,kB){var wB=~(_B.ignore||0),zB=_B.filter,EB=zB.mask;if(0==(EB&wB))return kB.StopPropagation;var SB=kB.fork(kB.ALL),CB=zB.data(),OB=zB.curr(),RB=zB.prev(),DB=function(PB){return OB[PB]&wB?null:CB[PB]};return SB.filter(SB.MOD,DB),EB&EB-1?(SB.filter(SB.ADD,function(AB){var PB=OB[AB]&wB;return!PB&&PB^RB[AB]&wB?CB[AB]:null}),SB.filter(SB.REM,function(AB){var PB=OB[AB]&wB;return!PB||PB^PB^RB[AB]&wB?null:CB[AB]})):(SB.filter(SB.ADD,DB),SB.filter(SB.REM,function(AB){return(OB[AB]&wB)===EB?CB[AB]:null})),SB.filter(SB.SOURCE,function(AB){return DB(AB._index)})};HS({type:"CrossFilter",metadata:{},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"query",type:"array",array:!0,required:!0,content:{type:"number",array:!0,length:2}}]},DD),HS({type:"ResolveFilter",metadata:{},params:[{name:"ignore",type:"number",required:!0,description:"A bit mask indicating which filters to ignore."},{name:"filter",type:"object",required:!0,description:"Per-tuple filter bitmaps from a CrossFilter transform."}]},AD);var W$=Pk(PD,VS),B$=new xw;W$.transform=function(_B,kB){var wB,zB=_B.mark,EB=zB.marktype,SB=pI[EB],CB=SB.bound,OB=zB.clip,RB=zB.bounds;return zB.bounds_prev.clear().union(RB),SB.nested?(RB=qD(zB,CB),zB.items.forEach(function(DB){DB.bounds_prev.clear().union(DB.bounds),DB.bounds.clear().union(RB)})):"group"===EB||_B.modified()?(RB.clear(),zB.items.forEach(function(DB){RB.union(qD(DB,CB))})):(wB=kB.changed(kB.REM),kB.visit(kB.ADD,function(DB){RB.union(qD(DB,CB))}),kB.visit(kB.MOD,function(DB){wB=wB||RB.alignsWith(DB.bounds),RB.union(qD(DB,CB))}),wB&&!OB&&(RB.clear(),zB.items.forEach(function(DB){RB.union(DB.bounds)}))),OB&&RB.intersect(B$.set(0,0,zB.group.width,zB.group.height)),kB.modifies("bounds")},Pk(MD,VS).transform=function(_B,kB){var wB=this.value;wB||(wB=kB.dataflow.scenegraph().mark(_B.markdef,LD(_B),_B.index),wB.group.context=_B.context,_B.context.group||(_B.context.group=wB.group),wB.source=this,this.value=wB);var zB="group"===wB.marktype?kw:_w;return kB.visit(kB.ADD,function(EB){zB.call(EB,wB)}),wB.items=kB.source,kB},Pk(TD,VS).transform=function(_B,kB){var wB=kB.dataflow;if(kB.changed(kB.REM)&&wB.enqueue(kB.materialize(kB.REM).rem),kB.changed(kB.ADD)&&wB.enqueue(kB.materialize(kB.ADD).add),kB.changed(kB.MOD)&&wB.enqueue(kB.materialize(kB.MOD).mod),kB.fields&&kB.fields.zindex){var zB=kB.source&&kB.source[0];zB&&(zB.mark.zdirty=!0)}};var G$="axis",V$="legend",H$="row-header",Y$="row-footer",X$="row-title",J$="column-header",Q$="column-footer",K$="column-title",Z$="fit",ej="pad",tj="none",aj="axis",nj="title",ij="frame",rj="legend",dj="scope",oj="row-header",sj="row-footer",lj="column-header",uj="column-footer";Pk(HD,VS).transform=function(_B,kB){var wB=kB.dataflow;return _B.mark.items.forEach(function(zB){_B.layout&&BD(wB,zB,_B.layout),YD(wB,zB,_B)}),kB};var pj="default",cj="view",fj="vega-bind",gj="vega-bind-name",hj="vega-bind-radio",yj="vega-option-",vj="outer",xj=["value","update","react","bind"];WA.prototype.visit=function(_B){var kB,wB,zB,EB=this;if(_B(EB))return 1;for(kB=BA(EB),wB=0,zB=kB.length;wB<zB;++wB)if(kB[wB].visit(_B))return 1};var bj,_j,kj,wj,zj=1,Ej=2,Sj=3,Cj=4,Oj=5,Rj=6,Dj=7,Aj=8,Pj="ArrayExpression",qj="BinaryExpression",Mj="CallExpression",Lj="ConditionalExpression",Tj="Identifier",Fj="Literal",Ij="LogicalExpression",Uj="MemberExpression",$j="ObjectExpression",jj="Property",Nj="UnaryExpression",Wj="Unexpected token %0",Bj="Unexpected number",Gj="Unexpected string",Vj="Unexpected identifier",Hj="Unexpected reserved word",Yj="Unexpected end of input",Xj="Invalid regular expression",Jj="Invalid regular expression: missing /",Qj="Octal literals are not allowed in strict mode.",Kj="Duplicate data property in object literal not allowed in strict mode",Zj="ILLEGAL",eN="Disabled.",tN=/[--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------]/,aN=/[--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------]/,nN={if:1,in:1,do:1,var:1,for:1,new:1,try:1,let:1,this:1,else:1,case:1,void:1,with:1,enum:1,while:1,break:1,catch:1,throw:1,const:1,yield:1,class:1,super:1,return:1,typeof:1,delete:1,switch:1,export:1,import:1,public:1,static:1,default:1,finally:1,extends:1,package:1,private:1,function:1,continue:1,debugger:1,interface:1,protected:1,instanceof:1,implements:1},iN={if:1,this:1},rN={NaN:"NaN",E:"Math.E",LN2:"Math.LN2",LN10:"Math.LN10",LOG2E:"Math.LOG2E",LOG10E:"Math.LOG10E",PI:"Math.PI",SQRT1_2:"Math.SQRT1_2",SQRT2:"Math.SQRT2"},dN=KP(Q_.format),oN=KP(B_.utcFormat),sN=KP(B_.timeFormat),lN=KP(B_.utcParse),uN=KP(B_.timeParse),pN=new Date(2e3,0,1),cN="undefined"!=typeof window&&window||null,mN="Literal",fN="Identifier",hN="%",yN=":",vN=Rq("area"),xN=Rq("bounds"),bN=Rq("centroid"),_N={},kN="union",wN="unit",zN="others",EN={isArray:KT,isBoolean:qk,isDate:Mk,isNumber:Lk,isObject:xk,isRegExp:Tk,isString:bk,toBoolean:Nk,toDate:Wk,toNumber:Bk,toString:Gk,pad:$k,truncate:Hk,rgb:ak.rgb,lab:ak.lab,hcl:ak.hcl,hsl:ak.hsl,sequence:U_.range,format:dN,utcFormat:oN,utcParse:lN,timeFormat:sN,timeParse:uN,monthFormat:function(_B){return ZP(_B,1,"%B")},monthAbbrevFormat:function(_B){return ZP(_B,1,"%b")},dayFormat:function(_B){return ZP(0,2+_B,"%A")},dayAbbrevFormat:function(_B){return ZP(0,2+_B,"%a")},quarter:function(_B){return 1+~~(new Date(_B).getMonth()/3)},utcquarter:function(_B){return 1+~~(new Date(_B).getUTCMonth()/3)},warn:function(){return dq(this.context.dataflow,"warn",arguments)},info:function(){return dq(this.context.dataflow,"info",arguments)},debug:function(){return dq(this.context.dataflow,"debug",arguments)},inScope:function(_B){var kB=this.context.group,wB=!1;if(kB)for(;_B;){if(_B===kB){wB=!0;break}_B=_B.mark.group}return wB},clampRange:function(_B,kB,wB){var zB,EB=_B[0],SB=_B[1];return SB<EB&&(zB=SB,SB=EB,EB=zB),zB=SB-EB,zB>=wB-kB?[kB,wB]:[Math.min(Math.max(EB,kB),wB-zB),Math.min(Math.max(SB,zB),wB)]},pinchDistance:function(){return"Math.sqrt(Math.pow(event.touches[0].clientX - event.touches[1].clientX, 2) + Math.pow(event.touches[0].clientY - event.touches[1].clientY, 2))"},pinchAngle:function(){return"Math.atan2(event.touches[1].clientY - event.touches[0].clientY,event.touches[1].clientX - event.touches[0].clientX)"},open:function(_B,kB){var wB=this.context.dataflow;cN&&cN.open?wB.loader().sanitize(_B,{context:"open",name:kB}).then(function(zB){cN.open(zB,kB)}).catch(function(zB){wB.warn("Open url failed: "+zB)}):wB.warn("Open function can only be invoked in a browser.")},screen:function(){return cN?cN.screen:{}},windowsize:function(){return cN?[cN.innerWidth,cN.innerHeight]:[void 0,void 0]},span:function(_B){return _B[_B.length-1]-_B[0]||0},bandspace:function(_B,kB,wB){return XC(_B||0,kB||0,wB||0)},inrange:Iq,encode:function(_B,kB,wB){if(_B){var zB=this.context.dataflow,EB=_B.mark.source;zB.pulse(EB,zB.changeset().encode(_B,kB))}return void 0===wB?_B:wB},modify:function(_B,kB,wB,zB,EB,SB){var CB,OB,RB=this.context.dataflow,DB=this.context.data[_B],AB=DB.input,PB=DB.changes,qB=RB.stamp();if(!1===RB._trigger||!(AB.value.length||kB||zB))return 0;if((!PB||PB.stamp<qB)&&(DB.changes=PB=RB.changeset(),PB.stamp=qB,RB.runAfter(function(){DB.modified=!0,RB.pulse(AB,PB).run()})),wB&&(CB=!0===wB?iF:KT(wB)||null!=wB._id?wB:$q(wB),PB.remove(CB)),kB&&PB.insert(kB),zB&&(CB=$q(zB),AB.value.some(CB)?PB.remove(CB):PB.insert(zB)),EB)for(OB in SB)PB.modify(EB,OB,SB[OB]);return 1}},SN=["view","item","group","xy","x","y"],ON="this.",RN={};Qq("bandwidth",function(_B,kB){var wB=vq(_B,(kB||this).context);return wB&&wB.bandwidth?wB.bandwidth():0},bq),Qq("copy",function(_B,kB){var wB=vq(_B,(kB||this).context);return wB?wB.copy():void 0},bq),Qq("domain",function(_B,kB){var wB=vq(_B,(kB||this).context);return wB?wB.domain():[]},bq),Qq("range",function(_B,kB){var wB=vq(_B,(kB||this).context);return wB&&wB.range?wB.range():[]},bq),Qq("invert",function(_B,kB,wB){var zB=vq(_B,(wB||this).context);return zB?KT(kB)?(zB.invertRange||zB.invert)(kB):(zB.invert||zB.invertExtent)(kB):void 0},bq),Qq("scale",function(_B,kB,wB){var zB=vq(_B,(wB||this).context);return zB?zB(kB):void 0},bq),Qq("gradient",function(_B,kB,wB,zB){var EB=bw(kB,wB),SB=_B.domain(),CB=SB[0],OB=SB[SB.length-1],RB=lO(_B,CB,OB);_B.ticks&&(SB=_B.ticks(+zB||15),CB!==SB[0]&&SB.unshift(CB),OB!==SB[SB.length-1]&&SB.push(OB));for(var DB=0,AB=SB.length;DB<AB;++DB)EB.stop(RB(SB[DB]),_B(SB[DB]));return EB},bq),Qq("geoArea",vN,bq),Qq("geoBounds",xN,bq),Qq("geoCentroid",bN,bq),Qq("indata",function(_B,kB,wB){var zB=this.context.data[_B]["index:"+kB],EB=zB?zB.value.get(wB):void 0;return EB?EB.count:EB},function(_B,kB,wB,zB){kB[0].type!==mN&&yk("First argument to indata must be a string literal."),kB[1].type!==mN&&yk("Second argument to indata must be a string literal.");var EB=kB[0].value,SB=kB[1].value,CB="@"+SB;zB.hasOwnProperty(CB)||(zB[CB]=wB.getData(EB).indataRef(wB,SB))}),Qq("data",Dq,Aq),Qq("vlPoint",function(_B,kB,wB,zB,EB){return Bq.call(this,_B,kB,wB,zB,EB,Nq)},Aq),Qq("vlInterval",function(_B,kB,wB,zB,EB){return Bq.call(this,_B,kB,wB,zB,EB,Wq)},Aq),Qq("vlPointDomain",function(_B,kB,wB,zB){for(var EB,SB,CB,OB,RB=this.context.data[_B],DB=RB?RB.values.value:[],AB={},PB=0,qB={},MB=[],LB=0,TB=DB.length;LB<TB;++LB)EB=DB[LB],SB=EB.unit,OB=EB.values[0],AB[SB]||(AB[SB]=++PB),(kB&&EB.encodings[0]===kB||wB&&EB.fields[0]===wB)&&((CB=qB[OB])||(qB[OB]=CB={value:OB,units:{},count:0}),CB.units[SB]||(CB.units[SB]=++CB.count));for(OB in qB)zB!==kN&&(CB=qB[OB]).count!==PB||MB.push(CB.value);return MB.length?MB:void 0},Aq),Qq("vlIntervalDomain",function(_B,kB,wB,zB){for(var EB,SB,CB,OB,RB,DB,AB,PB,qB=zB===kN?Xq:Jq,MB=this.context.data[_B],LB=MB?MB.values.value:[],TB=0,FB=LB.length;TB<FB;++TB)for(EB=LB[TB].intervals,CB=0,SB=EB.length;CB<SB;++CB)OB=EB[CB],(kB&&OB.encoding===kB||wB&&OB.field===wB)&&(RB=OB.extent,AB=RB[0],PB=RB[1],AB>PB&&(PB=RB[1],AB=RB[0]),DB=DB?qB(DB,AB,PB):[AB,PB]);return DB&&DB.length&&+DB[0]!=+DB[1]?DB:void 0},Aq),Qq("treePath",function(_B,kB,wB){var zB=Lq(_B,this),EB=zB[kB],SB=zB[wB];return EB&&SB?EB.path(SB).map(Mq):void 0},Aq),Qq("treeAncestors",function(_B,kB){var wB=Lq(_B,this)[kB];return wB?wB.ancestors().map(Mq):void 0},Aq);var DN,AN,PN={blacklist:["_"],whitelist:["datum","event","item"],fieldvar:"datum",globalvar:function(kB){return"_["+_k("$"+kB)+"]"},functions:function(_B){var kB=QP(_B);for(var wB in SN.forEach(function(zB){kB[zB]="event.vega."+zB}),EN)kB[wB]=ON+wB;return kB},constants:rN,visitors:RN},qN=function(_B){function kB(LB){if(bk(LB))return LB;var TB=MB[LB.type];return null==TB&&yk("Unsupported type: "+LB.type),TB(LB)}function wB(LB){var TB={code:kB(LB),globals:Object.keys(DB),fields:Object.keys(AB)};return DB={},AB={},TB}_B=_B||{};var zB=_B.whitelist?Vk(_B.whitelist):{},EB=_B.blacklist?Vk(_B.blacklist):{},SB=_B.constants||rN,CB=(_B.functions||QP)(kB),OB=_B.globalvar,RB=_B.fieldvar,DB={},AB={},PB=0,qB=Ck(OB)?OB:function(LB){return OB+"[\""+LB+"\"]"},MB={Literal:function(TB){return TB.raw},Identifier:function(TB){var FB=TB.name;return 0<PB?FB:EB.hasOwnProperty(FB)?yk("Illegal identifier: "+FB):SB.hasOwnProperty(FB)?SB[FB]:zB.hasOwnProperty(FB)?FB:(DB[FB]=1,qB(FB))},MemberExpression:function(TB){var FB=!TB.computed,IB=kB(TB.object);FB&&(PB+=1);var UB=kB(TB.property);return IB===RB&&(AB[UB]=1),FB&&(PB-=1),IB+(FB?"."+UB:"["+UB+"]")},CallExpression:function(TB){"Identifier"!==TB.callee.type&&yk("Illegal callee type: "+TB.callee.type);var FB=TB.callee.name,IB=TB.arguments,UB=CB.hasOwnProperty(FB)&&CB[FB];return UB||yk("Unrecognized function: "+FB),Ck(UB)?UB(IB):UB+"("+IB.map(kB).join(",")+")"},ArrayExpression:function(TB){return"["+TB.elements.map(kB).join(",")+"]"},BinaryExpression:function(TB){return"("+kB(TB.left)+TB.operator+kB(TB.right)+")"},UnaryExpression:function(TB){return"("+TB.operator+kB(TB.argument)+")"},ConditionalExpression:function(TB){return"("+kB(TB.test)+"?"+kB(TB.consequent)+":"+kB(TB.alternate)+")"},LogicalExpression:function(TB){return"("+kB(TB.left)+TB.operator+kB(TB.right)+")"},ObjectExpression:function(TB){return"{"+TB.properties.map(kB).join(",")+"}"},Property:function(TB){PB+=1;var FB=kB(TB.key);return PB-=1,FB+":"+kB(TB.value)}};return wB.functions=CB,wB.constants=SB,wB}(PN),MN="$",LN="view",TN="scope",FN="view",IN="[",UN="]",$N="{",jN="}",NN=":",WN=",",BN="@",GN=">",VN=/[\[\]\{\}]/,HN={"*":1,arc:1,area:1,group:1,image:1,line:1,path:1,rect:1,rule:1,shape:1,symbol:1,text:1,trail:1},YN="var datum=event.item&&event.item.datum;",XN=Vk(["rule"]),JN=Vk(["group","image","rect"]),QN="mark",KN="frame",ZN="scope",eW="axis",tW="axis-domain",aW="axis-grid",nW="axis-label",iW="axis-tick",rW="axis-title",dW="legend",oW="legend-entry",sW="legend-gradient",lW="legend-label",uW="legend-symbol",pW="legend-title",cW="title",mW={name:1,interactive:1},fW="group",gW="rect",hW="rule",yW="symbol",vW="text",xW="top",bW="left",_W="right",kW="bottom",wW="index",zW="label",EW="offset",SW="perc",CW="size",OW="total",RW="value",DW=["shape","size","fill","stroke","strokeDash","opacity"],AW="datum."+SW+"<=0?\"left\":datum."+SW+">=1?\"right\":\"center\"",PW=eL("key"),qW="descending",MW=dL("Aggregate"),LW=dL("AxisTicks"),TW=dL("Bound"),FW=dL("Collect"),IW=dL("Compare"),UW=dL("DataJoin"),$W=dL("Encode"),jW=dL("Facet"),NW=dL("Field"),WW=dL("Key"),BW=dL("LegendEntries"),GW=dL("Mark"),VW=dL("MultiExtent"),HW=dL("MultiValues"),YW=dL("Params"),XW=dL("PreFacet"),JW=dL("Projection"),QW=dL("Proxy"),KW=dL("Relay"),ZW=dL("Render"),eB=dL("Scale"),tB=dL("Sieve"),aB=dL("SortItems"),nB=dL("ViewLayout"),iB=dL("Values");_L.fromEntries=function(_B,kB){var wB=kB.length,zB=1,EB=kB[0],SB=kB[wB-1],CB=kB[wB-2],OB=null;for(_B.add(kB[0]);zB<wB;++zB)kB[zB].params.pulse=ZM(kB[zB-1]),_B.add(kB[zB]),"Aggregate"===kB[zB].type&&(OB=kB[zB]);return new _L(_B,EB,CB,SB,OB)};var rB=_L.prototype;rB.countsRef=function(_B,kB,wB){var zB,EB,SB,CB=this,OB=CB.counts||(CB.counts={}),RB=kL(kB);return null!=RB&&(_B=CB.scope,zB=OB[RB]),zB?wB&&wB.field&&wL(_B,zB.agg.params,wB):(SB={groupby:_B.fieldRef(kB,"key"),pulse:ZM(CB.output)},wB&&wB.field&&wL(_B,SB,wB),EB=_B.add(MW(SB)),zB=_B.add(FW({pulse:ZM(EB)})),zB={agg:EB,ref:ZM(zB)},null!=RB&&(OB[RB]=zB)),zB.ref},rB.tuplesRef=function(){return ZM(this.values)},rB.extentRef=function(_B,kB){return zL(_B,this,"extent","Extent",kB,!1)},rB.domainRef=function(_B,kB){return zL(_B,this,"domain","Values",kB,!1)},rB.valuesRef=function(_B,kB,wB){return zL(_B,this,"vals","Values",kB,wB||!0)},rB.lookupRef=function(_B,kB){return zL(_B,this,"lookup","TupleIndex",kB,!1)},rB.indataRef=function(_B,kB){return zL(_B,this,"indata","TupleIndex",kB,!0,!0)};var dB=0,oB=["identity","ordinal","band","point","bin-linear","bin-ordinal","linear","pow","sqrt","log","sequential","time","utc","quantize","quantile","threshold"],sB=Vk(oB),lB=Vk(oB.slice(1,6)),uB=Vk(["width","height","padding"]),pB=pT.prototype=cT.prototype;pB.fork=function(){return new cT(this)},pB.toRuntime=function(){return this.finish(),{background:this.background,operators:this.operators,streams:this.streams,updates:this.updates,bindings:this.bindings}},pB.id=function(){return(this._subid?this._subid+":":0)+this._id++},pB.add=function(_B){return this.operators.push(_B),_B.id=this.id(),_B.refs&&(_B.refs.forEach(function(kB){kB.$ref=_B.id}),_B.refs=null),_B},pB.proxy=function(_B){var kB=_B instanceof JM?ZM(_B):_B;return this.add(QW({value:kB}))},pB.addStream=function(_B){return this.streams.push(_B),_B.id=this.id(),_B},pB.addUpdate=function(_B){return this.updates.push(_B),_B},pB.finish=function(){function _B(EB,SB,CB){var OB,RB;EB&&(OB=EB.data||(EB.data={}),RB=OB[SB]||(OB[SB]=[]),RB.push(CB))}var kB,wB;for(kB in this.root&&(this.root.root=!0),this.signals)this.signals[kB].signal=kB;for(kB in this.scales)this.scales[kB].scale=kB;for(kB in this.data)for(var zB in wB=this.data[kB],_B(wB.input,kB,"input"),_B(wB.output,kB,"output"),_B(wB.values,kB,"values"),wB.index)_B(wB.index[zB],kB,"index:"+zB);return this},pB.pushState=function(_B,kB,wB){this._encode.push(ZM(this.add(tB({pulse:_B})))),this._parent.push(kB),this._lookup.push(wB?ZM(this.proxy(wB)):null),this._markpath.push(-1)},pB.popState=function(){this._encode.pop(),this._parent.pop(),this._lookup.pop(),this._markpath.pop()},pB.parent=function(){return jk(this._parent)},pB.encode=function(){return jk(this._encode)},pB.lookup=function(){return jk(this._lookup)},pB.markpath=function(){var _B=this._markpath;return++_B[_B.length-1]},pB.fieldRef=function(_B,kB){if(bk(_B))return eL(_B,kB);_B.signal||yk("Unsupported field reference: "+_k(_B));var wB,zB=_B.signal,EB=this.field[zB];return EB||(wB={name:this.signalRef(zB)},kB&&(wB.as=kB),this.field[zB]=EB=ZM(this.add(NW(wB)))),EB},pB.compareRef=function(_B){function kB(CB){return rL(CB)?(zB=!0,ZM(wB[CB.signal])):CB}var wB=this.signals,zB=!1,EB=Ek(_B.field).map(kB),SB=Ek(_B.order).map(kB);return zB?ZM(this.add(IW({fields:EB,orders:SB}))):tL(EB,SB)},pB.keyRef=function(_B){var wB=this.signals,zB=!1;return _B=Ek(_B).map(function(EB){return rL(EB)?(zB=!0,ZM(wB[EB.signal])):EB}),zB?ZM(this.add(WW({fields:_B}))):aL(_B)},pB.sortRef=function(_B){if(!_B)return _B;var kB=[iL(_B.op,_B.field),"_id"],wB=_B.order||"ascending";return wB.signal?ZM(this.add(IW({fields:kB,orders:[wB=this.signalRef(wB.signal),wB]}))):tL(kB,[wB,wB])},pB.event=function(_B,kB){var wB=_B+":"+kB;if(!this.events[wB]){var zB=this.id();this.streams.push({id:zB,source:_B,type:kB}),this.events[wB]=zB}return this.events[wB]},pB.addSignal=function(_B,kB){this.signals.hasOwnProperty(_B)&&yk("Duplicate signal name: "+_k(_B));var wB=kB instanceof JM?kB:this.add(KM(kB));return this.signals[_B]=wB},pB.getSignal=function(_B){return this.signals[_B]||yk("Unrecognized signal name: "+_k(_B)),this.signals[_B]},pB.signalRef=function(_B){return this.signals[_B]?ZM(this.signals[_B]):(this.lambdas[_B]||(this.lambdas[_B]=this.add(KM(null))),ZM(this.lambdas[_B]))},pB.parseLambdas=function(){for(var _B=Object.keys(this.lambdas),kB=0,wB=_B.length;kB<wB;++kB){var zB=_B[kB],EB=Zq(zB,this),SB=this.lambdas[zB];SB.params=EB.$params,SB.update=EB.$expr}},pB.property=function(_B){return _B&&_B.signal?this.signalRef(_B.signal):_B},pB.objectProperty=function(_B){return _B&&xk(_B)?this.signalRef(_B.signal||mT(_B)):_B},pB.addBinding=function(_B,kB){this.bindings||yk("Nested signals do not support binding: "+_k(_B)),this.bindings.push(Rk({signal:_B},kB))},pB.addScaleProj=function(_B,kB){this.scales.hasOwnProperty(_B)&&yk("Duplicate scale or projection name: "+_k(_B)),this.scales[_B]=this.add(kB)},pB.addScale=function(_B,kB){this.addScaleProj(_B,eB(kB))},pB.addProjection=function(_B,kB){this.addScaleProj(_B,JW(kB))},pB.getScale=function(_B){return this.scales[_B]||yk("Unrecognized scale name: "+_k(_B)),this.scales[_B]},pB.projectionRef=pB.scaleRef=function(_B){return ZM(this.getScale(_B))},pB.projectionType=pB.scaleType=function(_B){return this.getScale(_B).params.type},pB.addData=function(_B,kB){return this.data.hasOwnProperty(_B)&&yk("Duplicate data set name: "+_k(_B)),this.data[_B]=kB},pB.getData=function(_B){return this.data[_B]||yk("Undefined data set name: "+_k(_B)),this.data[_B]},pB.addDataPipeline=function(_B,kB){return this.data.hasOwnProperty(_B)&&yk("Duplicate data set name: "+_k(_B)),this.addData(_B,_L.fromEntries(this,kB))};var cB=30,mB=2,fB="#4c78a8",gB="#000",hB="#888",yB="#ddd",vB=[{key:"$ref",parse:function(_B,kB){return kB.get(_B.$ref)||yk("Operator not defined: "+_B.$ref)}},{key:"$key",parse:function(_B,kB){var wB="k:"+_B.$key;return kB.fn[wB]||(kB.fn[wB]=Fk(_B.$key))}},{key:"$expr",parse:function(_B,kB){var wB="e:"+_B.$expr;return kB.fn[wB]||(kB.fn[wB]=fk(xT(_B.$expr,kB),_B.$fields,_B.$name))}},{key:"$field",parse:function(_B,kB){var wB="f:"+_B.$field+"_"+_B.$name;return kB.fn[wB]||(kB.fn[wB]=kk(_B.$field,_B.$name))}},{key:"$encode",parse:function(_B,kB){var wB,zB,EB=_B.$encode,SB={};for(wB in EB)zB=EB[wB],SB[wB]=fk(kT(zB.$expr,kB),zB.$fields),SB[wB].output=zB.$output;return SB}},{key:"$compare",parse:function(_B,kB){var wB="c:"+_B.$compare+"_"+_B.$order;return kB.fn[wB]||(kB.fn[wB]=Sk(_B.$compare,_B.$order))}},{key:"$context",parse:function(_B,kB){return kB}},{key:"$subflow",parse:function(_B,kB){var wB=_B.$subflow;return function(zB,EB,SB){var CB=FT(wB,kB.fork()),OB=CB.get(wB.operators[0].id),RB=CB.signals.parent;return RB&&RB.set(SB),OB}}}],xB={skip:!0};jT.prototype=NT.prototype={fork:function(){var kB=new NT(this);return(this.subcontext||(this.subcontext=[])).push(kB),kB},get:function(kB){return this.nodes[kB]},set:function(kB,wB){return this.nodes[kB]=wB},add:function(kB,wB){var zB,EB=this,SB=EB.dataflow;if(EB.set(kB.id,wB),"Collect"===kB.type&&(zB=kB.value)&&(zB.$ingest?SB.ingest(wB,zB.$ingest,zB.$format):zB.$request?SB.request(wB,zB.$request,zB.$format):SB.pulse(wB,SB.changeset().insert(zB))),kB.root&&(EB.root=wB),kB.parent){var CB=EB.get(kB.parent.$ref);CB?(SB.connect(CB,[wB]),wB.targets().add(CB)):(EB.unresolved=EB.unresolved||[]).push(function(){CB=EB.get(kB.parent.$ref),SB.connect(CB,[wB]),wB.targets().add(CB)})}if(kB.signal&&(EB.signals[kB.signal]=wB),kB.scale&&(EB.scales[kB.scale]=wB),kB.data)for(var OB in kB.data)zB=EB.data[OB]||(EB.data[OB]={}),kB.data[OB].forEach(function(RB){zB[RB]=wB})},resolve:function(){return(this.unresolved||[]).forEach(function(kB){kB()}),delete this.unresolved,this},operator:function(kB,wB,zB){this.add(kB,this.dataflow.add(kB.value,wB,zB,kB.react))},transform:function(kB,wB,zB){this.add(kB,this.dataflow.add(this.transforms[wB],zB))},stream:function(kB,wB){this.set(kB.id,wB)},update:function(kB,wB,zB,EB,SB){this.dataflow.on(wB,zB,EB,SB,kB.options)},getState:function(_B){var kB=this,wB={};if(_B.signals){var zB=wB.signals={};Object.keys(kB.signals).forEach(function(SB){var CB=kB.signals[SB];_B.signals(SB,CB)&&(zB[SB]=CB.value)})}if(_B.data){var EB=wB.data={};Object.keys(kB.data).forEach(function(SB){var CB=kB.data[SB];_B.data(SB,CB)&&(EB[SB]=CB.input.value)})}return kB.subcontext&&!1!==_B.recurse&&(wB.subcontext=kB.subcontext.map(function(SB){return SB.getState(_B)})),wB},setState:function(_B){var kB=this,wB=kB.dataflow,zB=_B.data,EB=_B.signals;Object.keys(EB||{}).forEach(function(SB){wB.update(kB.signals[SB],EB[SB],xB)}),Object.keys(zB||{}).forEach(function(SB){wB.pulse(kB.data[SB].input,wB.changeset().remove(iF).insert(zB[SB]))}),(_B.subcontext||[]).forEach(function(SB,CB){var OB=OB.subcontext[CB];OB&&OB.setState(SB)})}};var bB=Pk(JT,BS);bB.run=function(_B){BS.prototype.run.call(this,_B);var kB=this._queue;return(this._resize||!kB||kB.length)&&(this.render(kB),this._queue=[]),this},bB.render=function(_B){return this._renderer&&(this._resize&&(this._resize=0,cA(this)),this._renderer.render(this._scenegraph.root,_B)),this},bB.enqueue=function(_B){this._queue&&_B&&_B.length&&(this._queue=this._queue.concat(_B))},bB.signal=function(_B,kB,wB){var zB=QT(this,_B);return 1===arguments.length?zB.value:this.update(zB,kB,wB)},bB.scenegraph=function(){return this._scenegraph},bB.background=function(_B){return arguments.length?(this._background=_B,this._resize=1,this):this._background},bB.width=function(_B){return arguments.length?this.signal("width",_B):this.signal("width")},bB.height=function(_B){return arguments.length?this.signal("height",_B):this.signal("height")},bB.padding=function(_B){return arguments.length?this.signal("padding",_B):this.signal("padding")},bB.renderer=function(_B){return arguments.length?(eS(_B)||this.error("Unrecognized renderer type: "+_B),_B!==this._renderType&&(this._renderType=_B,this._renderer&&(this._renderer=this._queue=null,this.initialize(this._el))),this):this._renderType},bB.loader=function(_B){return arguments.length?(_B!==this._loader&&(BS.prototype.loader.call(this,_B),this._renderer&&(this._renderer=this._queue=null,this.initialize(this._el))),this):this._loader},bB.addEventListener=function(_B,kB){this._handler.on(_B,kB)},bB.removeEventListener=function(_B,kB){this._handler.off(_B,kB)},bB.addSignalListener=function(_B,kB){var wB=QT(this,_B),zB=function(){kB(_B,wB.value)};this.on(wB,null,(zB.handler=kB,zB))},bB.removeSignalListener=function(_B,kB){var wB=QT(this,_B),zB=wB._targets||[],EB=zB.filter(function(SB){var CB=SB._update;return CB&&CB.handler===kB});EB.length&&zB.remove(EB[0])},bB.preventDefault=function(_B){return arguments.length?(this._preventDefault=_B,this):this._preventDefault},bB.tooltipHandler=function(_B){var kB=this._handler;return arguments.length?(kB.handleTooltip=_B||CE.prototype.handleTooltip,this):kB.handleTooltip},bB.events=function(_B,kB,wB){var zB,EB=this,SB=new vS(wB),CB=function(AB,PB){EB.preventDefault()&&_B===cj&&AB.preventDefault(),SB.receive(mA(EB,AB,PB)),EB.run()};if(_B===cj)return EB.addEventListener(kB,CB),SB;if(_B==="window"?"undefined"!=typeof window&&(zB=[window]):"undefined"!=typeof document&&(zB=document.querySelectorAll(_B)),!zB)return EB.warn("Can not resolve event source: "+_B),SB;for(var OB=0,RB=zB.length;OB<RB;++OB)zB[OB].addEventListener(kB,CB);return EB._eventListeners.push({type:kB,sources:zB,handler:CB}),SB},bB.finalize=function(){for(var _B,kB,wB=this._eventListeners,zB=wB.length;0<=--zB;)for(kB=wB[zB],_B=kB.sources.length;0<=--_B;)kB.sources[_B].removeEventListener(kB.type,kB.handler)},bB.hover=function(_B,kB){return this.on(this.events("view","mouseover",hA),yA,vA(_B||"hover")),this.on(this.events("view","mouseout",hA),yA,vA(kB||"update")),this},bB.autosize=function(_B,kB,wB,zB,EB,SB){this.runAfter(function(CB){var OB=0;CB._autosize=0,CB.width()!==wB&&(OB=1,CB.width(wB),CB._resizeWidth.skip(!0)),CB.height()!==zB&&(OB=1,CB.height(zB),CB._resizeHeight.skip(!0)),CB._width!==_B&&(CB._resize=1,CB._width=_B),CB._height!==kB&&(CB._resize=1,CB._height=kB),CB._origin[0]===EB[0]&&CB._origin[1]===EB[1]||(CB._resize=1,CB._origin=EB),OB&&CB.run("enter"),SB&&CB.runAfter(function(){CB._autosize=1})})},bB.data=function(_B){return iA(this,_B).values.value},bB.change=dA,bB.insert=function(_B,kB){return dA.call(this,_B,cS().insert(kB))},bB.remove=function(_B,kB){return dA.call(this,_B,cS().remove(kB))},bB.initialize=function(_B,kB){var wB,zB,EB=this,SB=EB._renderType,CB=eS(SB);return _B=EB._el=_B?qA(EB,_B):null,CB||EB.error("Unrecognized renderer type: "+SB),wB=CB.handler||DE,zB=_B?CB.renderer:CB.headless,EB._renderer=zB?DA(EB,EB._renderer,_B,zB):null,EB._handler=AA(EB,EB._handler,_B,wB),_B&&(kB=kB?qA(EB,kB):_B.appendChild(_A("div",{class:"vega-bindings"})),EB._bind.forEach(function(OB){OB.param.element&&qA(EB,OB.param.element)}),EB._bind.forEach(function(OB){kA(EB,OB.param.element||kB,OB)})),EB},bB.toImageURL=function(_B){return _B!==LI.Canvas&&_B!==LI.SVG&&_B!==LI.PNG?Promise.reject("Unrecognized image type: "+_B):MA(this,_B).then(function(kB){return _B===LI.SVG?TA(kB.svg(),"image/svg+xml"):kB.canvas().toDataURL("image/png")})},bB.toCanvas=function(){return MA(this,LI.Canvas).then(function(_B){return _B.canvas()})},bB.toSVG=function(){return MA(this,LI.SVG).then(function(_B){return _B.svg()})},bB.getState=function(_B){return this._runtime.getState(_B||{data:HT,signals:YT,recurse:!0})},bB.setState=function(_B){var kB=this;return kB._trigger=!1,kB._runtime.setState(_B),kB.run().runAfter(function(){kB._trigger=!0}),this},XS("Bound",PD),XS("Mark",MD),XS("Render",TD),XS("ViewLayout",HD),I_.version="3.0.0-beta.31",I_.Dataflow=BS,I_.EventStream=vS,I_.Parameters=mS,I_.Pulse=SS,I_.MultiPulse=LS,I_.Operator=fS,I_.Transform=VS,I_.changeset=cS,I_.ingest=oS,I_.register=HS,I_.definition=YS,I_.definitions=tU,I_.transform=XS,I_.transforms=eU,I_.tupleid=rS,I_.scale=iO,I_.scheme=oO,I_.interpolate=pO,I_.interpolateRange=sO,I_.projection=DO,I_.View=JT,I_.parse=function(_B,kB){return uT(_B,new pT(fT(kB||_B.config))).toRuntime()},I_.expressionFunction=Qq,I_.formatLocale=Q_.formatDefaultLocale,I_.timeFormatLocale=B_.timeFormatDefaultLocale,I_.runtime=FT,I_.runtimeContext=$T,I_.bin=nk,I_.bootstrapCI=dk,I_.randomInteger=function(_B,kB){null==kB&&(kB=_B,_B=0);var wB,zB,EB,SB={};return SB.min=function(CB){return arguments.length?(wB=CB||0,EB=zB-wB,SB):wB},SB.max=function(CB){return arguments.length?(zB=CB||0,EB=zB-wB,SB):zB},SB.sample=function(){return wB+Math.floor(EB*Math.random())},SB.pdf=function(CB){return CB===Math.floor(CB)&&CB>=wB&&CB<zB?1/EB:0},SB.cdf=function(CB){var OB=Math.floor(CB);return OB<wB?0:OB>=zB?1:(OB-wB+1)/EB},SB.icdf=function(CB){return 0<=CB&&1>=CB?wB-1+Math.floor(CB*EB):NaN},SB.min(_B).max(kB)},I_.randomKDE=uk,I_.randomMixture=ck,I_.randomNormal=sk,I_.randomUniform=mk,I_.quartiles=lk,I_.accessor=fk,I_.accessorName=gk,I_.accessorFields=hk,I_.id=eF,I_.identity=tF,I_.zero=aF,I_.one=nF,I_.truthy=iF,I_.falsy=rF,I_.logger=zk,I_.None=dF,I_.Warn=oF,I_.Info=sF,I_.Debug=lF,I_.array=Ek,I_.compare=Sk,I_.constant=Ok,I_.error=yk,I_.extend=Rk,I_.extentIndex=Dk,I_.fastmap=Ak,I_.field=kk,I_.inherits=Pk,I_.isArray=KT,I_.isBoolean=qk,I_.isDate=Mk,I_.isFunction=Ck,I_.isNumber=Lk,I_.isObject=xk,I_.isRegExp=Tk,I_.isString=bk,I_.key=Fk,I_.merge=Ik,I_.pad=$k,I_.peek=jk,I_.repeat=Uk,I_.splitAccessPath=vk,I_.stringValue=_k,I_.toBoolean=Nk,I_.toDate=Wk,I_.toNumber=Bk,I_.toString=Gk,I_.toSet=Vk,I_.truncate=Hk,I_.visitArray=Yk,I_.loader=Xk,I_.read=yw,I_.inferType=nw,I_.inferTypes=iw,I_.typeParsers=fF,I_.formats=hw,I_.Bounds=xw,I_.Gradient=bw,I_.GroupItem=kw,I_.ResourceLoader=Rw,I_.Item=_w,I_.Scenegraph=EE,I_.Handler=CE,I_.Renderer=OE,I_.CanvasHandler=DE,I_.CanvasRenderer=LE,I_.SVGHandler=IE,I_.SVGRenderer=NE,I_.SVGStringRenderer=JE,I_.RenderType=LI,I_.renderModule=eS,I_.Marks=pI,I_.boundContext=fz,I_.boundStroke=mz,I_.boundItem=bE,I_.boundMark=_E,I_.pathCurves=Pw,I_.pathSymbols=Uw,I_.pathRectangle=Vw,I_.pathTrail=Hw,I_.pathParse=qw,I_.pathRender=Fw,I_.point=RE,I_.canvas=Ow,I_.domCreate=ww,I_.domFind=zw,I_.domChild=Ew,I_.domClear=Sw,I_.openTag=$E,I_.closeTag=jE,I_.font=fE,I_.textMetrics=dI,I_.sceneEqual=tS,I_.pathEqual=aS,I_.sceneToJSON=kE,I_.sceneFromJSON=wE,I_.sceneZOrder=kz,I_.sceneVisit=wz,I_.scenePickVisit=zz,Object.defineProperty(I_,"__esModule",{value:!0})});</script></head><body></body></html>