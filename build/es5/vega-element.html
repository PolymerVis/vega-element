<html><head>

<script>!function(e){var r=e.babelHelpers={};r.typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r.classCallCheck=function(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")},r.createClass=function(){function e(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(r,t,n){return t&&e(r.prototype,t),n&&e(r,n),r}}(),r.defineEnumerableProperties=function(e,r){for(var t in r){var n=r[t];n.configurable=n.enumerable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,t,n)}return e},r.defaults=function(e,r){for(var t=Object.getOwnPropertyNames(r),n=0;n<t.length;n++){var o=t[n],i=Object.getOwnPropertyDescriptor(r,o);i&&i.configurable&&void 0===e[o]&&Object.defineProperty(e,o,i)}return e},r.defineProperty=function(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e},r.extends=Object.assign||function(e){for(var r=1;r<arguments.length;r++){var t=arguments[r];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e},r.get=function e(r,t,n){null===r&&(r=Function.prototype);var o=Object.getOwnPropertyDescriptor(r,t);if(void 0===o){var i=Object.getPrototypeOf(r);return null===i?void 0:e(i,t,n)}if("value"in o)return o.value;var a=o.get;if(void 0!==a)return a.call(n)},r.inherits=function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Super expression must either be null or a function, not "+typeof r);e.prototype=Object.create(r&&r.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),r&&(Object.setPrototypeOf?Object.setPrototypeOf(e,r):e.__proto__=r)},r.instanceof=function(e,r){return null!=r&&"undefined"!=typeof Symbol&&r[Symbol.hasInstance]?r[Symbol.hasInstance](e):e instanceof r},r.newArrowCheck=function(e,r){if(e!==r)throw new TypeError("Cannot instantiate an arrow function")},r.objectDestructuringEmpty=function(e){if(null==e)throw new TypeError("Cannot destructure undefined")},r.objectWithoutProperties=function(e,r){var t={};for(var n in e)r.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t},r.possibleConstructorReturn=function(e,r){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!r||"object"!=typeof r&&"function"!=typeof r?e:r},r.set=function e(r,t,n,o){var i=Object.getOwnPropertyDescriptor(r,t);if(void 0===i){var a=Object.getPrototypeOf(r);null!==a&&e(a,t,n,o)}else if("value"in i&&i.writable)i.value=n;else{var u=i.set;void 0!==u&&u.call(o,n)}return n},r.slicedToArray=function(){function e(e,r){var t=[],n=!0,o=!1,i=void 0;try{for(var a,u=e[Symbol.iterator]();!(n=(a=u.next()).done)&&(t.push(a.value),!r||t.length!==r);n=!0);}catch(e){o=!0,i=e}finally{try{!n&&u.return&&u.return()}finally{if(o)throw i}}return t}return function(r,t){if(Array.isArray(r))return r;if(Symbol.iterator in Object(r))return e(r,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),r.taggedTemplateLiteral=function(e,r){return Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(r)}}))},r.temporalRef=function(e,r,t){if(e===t)throw new ReferenceError(r+" is not defined - temporal dead zone");return e},r.temporalUndefined={},r.toArray=function(e){return Array.isArray(e)?e:Array.from(e)},r.toConsumableArray=function(e){if(Array.isArray(e)){for(var r=0,t=Array(e.length);r<e.length;r++)t[r]=e[r];return t}return Array.from(e)}}("undefined"==typeof global?self:global);</script>

<link rel="import" href="../polymer/polymer-element.html"><link rel="import" href="../polymer/lib/utils/debounce.html"><link rel="import" href="../polymer/lib/utils/flattened-nodes-observer.html"><link rel="import" href="../polymer-vis/polymer-vis.html"></head><body><dom-module id="vega-element"><template><style>:host{display:block;}</style><div id="vegaElement"></div><slot id="slot"></slot></template><script>var VegaElement=function(a){function b(){return babelHelpers.classCallCheck(this,b),babelHelpers.possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments))}return babelHelpers.inherits(b,a),babelHelpers.createClass(b,[{key:'ready',value:function(){var d=this;if(babelHelpers.get(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),'ready',this).call(this),this._vegaReady=window.vega,!window.d3&&!window.vega)return void PolymerVis.loadScript(this.vegaSrc,function(){if(d._vegaReady=window.vega&&!0,'3'!==window.vega.version[0])throw new Error('vega version must be at least 3.0.0')});if(window.d3&&!window.vega){if('4'!==window.d3.version[0])throw new Error('d3 version must be at least 4.0.0');PolymerVis.loadScript(this.vegaCorSrc,function(){if(d._vegaReady=window.vega&&!0,'3'!==window.vega.version[0])throw new Error('vega version must be at least 3.0.0')})}}},{key:'connectedCallback',value:function(){babelHelpers.get(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),'connectedCallback',this).call(this),this._connected=!0,this._observeSlot()}},{key:'disconnectedCallback',value:function(){this._connected=!1,this._observer&&this._observer.disconnect()}},{key:'run',value:function(d){if(this.view)return this.view=this.view.run(d||this.customEncode),this.rendered=!0,this.view}},{key:'parse',value:function(d,e){return this._vegaReady&&d?vega.parse(d,e):void 0}},{key:'compile',value:function(){var e=this,f=1<arguments.length&&void 0!==arguments[1]?arguments[1]:'none';return this.vegaLiteSpec?new Promise(function(g,h){e.__loadVegaLite(function(){var i=vega[f||e.logLevel]||vega.None;try{var j=window.vl.compile(e.vegaLiteSpec,i).spec;e.vegaSpec=j,g(j)}catch(k){h(k)}})}):void 0}},{key:'resize',value:function(){return this.view?this.view.resize():void 0}},{key:'debounceRun',value:function(){var d=this;this._debounceJob=Polymer.Debouncer.debounce(this._debounceJob,Polymer.Async.microTask,function(){d.run()})}},{key:'loadJSON',value:function(d){if(!this._vegaReady||!d)return Promise.reject('url or vega not ready!');var e=vega.loader();return e.load(d).then(function(f){return JSON.parse(f)}).catch(function(f){throw new Error(f)})}},{key:'downloadImage',value:function(){var d=0<arguments.length&&void 0!==arguments[0]?arguments[0]:'png';this.view&&this.view.toImageURL(d).then(function(e){var f=document.createElement('a');f.setAttribute('href',e),f.setAttribute('target','_blank'),f.setAttribute('download','vega-export.'+d),f.dispatchEvent(new MouseEvent('click'))}).catch(function(){})}},{key:'_loadTooltipPlugin',value:function(d,e){this.tooltip&&this._tooltipReady&&this.rendered&&window.vegaTooltip.vega(d,e)}},{key:'_loadTooltip',value:function(d){var e=this;this._tooltipReady=window.vegaTooltip&&!0,!this._tooltipReady&&d&&this._vegaReady&&(PolymerVis.loadScript(this.tooltipPluginSrc,function(){e._tooltipReady=window.vegaTooltip&&!0}),PolymerVis.loadStylesheet(this.tooltipPluginCssSrc))}},{key:'_vegaSpecUrlChanged',value:function(d){var e=this;d&&this.loadJSON(d).then(function(f){e.vegaSpec=f}).catch(function(){})}},{key:'_vegaLiteSpecUrlChanged',value:function(d){var e=this;d&&this.loadJSON(d).then(function(f){e.vegaLiteSpec=f}).catch(function(){})}},{key:'_observeSlot',value:function(){return this._observer?void this._observer.connect():void(this._observer=new Polymer.FlattenedNodesObserver(this.$.slot,this._slotChanged.bind(this)))}},{key:'_bindSlots',value:function(d){var e=this;if(this.view&&d&&this.vegaSpec&&this.rendered){var f=0;d.forEach(function(g){'VEGA-DATA'===g.nodeName&&e.vegaSpec&&(g.name=g.name||e.vegaSpec.data[f].name,f+=1),g.view=e.view,g.rendered=e.rendered})}}},{key:'_slotChanged',value:function(){this.slots=this.shadowRoot.querySelector('slot').assignedNodes({flatten:!0}).filter(function(d){return 0<=d.nodeName.indexOf('VEGA')})}},{key:'_computeView',value:function(d,e){if(this._vegaReady&&d&&this._connected){var f=vega[f]||vega.None;return new vega.View(d,{logLevel:f,renderer:this.renderer}).initialize(e?null:this.$.vegaElement)}}},{key:'_setLogLevel',value:function(d){if(this.view&&vega[d])return this.view=this.view.logLevel(vega[d]),this.rendered||this.debounceRun(),this.view}},{key:'_setHover',value:function(d,e){if(this.view&&this.hover)return this.view=this.view.hover(d,e),this.rendered||this.debounceRun(),this.view}},{key:'_setRenderer',value:function(d){if(this.view&&d)return this.view=this.view.renderer(d),this.rendered||this.debounceRun(),this.view}},{key:'_updateBackground',value:function(d){this.view&&d&&(this.view.background(d),this.rendered&&this.debounceRun())}},{key:'_updateWidth',value:function(d){this.view&&d&&(this.view.width(d),this.rendered&&this.debounceRun())}},{key:'_updateHeight',value:function(d){this.view&&d&&(this.view.height(d),this.rendered&&this.debounceRun())}},{key:'_updatePadding',value:function(d){this.view&&d&&(this.view.padding(d),this.rendered&&this.debounceRun())}},{key:'__loadVegaLite',value:function(d){var e=this;this._vegaLiteReady=window.vl,window.vl?d():PolymerVis.loadScript(this.vegaLiteSrc,function(){if(e._vegaLiteReady=window.vl&&!0,'3'!==window.vega.version[0])throw new Error('vega version must be at least 3.0.0');d()})}}],[{key:'is',get:function(){return'vega-element'}},{key:'properties',get:function(){return{headless:{type:Boolean},tooltip:{type:Boolean},tooltipOptions:{type:Object,value:void 0},tooltipPluginSrc:{type:String,value:'https://cdnjs.cloudflare.com/ajax/libs/vega-tooltip/0.3.0/vega-tooltip.min.js'},tooltipPluginCssSrc:{type:String,value:'https://cdnjs.cloudflare.com/ajax/libs/vega-tooltip/0.3.0/vega-tooltip.min.css'},vegaSrc:{type:String,value:'https://cdnjs.cloudflare.com/ajax/libs/vega/3.0.2/vega.min.js'},vegaCoreSrc:{type:String,value:'https://cdnjs.cloudflare.com/ajax/libs/vega/3.0.2/vega-core.min.js'},vegaLiteSrc:{type:String,value:'https://cdnjs.cloudflare.com/ajax/libs/vega-lite/2.0.0-rc3/vega-lite.js'},logLevel:{type:String,value:'None'},renderer:{type:String,value:'canvas'},hover:{type:Boolean},hoverSet:{type:String,value:'hover'},updateSet:{type:String,value:'update'},background:{type:String},view:{type:Object,notify:!0,readOnly:!0,computed:'_computeView(_runtime, headless, _vegaReady, _connected)'},width:{type:Number,notify:!0,reflectToAttribute:!0},height:{type:Number,notify:!0,reflectToAttribute:!0},padding:{type:Object},vegaSpec:{type:Object,notify:!0},vegaLiteSpec:{type:Object,notify:!0},vegaSpecUrl:{type:String},vegaLiteSpecUrl:{type:String},config:{type:Object,value:function(){return{}}},customEncode:{type:String},rendered:{type:Boolean,notify:!0},slots:{type:Array,notify:!0},_runtime:{type:Object,computed:'parse(vegaSpec, config, _vegaReady)'},_vegaReady:{type:Boolean},_tooltipReady:{type:Boolean,value:!1},_connected:{type:Boolean},_debounceJob:{type:Object},_observer:{type:Object}}}},{key:'observers',get:function(){return['_vegaLiteSpecUrlChanged(vegaLiteSpecUrl, _vegaReady)','_vegaSpecUrlChanged(vegaSpecUrl, _vegaReady)','_setLogLevel(logLevel, view)','_setRenderer(renderer, view)','_setHover(hoverSet, updateSet, hover, view)','_updateWidth(width, view)','_updateHeight(height, view)','_updateBackground(background, view)','_updatePadding(padding, view)','_loadTooltip(tooltip, _vegaReady)','_loadTooltipPlugin(view, tooltipOptions, _tooltipReady, rendered)','compile(vegaLiteSpec, logLevel)','_bindSlots(slots, view, rendered, vegaSpec)']}}]),b}(Polymer.Element);window.customElements.define(VegaElement.is,VegaElement);</script></dom-module></body></html>